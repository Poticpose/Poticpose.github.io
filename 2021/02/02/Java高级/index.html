
<!DOCTYPE html>
<html lang="zh-CN" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Java高级 - 诗文的小书屋</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="blog,"> 
    <meta name="description" content="多线程多线程基本概念优点：

提高应用程序的响应，对图形化界面更有意义，提升用户体验。
提高计算机系统的CPU利用率。
改善程序结构，将复杂的进程分为多个线程，独立运行，利于理解和修改。

何时需要,"> 
    <meta name="author" content="Poet"> 
    <link rel="alternative" href="atom.xml" title="诗文的小书屋" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

    
<link rel="stylesheet" href="/css/diaspora.css">

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({
              google_ad_client: "ca-pub-8691406134231910",
              enable_page_level_ads: true
         });
    </script>
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
<meta name="generator" content="Hexo 4.2.0"></head>

<body class="loading">
    <span id="config-title" style="display:none">诗文的小书屋</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="https://poticpose.github.io"></a>
    <div title="播放/暂停" class="iconfont icon-play"></div>
    <h3 class="subtitle">Java高级</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">Java高级</h1>
        <div class="stuff">
            <span>二月 02, 2021</span>
            
  <ul class="post-tags-list" itemprop="keywords"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/Java/" rel="tag">Java</a></li></ul>


        </div>
        <div class="content markdown">
            <h1 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h1><h2 id="多线程基本概念"><a href="#多线程基本概念" class="headerlink" title="多线程基本概念"></a>多线程基本概念</h2><p>优点：</p>
<ol>
<li>提高应用程序的响应，对图形化界面更有意义，提升用户体验。</li>
<li>提高计算机系统的CPU利用率。</li>
<li>改善程序结构，将复杂的进程分为多个线程，独立运行，利于理解和修改。</li>
</ol>
<p>何时需要多线程：</p>
<ol>
<li>程序需要同时执行两个或两个以上任务。</li>
<li>程序需要实现一些需要等待的任务时，如用户输入、文件读写、网络操作、搜索等。</li>
<li>需要一些后台运行的程序时。</li>
</ol>
<hr>
<h2 id="线程的创建和使用"><a href="#线程的创建和使用" class="headerlink" title="线程的创建和使用"></a>线程的创建和使用</h2><p>创建方式一：继承 Thread 类</p>
<ol>
<li>创建一个继承 Thread 类的子类。</li>
<li>重写 Thread 类的 run()。 –&gt; 将此线程需要进行的操作声明在重写的 run() 中</li>
<li>创建 Thread 类的子类对象。</li>
<li>通过此对象调用 start()。</li>
</ol>
<p>例如需要输出 100 以内的偶数：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyThread t1 = <span class="keyword">new</span> MyThread();</span><br><span class="line">        t1.start();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">100</span>;j++) &#123;</span><br><span class="line">            System.out.println(<span class="string">"***********"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.println(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在主线程加入循环输出“<strong><strong>****</strong></strong>”以此来凸显线程交换</p>
<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">***********</span><br><span class="line">***********</span><br><span class="line">***********</span><br><span class="line">***********</span><br><span class="line">0</span><br><span class="line">2</span><br><span class="line">4</span><br><span class="line">6</span><br><span class="line">8</span><br><span class="line">10</span><br><span class="line">12</span><br><span class="line">***********</span><br><span class="line">***********</span><br><span class="line">***********</span><br><span class="line">***********</span><br><span class="line">***********</span><br><span class="line">14</span><br><span class="line">16</span><br><span class="line">18</span><br><span class="line">20</span><br><span class="line">22</span><br><span class="line">24</span><br><span class="line">26</span><br><span class="line">28</span><br><span class="line">30</span><br><span class="line">32</span><br><span class="line">34</span><br><span class="line">36</span><br><span class="line">38</span><br><span class="line">40</span><br><span class="line">42</span><br><span class="line">&#x2F;&#x2F;........</span><br></pre></td></tr></table></figure>

<p>Thread.currentThread() 可以获取到当前操作的线程。</p>
<p>通过输出 Thread.currentThread().getName 可以更直观感受到</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyThread t1 = <span class="keyword">new</span> MyThread();</span><br><span class="line">        t1.start();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">100</span>;j++) &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+<span class="string">"：***********"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName()+<span class="string">"："</span>+i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">Thread-0：0</span><br><span class="line">Thread-0：2</span><br><span class="line">Thread-0：4</span><br><span class="line">Thread-0：6</span><br><span class="line">Thread-0：8</span><br><span class="line">Thread-0：10</span><br><span class="line">Thread-0：12</span><br><span class="line">Thread-0：14</span><br><span class="line">Thread-0：16</span><br><span class="line">Thread-0：18</span><br><span class="line">Thread-0：20</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">Thread-0：22</span><br><span class="line">Thread-0：24</span><br><span class="line">Thread-0：26</span><br><span class="line">Thread-0：28</span><br><span class="line">Thread-0：30</span><br><span class="line">Thread-0：32</span><br><span class="line">Thread-0：34</span><br><span class="line">Thread-0：36</span><br><span class="line">Thread-0：38</span><br><span class="line">Thread-0：40</span><br><span class="line">&#x2F;&#x2F;.......</span><br></pre></td></tr></table></figure>

<hr>
<p>创建方式二：实现 Runnable 接口</p>
<ol>
<li>创建一个实现 Runnable 接口的类。</li>
<li>实现类去实现 Runnable 中的抽象方法 run()。</li>
<li>创建实现类的对象。</li>
<li>将此对象作为参数传递到 Thread 类的构造器中，创建 Thread 类的对象。</li>
<li>通过 Thread 类的对象调用 start()。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadTest2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MThread mth2 = <span class="keyword">new</span> MThread();</span><br><span class="line">        Thread t2 = <span class="keyword">new</span> Thread(mth2);</span><br><span class="line">        t2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.println(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>比较两种创建线程的方式：</p>
<p>开发中：优先选择：实现 Runnable 接口的方式。</p>
<p>原因：</p>
<ol>
<li>实现的方式没有类的单继承性的限制。</li>
<li>实现的方式更适合多个线程共享数据。</li>
</ol>
<p>相同：两种方式都需要重写 run() 方法，将线程的执行逻辑声明在 run() 中。</p>
<hr>
<h2 id="线程使用常用方法"><a href="#线程使用常用方法" class="headerlink" title="线程使用常用方法"></a>线程使用常用方法</h2><ul>
<li>void start()：启动线程，并执行对象的 run() 方法。</li>
<li>run()：线程在被调度时执行的操作。</li>
<li>String getName()：返回线程的名称。</li>
<li>void setName(String name)：设置该线程的名称。</li>
<li>static Thread currentThread()：返回当前线程。在 Thread 子类中就是 this，通常用于主线程和 Runnable 实现类。</li>
<li>static void yield()：线程让步<ul>
<li>暂停当前正在执行的线程，把执行机会让给优先级相同或更高的线程。</li>
<li>若队列中没有同优先级的线程，忽略此方法。</li>
</ul>
</li>
<li>join()：当某个程序执行流中调用其他线程的 join() 方法时，调用线程将被阻塞，直到 join() 方法加入的 join 线程执行完为止。</li>
<li>static void sleep(long millis)：（指定时间：毫秒）<ul>
<li>令当前活动线程在指定时间段内放弃对CPU的控制，使其他线程有机会被执行，时间到后重新排队。</li>
<li>抛出 InterruptedException 异常</li>
</ul>
</li>
<li>stop()：强制线程生命周期结束。</li>
<li>boolean isAlive()：返回 boolean，判断线程是否存活。</li>
</ul>
<p>以下方法只能使用于同步代码块或同步方法中：</p>
<ul>
<li>wait()：一旦执行此方法，当前线程进入堵塞状态，并释放同步监视器。</li>
<li>notify()：一旦执行此方法就会唤醒被 wait 的一个进程，如果有多个，则唤醒优先级最高的一个。</li>
<li>notifyAll()：一旦执行此方法，唤醒所有 wait 进程。</li>
</ul>
<hr>
<h2 id="线程的优先级"><a href="#线程的优先级" class="headerlink" title="线程的优先级"></a>线程的优先级</h2><p>调度策略</p>
<ul>
<li>时间片：依次先进先出。</li>
<li>抢占式：高优先级的线程抢占CPU。</li>
</ul>
<p>线程的优先级等级：</p>
<ul>
<li>MAX_PRIORITY：10</li>
<li>MIN_PRIORITY：1</li>
<li>NORM_PRIORITY：5</li>
</ul>
<p>涉及的方法：</p>
<ul>
<li>getPriority()：返回线程优先值。</li>
<li>setPriority()：改变线程的优先值。</li>
</ul>
<p>P.S.</p>
<ul>
<li>线程创建时，继承父线程的优先级。</li>
<li>低优先级只是获得调度的概率低，并非一定是在高优先级线程之后才被调用。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyThread t1 = <span class="keyword">new</span> MyThread();</span><br><span class="line">        t1.setPriority(Thread.MAX_PRIORITY);</span><br><span class="line">        t1.start();</span><br><span class="line">        Thread.currentThread().setPriority(Thread.MIN_PRIORITY);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">100</span>; j++) &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">" 线程优先级："</span> + Thread.currentThread().getPriority() + <span class="string">"：***********"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">" 线程优先级："</span> + getPriority() + <span class="string">"："</span> + i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">Thread-0 线程优先级：10：0</span><br><span class="line">Thread-0 线程优先级：10：2</span><br><span class="line">Thread-0 线程优先级：10：4</span><br><span class="line">Thread-0 线程优先级：10：6</span><br><span class="line">Thread-0 线程优先级：10：8</span><br><span class="line">Thread-0 线程优先级：10：10</span><br><span class="line">Thread-0 线程优先级：10：12</span><br><span class="line">Thread-0 线程优先级：10：14</span><br><span class="line">Thread-0 线程优先级：10：16</span><br><span class="line">Thread-0 线程优先级：10：18</span><br><span class="line">Thread-0 线程优先级：10：20</span><br><span class="line">Thread-0 线程优先级：10：22</span><br><span class="line">Thread-0 线程优先级：10：24</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">Thread-0 线程优先级：10：26</span><br><span class="line">Thread-0 线程优先级：10：28</span><br><span class="line">Thread-0 线程优先级：10：30</span><br><span class="line">Thread-0 线程优先级：10：32</span><br><span class="line">Thread-0 线程优先级：10：34</span><br><span class="line">Thread-0 线程优先级：10：36</span><br><span class="line">Thread-0 线程优先级：10：38</span><br><span class="line">Thread-0 线程优先级：10：40</span><br><span class="line">Thread-0 线程优先级：10：42</span><br><span class="line">Thread-0 线程优先级：10：44</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">Thread-0 线程优先级：10：46</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">Thread-0 线程优先级：10：48</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">Thread-0 线程优先级：10：50</span><br><span class="line">Thread-0 线程优先级：10：52</span><br><span class="line">&#x2F;&#x2F;......</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="线程的生命周期"><a href="#线程的生命周期" class="headerlink" title="线程的生命周期"></a>线程的生命周期</h2><p>JDK 中用 Thread.State 类定义了线程的几种状态。</p>
<ul>
<li>新建：当一个 Thread 类或其子类的对象被声明和创建时，新的线程对象处于新建状态。</li>
<li>就绪：处于新建状态的线程被 start() 后，将进入线程队列等待 CPU 时间片，此时它具备了运行的条件，只是没分配到 CPU 资源。</li>
<li>运行：当就绪的线程被调度并获得 CPU 资源时，便进入运行状态，run() 方法定义了线程的操作和功能。</li>
<li>阻塞：在某种特殊情况下，被人为挂起或执行输入输出操作时，让出 CPU 并临时终止自己的执行，进入阻塞状态。</li>
<li>死亡：线程完成了它的全部工作或线程被提前强制性的中止或出现异常导致结束。</li>
</ul>
<img src='/img/Java高级/1.png'>

<hr>
<h2 id="线程的同步"><a href="#线程的同步" class="headerlink" title="线程的同步"></a>线程的同步</h2><p>示例场景：</p>
<p>创建三个窗口卖票，总票数为 100 张，使用实现 Runnable 接口的方式。</p>
<ol>
<li>问题：卖票过程中，出现了重票、错票 –&gt; 出现了线程的安全问题</li>
<li>问题出现的原因：当某个线程操作车票的过程中，尚未操作完成，其他线程再次参与进来，也操作车票。</li>
<li>解决方式：<br>当一个线程 a 在操作 ticket 的时候，其他线程不能参与进来。直到线程 a 操作完 ticket 时，其余线程才可以操作 ticket。这种情况即使线程 a 处于阻塞状态，也不能被改变。</li>
<li>在 Java 中通过同步机制，来解决线程的安全问题。</li>
</ol>
<p>方式一：同步代码块</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span>(同步监听器)&#123;</span><br><span class="line">    <span class="comment">//需要被同步的代码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>操作共享数据的代码，即为需要被同步的代码。</p>
<p>共享数据：多个线程共同操作的变量，比如：ticket</p>
<p>同步监视器：俗称，锁。任何一个类的对象都可以充当锁。</p>
<p>多个线程必须用通一把锁。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BuyTicket</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        BuyThread bt = <span class="keyword">new</span> BuyThread();</span><br><span class="line">        Thread w1 = <span class="keyword">new</span> Thread(bt);</span><br><span class="line">        Thread w2 = <span class="keyword">new</span> Thread(bt);</span><br><span class="line">        Thread w3 = <span class="keyword">new</span> Thread(bt);</span><br><span class="line"></span><br><span class="line">        w1.start();</span><br><span class="line">        w2.start();</span><br><span class="line">        w3.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuyThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> ticket = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    Object obj = <span class="keyword">new</span> Object();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (obj)&#123;</span><br><span class="line">                <span class="keyword">if</span>(ticket&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">try</span>&#123;</span><br><span class="line">                        Thread.sleep(<span class="number">100</span>);</span><br><span class="line">                    &#125;<span class="keyword">catch</span> (InterruptedException e)&#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">"卖票，票号："</span>+ticket);</span><br><span class="line">                    ticket--;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Thread-1卖票，票号：100</span><br><span class="line">Thread-1卖票，票号：99</span><br><span class="line">Thread-1卖票，票号：98</span><br><span class="line">Thread-1卖票，票号：97</span><br><span class="line">Thread-1卖票，票号：96</span><br><span class="line">Thread-1卖票，票号：95</span><br><span class="line">Thread-1卖票，票号：94</span><br><span class="line">Thread-1卖票，票号：93</span><br><span class="line">Thread-1卖票，票号：92</span><br><span class="line">Thread-1卖票，票号：91</span><br><span class="line">Thread-1卖票，票号：90</span><br><span class="line">Thread-1卖票，票号：89</span><br><span class="line">Thread-1卖票，票号：88</span><br><span class="line">Thread-1卖票，票号：87</span><br><span class="line">Thread-1卖票，票号：86</span><br><span class="line">Thread-1卖票，票号：85</span><br><span class="line">Thread-1卖票，票号：84</span><br><span class="line">Thread-1卖票，票号：83</span><br><span class="line">Thread-1卖票，票号：82</span><br><span class="line">Thread-1卖票，票号：81</span><br><span class="line">&#x2F;&#x2F;.......</span><br></pre></td></tr></table></figure>

<p>同步好处：解决了线程的安全问题。<br>同步局限性：只能有一个线程参与，其他线程等待。相当于一个单线程的过程，效率低。</p>
<hr>
<p>示例场景：</p>
<p>创建三个窗口卖票，总票数为 100 张，使用继承 Thread 类的方式。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BuyTicket</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       BuyThread w1 = <span class="keyword">new</span> BuyThread();</span><br><span class="line">       BuyThread w2 = <span class="keyword">new</span> BuyThread();</span><br><span class="line">       BuyThread w3 = <span class="keyword">new</span> BuyThread();</span><br><span class="line"></span><br><span class="line">        w1.start();</span><br><span class="line">        w2.start();</span><br><span class="line">        w3.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> ticket = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> Object obj = <span class="keyword">new</span> Object();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (obj)&#123;</span><br><span class="line">                <span class="keyword">if</span>(ticket&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">try</span>&#123;</span><br><span class="line">                        Thread.sleep(<span class="number">100</span>);</span><br><span class="line">                    &#125;<span class="keyword">catch</span> (InterruptedException e)&#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">"卖票，票号："</span>+ticket);</span><br><span class="line">                    ticket--;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>方法二：同步方法</p>
<p>如果操作共享数据的代码完整的声明在一个方法中，我们不妨将此方法声明为同步的。</p>
<p>通过实现 Runnable 接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BuyTicket</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        BuyThread bt = <span class="keyword">new</span> BuyThread();</span><br><span class="line">        Thread w1 = <span class="keyword">new</span> Thread(bt);</span><br><span class="line">        Thread w2 = <span class="keyword">new</span> Thread(bt);</span><br><span class="line">        Thread w3 = <span class="keyword">new</span> Thread(bt);</span><br><span class="line"></span><br><span class="line">        w1.start();</span><br><span class="line">        w2.start();</span><br><span class="line">        w3.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuyThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> ticket = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ticket &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">100</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">"卖票，票号："</span> + ticket);</span><br><span class="line">            ticket--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>synchronized void xxx() 表示同步方法。</p>
<p>要保证同步方法中所有内容都是被共享的，不能是重复的。</p>
<hr>
<p>通过继承 Thread 类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BuyTicket</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        BuyThread w1 = <span class="keyword">new</span> BuyThread();</span><br><span class="line">        BuyThread w2 = <span class="keyword">new</span> BuyThread();</span><br><span class="line">        BuyThread w3 = <span class="keyword">new</span> BuyThread();</span><br><span class="line"></span><br><span class="line">        w1.start();</span><br><span class="line">        w2.start();</span><br><span class="line">        w3.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> ticket = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ticket &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">100</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">"卖票，票号："</span> + ticket);</span><br><span class="line">            ticket--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>非静态同步方法，默认同步监视器是：this</p>
<p>静态同步方法，默认同步监视器是：当前类本身</p>
<hr>
<h2 id="使用同步机制改写单例模式"><a href="#使用同步机制改写单例模式" class="headerlink" title="使用同步机制改写单例模式"></a>使用同步机制改写单例模式</h2><p>使用同步机制改写单例模式之懒汉式</p>
<p>方式一：效率较差</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bank</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Bank</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Bank instance = <span class="keyword">null</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Bank <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//┌──────────────────────────────────────┐</span></span><br><span class="line"><span class="comment">//│           抽象的线程等待区            │</span></span><br><span class="line"><span class="comment">//└──────────────────────────────────────┘</span></span><br><span class="line">        <span class="keyword">synchronized</span> (Bank<span class="class">.<span class="keyword">class</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (instance == <span class="keyword">null</span>)&#123;</span><br><span class="line">                instance = <span class="keyword">new</span> Bank();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> instance;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所有在进入同步代码块前的线程，无论 instance 是否已经实例化都会进入其中进行判断。</p>
<p>方式二：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bank</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Bank</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Bank instance = <span class="keyword">null</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Bank <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line"><span class="comment">//┌──────────────────────────────────────┐</span></span><br><span class="line"><span class="comment">//│           抽象的线程等待区            │</span></span><br><span class="line"><span class="comment">//└──────────────────────────────────────┘</span></span><br><span class="line">            <span class="keyword">synchronized</span> (Bank<span class="class">.<span class="keyword">class</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> Bank();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="线程的死锁"><a href="#线程的死锁" class="headerlink" title="线程的死锁"></a>线程的死锁</h2><p>死锁：</p>
<ul>
<li>不同线程分别占用对方需要的同步资源不放弃，都在等待对方放弃自己需要的同步资源，就形成了线程的死锁。</li>
<li>出现死锁后，不会出现异常，不会出现提示，只是所有的线程都处于阻塞状态，无法继续。</li>
</ul>
<p>解决方法：</p>
<ul>
<li>专门的算法、原则。</li>
<li>尽量减少同步资源的定义。</li>
<li>尽量避免嵌套同步。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        StringBuffer s1 = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        StringBuffer s2 = <span class="keyword">new</span> StringBuffer();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> Thread() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">synchronized</span> (s1) &#123;</span><br><span class="line">                    s1.append(<span class="string">"a"</span>);</span><br><span class="line">                    s2.append(<span class="string">"1"</span>);</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        sleep(<span class="number">100</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">synchronized</span> (s2) &#123;</span><br><span class="line">                        s1.append(<span class="string">"b"</span>);</span><br><span class="line">                        s2.append(<span class="string">"2"</span>);</span><br><span class="line"></span><br><span class="line">                        System.out.println(s1);</span><br><span class="line">                        System.out.println(s2);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.start();</span><br><span class="line">        <span class="keyword">new</span> Thread() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">synchronized</span> (s2) &#123;</span><br><span class="line">                    s1.append(<span class="string">"c"</span>);</span><br><span class="line">                    s2.append(<span class="string">"3"</span>);</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        sleep(<span class="number">100</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">synchronized</span> (s1) &#123;</span><br><span class="line">                        s1.append(<span class="string">"d"</span>);</span><br><span class="line">                        s2.append(<span class="string">"4"</span>);</span><br><span class="line"></span><br><span class="line">                        System.out.println(s1);</span><br><span class="line">                        System.out.println(s2);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上代码在运行过程中可能不会产生输出并持续保持运行状态，即进入了死锁状态。</p>
<hr>
<h2 id="Lock（锁）"><a href="#Lock（锁）" class="headerlink" title="Lock（锁）"></a>Lock（锁）</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuyThread1</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> ticket = <span class="number">100</span>;</span><br><span class="line">    <span class="comment">//1. 实例化ReentrantLock类的对象lock</span></span><br><span class="line">    <span class="keyword">private</span> ReentrantLock lock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//2. 将需要同步的代码用try包起来，并调用lock() 方法</span></span><br><span class="line">                lock.lock();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (ticket &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Thread.sleep(<span class="number">100</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">"卖票，票号："</span> + ticket);</span><br><span class="line">                    ticket--;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="comment">//3. 当运行完后进行解锁</span></span><br><span class="line">                lock.unlock();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>synchronized 与 Lock 的异同：</p>
<p>相同：二者都可以解决线程安全问题。</p>
<p>不同：</p>
<p>synchronized 机制在执行完相应的同步代码后，自动释放同步监视器。</p>
<p>Lock 需要手动的启动同步（lock()）和手动的结束同步（unlock()）。</p>
<hr>
<p>sleep() 和 wait() 的异同：</p>
<p>相同：一旦执行方法，都可使当前线程进入堵塞状态。</p>
<p>不同：</p>
<ol>
<li>两个方法声明位置不同：Thread 类中声明 sleep()，Object 类中声明 wait()。</li>
<li>调用的要求不同：sleep() 可以在任何需要的场景使用，wait() 只能在同步代码块或同步方法中使用。</li>
<li>关于是否释放同步监视器：如果两个方法都在同步代码块或同步方法中，sleep() 不会释放同步监视器，wait() 会释放同步监视器。</li>
</ol>
<hr>
<h2 id="实现-Callable-接口"><a href="#实现-Callable-接口" class="headerlink" title="实现 Callable 接口"></a>实现 Callable 接口</h2><p>Future 接口：</p>
<ul>
<li>可以对具体 Runnable。Callable 任务的执行结果进行取消、查询是否完成、获取结果等。</li>
<li>FutrueTask 同时实现了 Runnable、Callable 接口。它既作为 Runnable 线程被执行，又可以作为 Future 得到的 Callable 的返回值。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CallTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//3. 创建Callable接口实现类的对象</span></span><br><span class="line">        CallThread ct = <span class="keyword">new</span> CallThread();</span><br><span class="line">        <span class="comment">//4. 将此Callable接口实现类的对象作为参数传递到FutureTask构造器中，创建FutureTask对象</span></span><br><span class="line">        FutureTask futureTask = <span class="keyword">new</span> FutureTask(ct);</span><br><span class="line">        <span class="comment">//5. 将FutureTask的对象作为参数传递到Thread类的构造器中，创建Thread对象，并调用start()</span></span><br><span class="line">        <span class="keyword">new</span> Thread(futureTask).start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//6. 获取Callable中的call()的返回值</span></span><br><span class="line">            <span class="comment">//get()返回值即为FutureTask构造器参数Callable实现类重写的call()的返回值</span></span><br><span class="line">            Object sum = futureTask.get();</span><br><span class="line">            System.out.println(sum);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ExecutionException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//1. 创建一个Callable接口的实现类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CallThread</span> <span class="keyword">implements</span> <span class="title">Callable</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">//2. 重写call()，将此线程需要进行的操作声明在call()中</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.println(i);</span><br><span class="line">                sum += i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">0</span><br><span class="line">2</span><br><span class="line">4</span><br><span class="line">6</span><br><span class="line">8</span><br><span class="line">10</span><br><span class="line">12</span><br><span class="line">14</span><br><span class="line">16</span><br><span class="line">18</span><br><span class="line">20</span><br><span class="line">22</span><br><span class="line">.......</span><br><span class="line">96</span><br><span class="line">98</span><br><span class="line">2450</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="使用线程池"><a href="#使用线程池" class="headerlink" title="使用线程池"></a>使用线程池</h2><p>提前创好多个线程，放入线程池中，使用时直接获取，使用完放回池中。避免频繁创建销毁、实现重复利用。</p>
<p>好处：</p>
<ul>
<li>提高响应速度</li>
<li>降低资源消耗</li>
<li>便于线程管理</li>
</ul>
<p>ExecutorService：真正的线程池接口。常见子类ThreadPoolExecutor</p>
<ul>
<li>void execute(Runnable command)：执行任务/命令，没有返回值，一般用来执行 Runnable。</li>
<li><T>Future<T>submit(Callable<T> task)：执行任务，有返回值，一般用来执行Callable。</li>
<li>void shutdown()：关闭连接池。</li>
</ul>
<p>Executors：工具类、线程池的工厂类，用于创建并返回不同类型的线程池。</p>
<ul>
<li>Executors.newCachedThreadPool()：创建一个可根据需要创建新线程的线程池。</li>
<li>Executors.newFixedThreadPool()：创建一个可重用固定线程数的线程池。</li>
<li>Executors.newSingleThreadExecutor()：创建一个只有一个线程的线程池。</li>
<li>Executors.newScheduledThreadPool(n)：创建一个线程池，可以安排在给定延迟后运行命令或者定期执行。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadPool</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1. 提供指定数量线程的线程池</span></span><br><span class="line">        ExecutorService service = Executors.newFixedThreadPool(<span class="number">10</span>);</span><br><span class="line">        <span class="comment">//2. 执行指定的线程的操作</span></span><br><span class="line">        service.execute(<span class="keyword">new</span> NumberThread1());</span><br><span class="line">        service.execute(<span class="keyword">new</span> NumberThread2());</span><br><span class="line">        <span class="comment">//3. 关闭线程池</span></span><br><span class="line">        service.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NumberThread1</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">100</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName()+<span class="string">"："</span>+i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NumberThread2</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">100</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(i%<span class="number">2</span>!=<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName()+<span class="string">"："</span>+i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">pool-1-thread-2：1</span><br><span class="line">pool-1-thread-1：0</span><br><span class="line">pool-1-thread-2：3</span><br><span class="line">pool-1-thread-1：2</span><br><span class="line">pool-1-thread-1：4</span><br><span class="line">pool-1-thread-2：5</span><br><span class="line">pool-1-thread-1：6</span><br><span class="line">pool-1-thread-2：7</span><br><span class="line">pool-1-thread-2：9</span><br><span class="line">pool-1-thread-1：8</span><br><span class="line">pool-1-thread-2：11</span><br><span class="line">pool-1-thread-1：10</span><br><span class="line">pool-1-thread-1：12</span><br><span class="line">pool-1-thread-1：14</span><br><span class="line">pool-1-thread-2：13</span><br><span class="line">pool-1-thread-2：15</span><br><span class="line">&#x2F;&#x2F;.......</span><br></pre></td></tr></table></figure>

<p>到此为止，创建多线程有四种方法。</p>
<hr>
<h1 id="Java-常用类"><a href="#Java-常用类" class="headerlink" title="Java 常用类"></a>Java 常用类</h1><h2 id="字符串相关类"><a href="#字符串相关类" class="headerlink" title="字符串相关类"></a>字符串相关类</h2><p>String：</p>
<ul>
<li><p>String：字符串，使用一对” “引起来表示。</p>
</li>
<li><p>String 声明为 final 的，不可被继承。</p>
</li>
<li><p>String 实现了 serializable 接口，表示字符串是可以序列化的。</p>
<p>  实现了 Comparable 接口，表示 String 可以比较大小。</p>
</li>
<li><p>String 内部定义了 final char[] value（有些版本为final byte[] value） 用于存储字符串数据</p>
</li>
<li><p>String 代表不可变的字符序列。</p>
<p>  当字符串重新赋值时，需重写指定内存区域赋值，不能使用原有 value 赋值。字符串赋值的过程类似于调用数据而不是创造数据。</p>
<p>  当新赋值一个字符串，会在字符串常量池中，创建一个等待赋值的数据，并赋予其地址值，随后给要赋值的字符串指向该地址值，以此完成赋值操作。因此拥有相同值的字符串实际上是都指向了同一片内存空间，当其中一个要重新赋值时，并非修改原本指向的内存空间中的值，而是在字符串常量池中重新寻找待赋值的数据（如果没有就创建），然后在指向其内存地址。</p>
<p>  如图：</p>
  <img src='/img/Java高级/2.png'>

<p>  当调用 String 的 replace() 方法修改指定字符或字符串时，也需要重新指定内存区域。</p>
</li>
</ul>
<p>String 对象的创建如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">String str = “Hello”;   <span class="comment">//声明一个字符串赋值"Hello"</span></span><br><span class="line"></span><br><span class="line">String str = <span class="keyword">new</span> String();      <span class="comment">//声明一个字符串，默认不赋值</span></span><br><span class="line"></span><br><span class="line">String str = <span class="keyword">new</span> String(<span class="string">"Hello"</span>);       <span class="comment">//声明一个字符串，赋值"Hello"</span></span><br><span class="line"></span><br><span class="line">String str = <span class="keyword">new</span> String(<span class="keyword">char</span>[] a);       <span class="comment">//声明一个字符串，赋值数组a</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//声明一个字符串，赋值从数组a下标为startindex的元素起始的count个元素        </span></span><br><span class="line">String str = <span class="keyword">new</span> STring(<span class="keyword">char</span>[] a,<span class="keyword">int</span> startindex,<span class="keyword">int</span> count);</span><br></pre></td></tr></table></figure>

<p>通过 new 进行赋值的 String 对象是在堆空间中开辟一片内存空间存储 value，而堆空间的 value 的值又是从字符串常量池中寻找调用，也就是 String 对象指向 堆空间中的地址值，而堆空间内又指向字符串常量池中的地址值，因此会有：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">String str1 = <span class="string">"123"</span>;</span><br><span class="line">String str2 = <span class="string">"123"</span>;</span><br><span class="line">String str3 = <span class="keyword">new</span> String(<span class="string">"123"</span>);</span><br><span class="line">String str4 = <span class="keyword">new</span> String(<span class="string">"123"</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(str1 == str2);</span><br><span class="line">System.out.println(str1 == str3);</span><br><span class="line">System.out.println(str3 == str4);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">true</span><br><span class="line">false</span><br><span class="line">false</span><br></pre></td></tr></table></figure>

<p>因此引出提问：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String str = <span class="keyword">new</span> String(<span class="string">"Hello"</span>);</span><br></pre></td></tr></table></figure>

<p>以上方式在内存中创建了几个对象：两个（堆空间一个、常量池一个）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">String s1 = <span class="string">"Java"</span>;</span><br><span class="line">String s2 = <span class="string">"EE"</span>;</span><br><span class="line"></span><br><span class="line">String s3 = <span class="string">"JavaEE"</span>;</span><br><span class="line">String s4 = <span class="string">"Java"</span> + <span class="string">"EE"</span>;</span><br><span class="line">String s5 = s1 + <span class="string">"EE"</span>;</span><br><span class="line">String s6 = <span class="string">"Java"</span> + s2;</span><br><span class="line">String s7 = s1 + s2;</span><br><span class="line">String s8 = s5.intern();</span><br><span class="line"></span><br><span class="line">System.out.println(s3 == s4);   <span class="comment">//true</span></span><br><span class="line">System.out.println(s3 == s5);   <span class="comment">//false</span></span><br><span class="line">System.out.println(s3 == s6);   <span class="comment">//false</span></span><br><span class="line">System.out.println(s3 == s7);   <span class="comment">//false</span></span><br><span class="line">System.out.println(s5 == s6);   <span class="comment">//false</span></span><br><span class="line">System.out.println(s5 == s7);   <span class="comment">//false</span></span><br><span class="line">System.out.println(s6 == s7);   <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line">System.out.println(s3 == s8);   <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<p>常量与常量拼接的结果在常量池中，因此比对是常量池与常量池比对，相同肯定为 true，但有变量参与，中间是涉及堆空间，因此比对为 false。</p>
<p>而通过 intern() 赋值的变量是直接在常量池中寻找数据，因此比对是 true。</p>
<hr>
<p><b>String  与 char[] 之间的转换</b></p>
<p>String –&gt; char[]</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">String str1 = <span class="string">"abc123"</span>;</span><br><span class="line"><span class="keyword">char</span>[] charArray = str1.toCharArray();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;charArray.length;i++)&#123;</span><br><span class="line">    System.out.print(charArray[i] + <span class="string">" "</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a b c 1 2 3</span><br></pre></td></tr></table></figure>

<p>char[] –&gt; String</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span>[] arr = <span class="keyword">new</span> <span class="keyword">char</span>[]&#123;<span class="string">'h'</span>,<span class="string">'e'</span>,<span class="string">'l'</span>,<span class="string">'l'</span>,<span class="string">'o'</span>&#125;;</span><br><span class="line">String str2 = <span class="keyword">new</span> String(arr);</span><br><span class="line">System.out.println(str2);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hello</span><br></pre></td></tr></table></figure>

<hr>
<p><b>String 与 byte[] 之间的转换</b></p>
<p>编码：String –&gt; byte[]</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">String str1 = <span class="string">"abc123北京"</span>;</span><br><span class="line"><span class="keyword">byte</span>[] byt = str1.getBytes();   <span class="comment">//默认字符集转换</span></span><br><span class="line">System.out.println(Arrays.toString(byt));</span><br><span class="line"><span class="keyword">byte</span>[] gbks = str1.getBytes(<span class="string">"gbk"</span>);     <span class="comment">//GBK字符集转换</span></span><br><span class="line">System.out.println(Arrays.toString(gbks));</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[97, 98, 99, 49, 50, 51, -27, -116, -105, -28, -70, -84]</span><br><span class="line">[97, 98, 99, 49, 50, 51, -79, -79, -66, -87]</span><br></pre></td></tr></table></figure>

<hr>
<p>解码：byte[] –&gt; String</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String str2 = <span class="keyword">new</span> String(byt);  <span class="comment">//转换默认字符集</span></span><br><span class="line">System.out.println(str2);</span><br><span class="line">str2 = <span class="keyword">new</span> String(gbks,<span class="string">"gbk"</span>);</span><br><span class="line">System.out.println(str2);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">abc123北京</span><br><span class="line">abc123北京</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="String-常用方法"><a href="#String-常用方法" class="headerlink" title="String 常用方法"></a>String 常用方法</h2><ul>
<li>int length()：返回字符串长度  <code>return value.length</code></li>
<li>char charAt(int index)：返回某索引处的字符    <code>return value[index]</code></li>
<li>boolean isEmpty()：判断是否为空字符串     <code>return value.length == 0</code></li>
<li>String toLowerCase()：使用默认语言环境，将字符串中所有字符转换为小写</li>
<li>String toUpperCase()：使用默认语言环境，将字符串中所有字符转换为大写</li>
<li>String trim()：返回字符串的副本，忽略前导空白和尾部空白</li>
<li>boolean equals(Object obj)：比较字符串的内容是否相同</li>
<li>boolean equalsIgnoreCase(String anotherString)：与 equals 方法类似，忽略大小写</li>
<li>String concat(String str)：将指定字符串连接到该字符串的结尾</li>
<li>int compareTo(String anotherString)：比较两个字符串的大小</li>
<li>String substring(int beginIndex)：返回一个新字符串，它是此字符串从 beginIndex 开始截取到最后一个子字符串</li>
<li>String substring(int beginIndex, int endIndex)：返回一个新字符串，它是此字符串从 beginIndex 开始截取到 endIndex （不包含）的一个子字符串</li>
<li>boolean endsWith(String suffix)：测试此字符串是否以指定的后缀结束</li>
<li>boolean startsWith(String prefix)：测试此字符串是否以指定的前缀开始</li>
<li>boolean startsWith(String prefix, int toffset)：测试此字符串从指定索引开始的子字符串是否以指定前缀开始</li>
<li>boolean contains(CharSequence s)：当且仅当此字符串包含指定的 char 值序列时，返回 true</li>
<li>int indexOf(String str)：返回指定子字符串在此字符串中第一次出现的索引位置</li>
<li>int indexOf(String str, int fromIndex)：返回指定子字符串在此字符串中第一次出现处的索引，从指定索引开始</li>
<li>int lastIndexOf(String str)：返回指定子字符串在此字符串中最右边出现处的索引</li>
<li>int lastIndexOf(String str, int fromIndex)：返回指定子字符串在此字符串中最后一次出现处的索引，从指定索引开始反向搜索 </li>
<li>String replace(char oldChar,char newChar)：返回一个新的字符串，它是通过 newChar 替换此字符串中出现的所有 oldChar 所得到的</li>
<li>String replace(CharSequence target, CharSequence replacement)：使用指定的字面值替换此字符串所有匹配字面值目标序列的子字符串</li>
<li>String replaceAll(String regex, String replacement)：使用给定的 replacement 替换此字符串所有匹配给定的正则表达式的子字符串</li>
<li>String replaceFirst(String regex, String replacement)：使用给定的 replacement 替换此字符串匹配给定正则表达式第一个子字符串</li>
<li>boolean matches(String regex)：告知此字符串是否匹配给定的正则表达式</li>
<li>String[] split(String regex)：根据给定的正则表达式的匹配分拆此字符串</li>
<li>String[] split(String regex, int limit)：根据匹配给定的正则表达式来拆分此字符串，最多不超过 limit 个，如果超过了，剩下的全部放在最后一个元素中</li>
</ul>
<hr>
<h2 id="StringBuffer-与-StringBuilder"><a href="#StringBuffer-与-StringBuilder" class="headerlink" title="StringBuffer 与 StringBuilder"></a>StringBuffer 与 StringBuilder</h2><p>String、StringBuffer 与 StringBuilder 异同：</p>
<p>不同：</p>
<ul>
<li>String：不可变的字符序列。</li>
<li>StringBuffer：可变的字符序列、线程安全、效率低</li>
<li>StringBuilder：可变的字符序列、线程不安全、效率高</li>
</ul>
<p>相同：</p>
<ul>
<li>三者底层都是利用 char[] 存储</li>
</ul>
<p>String 与 StringBuffer 底层分析：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String str1 = <span class="keyword">new</span> String(); <span class="comment">//char value = new char[0];</span></span><br><span class="line">String str2 = <span class="keyword">new</span> String(<span class="string">"abc"</span>);    <span class="comment">//cahr value = new char[]&#123;'a','b','c'&#125;;</span></span><br><span class="line"></span><br><span class="line">StringBuffer sb1 = <span class="keyword">new</span> StringBuffer();  <span class="comment">//char value = new char[16]; 底层创建了默认长度为16的数组</span></span><br><span class="line">sb1.append(<span class="string">'a'</span>);    <span class="comment">//value[0] = 'a';</span></span><br><span class="line">sb1.append(<span class="string">'b'</span>);    <span class="comment">//value[1] = 'b';</span></span><br><span class="line"></span><br><span class="line">StringBuffer sb2 = <span class="keyword">new</span> StringBuffer(<span class="string">"abc"</span>); <span class="comment">//char value = new char["abc".length() + 16]; 底层创建的默认数组会在16的基础上加上初始化value的数值长度</span></span><br><span class="line"><span class="comment">//sb2.append("abc");</span></span><br></pre></td></tr></table></figure>

<p>当 StringBuffer 初始16长度盛不下的时候，需要数组扩容，默认扩容长度为 原有长度的 2 倍 + 2，将原本数组中的元素复制到新的数组中。开发中尽量使用 StringBuffer 和 StringBuilder</p>
<p>StringBuffer 常用方法</p>
<ul>
<li>append(xxx)：提供了众多 append() 方法，用于字符串拼接。</li>
<li>delete(int start, int end)：删除指定位置的内容。</li>
<li>replace(int start, int end, String str)：将指定区域内容替换为 str。</li>
<li>insert(int offset, xxx)：在 offset 位置插入 xxx。</li>
<li>reverse()：将字符序列逆转。</li>
<li>char setCharAt(int n, char ch)：将位置为 n 的字符替换为 ch。</li>
</ul>
<hr>
<h2 id="旧的时间-API"><a href="#旧的时间-API" class="headerlink" title="旧的时间 API"></a>旧的时间 API</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">long</span> time = System.currentTimeMillis();</span><br><span class="line"><span class="comment">//返回当前时间与1970年1月1日00:00:00之间以毫秒为单位的时间差（也称为时间戳）</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Date date1 = <span class="keyword">new</span> Date();    <span class="comment">//默认为当前时间</span></span><br><span class="line">System.out.println(date1.toString());   <span class="comment">//返回当前时间</span></span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Sun Seb 06 15:35:05 CST 2021</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(date1.getTime());    <span class="comment">//时间戳与currentTimeMillis()作业相同</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Date date2 = <span class="keyword">new</span> Date(<span class="number">1559107318619L</span>);  <span class="comment">//返回指定时间</span></span><br><span class="line">System.out.println(date2.toString());</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Wed May 29 13:21:58 CST 2019</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//返回数据库日期格式</span></span><br><span class="line">java.sql.Date date3 = <span class="keyword">new</span> java.sql.Date(<span class="number">1559107318619L</span>);</span><br><span class="line">System.out.println(date3.toString());</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2019-05-29</span><br></pre></td></tr></table></figure>

<p>SimpleDateFormat：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Date date3 = <span class="keyword">new</span> Date(<span class="number">1559107318619L</span>);</span><br><span class="line">SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat();</span><br><span class="line">System.out.println(date3.toString());</span><br><span class="line"><span class="comment">//格式化：日期 ---&gt; 字符串</span></span><br><span class="line">String format = sdf.format(date3);</span><br><span class="line">System.out.println(format);</span><br><span class="line"><span class="comment">//解析：字符串 ---&gt; 日期</span></span><br><span class="line">String str = <span class="keyword">new</span> String(<span class="string">"2021/1/29 下午5:21"</span>);    <span class="comment">//默认构造器情况下</span></span><br><span class="line">Date date4 = sdf.parse(str);</span><br><span class="line">System.out.println(date4.toString());</span><br><span class="line"><span class="comment">//非默认构造器格式化</span></span><br><span class="line">SimpleDateFormat sdf2 = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"h:mm a"</span>); <span class="comment">//h：小时，m：分钟，a：时间状态，y：年，d：天……</span></span><br><span class="line">format = sdf2.format(date3);</span><br><span class="line">System.out.println(format);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Wed May 29 13:21:58 CST 2019</span><br><span class="line">2019&#x2F;5&#x2F;29 下午1:21</span><br><span class="line">Fri Jan 29 17:21:00 CST 2021</span><br><span class="line">1:21 下午</span><br></pre></td></tr></table></figure>

<p>Calendar（一个抽象类）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Calendar cal = Calendar.getInstance();</span><br><span class="line"><span class="comment">//get()</span></span><br><span class="line"><span class="keyword">int</span> days = cal.get(Calendar.DAY_OF_MONTH);<span class="comment">//这个月的第几天</span></span><br><span class="line">System.out.println(days);</span><br><span class="line">days = cal.get(Calendar.DAY_OF_WEEK);<span class="comment">//这个周的第几天</span></span><br><span class="line">System.out.println(days);</span><br><span class="line"><span class="comment">//set()</span></span><br><span class="line">cal.set(Calendar.DAY_OF_MONTH, <span class="number">22</span>);<span class="comment">//将原本这个月的第几天修改为指定数值</span></span><br><span class="line">days = cal.get(Calendar.DAY_OF_MONTH);</span><br><span class="line">System.out.println(days);</span><br><span class="line"><span class="comment">//add()</span></span><br><span class="line">cal.add(Calendar.DAY_OF_MONTH, <span class="number">3</span>);<span class="comment">//在当月第几天基础上加上指定天数</span></span><br><span class="line">days = cal.get(Calendar.DAY_OF_MONTH);</span><br><span class="line">System.out.println(days);</span><br><span class="line"><span class="comment">//getTime()：日历类 ---&gt; Date</span></span><br><span class="line">Date date = cal.getTime();<span class="comment">//获取当前日期的时间</span></span><br><span class="line">System.out.println(date);</span><br><span class="line"><span class="comment">//setTime()：Date ---&gt; 日历类</span></span><br><span class="line">Date date1 = <span class="keyword">new</span> Date(<span class="number">1559107318619L</span>);</span><br><span class="line">cal.setTime(date1);</span><br><span class="line">days = cal.get(Calendar.DAY_OF_MONTH);<span class="comment">//获取被格式化后的当月天数</span></span><br><span class="line">System.out.println(days);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">6</span><br><span class="line">1</span><br><span class="line">22</span><br><span class="line">25</span><br><span class="line">Fri Mar 25 16:44:29 CST 2022</span><br><span class="line">29</span><br></pre></td></tr></table></figure>

<p>注意：</p>
<p>获取的月份：一月是 0，十二月是 11。</p>
<p>获取的周内日期：周日是 1，周六是 7。</p>
<hr>
<h2 id="新的时间-API"><a href="#新的时间-API" class="headerlink" title="新的时间 API"></a>新的时间 API</h2><img src='/img/Java高级/3.png'>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//now()：获取当前的日期、时间</span></span><br><span class="line">LocalDate ld = LocalDate.now();</span><br><span class="line">LocalTime lt = LocalTime.now();</span><br><span class="line">LocalDateTime ldt = LocalDateTime.now();</span><br><span class="line"></span><br><span class="line">System.out.println(ld);</span><br><span class="line">System.out.println(lt);</span><br><span class="line">System.out.println(ldt);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2021-02-06</span><br><span class="line">17:07:45.838510</span><br><span class="line">2021-02-06T17:07:45.838510</span><br></pre></td></tr></table></figure>

<hr>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//of()：设置指定的年、月、日、时、分、秒</span></span><br><span class="line">LocalDateTime ldt = LocalDateTime.of(<span class="number">2021</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">19</span>,<span class="number">24</span>,<span class="number">31</span>);</span><br><span class="line">System.out.println(ldt);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2021-01-01T19:24:31</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(ldt.getDayOfMonth());<span class="comment">//获取当月第几天</span></span><br><span class="line">System.out.println(ldt.getDayOfWeek());<span class="comment">//获取当周第几天</span></span><br><span class="line">System.out.println(ldt.getMonthValue());<span class="comment">//获取几月</span></span><br><span class="line">System.out.println(ldt.getMinute());<span class="comment">//获取当前分钟</span></span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">FRIDAY</span><br><span class="line">1</span><br><span class="line">24</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//体现不可变性，不再原数据上修改</span></span><br><span class="line"><span class="comment">//withXxx()：设置相关属性</span></span><br><span class="line">LocalDateTime ldt1 = ldt.withDayOfMonth(<span class="number">22</span>);<span class="comment">//修改当月的第几天</span></span><br><span class="line">System.out.println(ldt1);</span><br><span class="line">System.out.println(ldt);</span><br><span class="line">LocalDateTime ldt2 = ldt.withHour(<span class="number">5</span>);<span class="comment">//修改当前小时数</span></span><br><span class="line">System.out.println(ldt2);</span><br><span class="line">System.out.println(ldt);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2021-01-22T19:24:31</span><br><span class="line">2021-01-01T19:24:31</span><br><span class="line">2021-01-01T05:24:31</span><br><span class="line">2021-01-01T19:24:31</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//plusXxx()</span></span><br><span class="line">LocalDateTime ldt3 = ldt.plusMonths(<span class="number">5</span>);<span class="comment">//原有月数上加上多少月</span></span><br><span class="line">System.out.println(ldt);</span><br><span class="line">System.out.println(ldt3);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2021-01-01T19:24:31</span><br><span class="line">2021-06-01T19:24:31</span><br></pre></td></tr></table></figure>

<hr>
<p><b>instant</b></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Instant instant = Instant.now();</span><br><span class="line">System.out.println(instant);    <span class="comment">//默认为本初子午线时间</span></span><br><span class="line">OffsetDateTime newInstant = instant.atOffset(ZoneOffset.ofHours(<span class="number">8</span>));<span class="comment">//北京时间处于东八区</span></span><br><span class="line">System.out.println(newInstant);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2021-02-06T11:24:43.405087500Z</span><br><span class="line">2021-02-06T19:24:43.405087500+08:00</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">long</span> mil = instant.toEpochMilli();<span class="comment">//获取instant对应的毫秒数</span></span><br><span class="line">System.out.println(mil);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1559800168274L</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Instant instant1 = Instant.ofEpochMilli(<span class="number">1559800168274L</span>);<span class="comment">//获取指定时间戳对应的时间</span></span><br><span class="line">System.out.println(instant1);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2019-06-06T05:49:28.274Z</span><br></pre></td></tr></table></figure>

<hr>
<p><b>DateTimeFormatter</b></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//DateTimeFormatter：格式化或解析时间、日期</span></span><br><span class="line">DateTimeFormatter dtf = DateTimeFormatter.ISO_LOCAL_DATE_TIME;</span><br><span class="line"><span class="comment">//格式化：日期 --&gt; 字符串</span></span><br><span class="line">LocalDateTime ldt4 = LocalDateTime.now();</span><br><span class="line">String str = dtf.format(ldt4);</span><br><span class="line">System.out.println(ldt4);</span><br><span class="line">System.out.println(str);</span><br><span class="line"><span class="comment">//解析：字符串 --&gt; 日期</span></span><br><span class="line">TemporalAccessor parse = dtf.parse(<span class="string">"2021-02-06T19:37:30.2198616"</span>);</span><br><span class="line">System.out.println(parse);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2021-02-06T19:37:30.219861600</span><br><span class="line">2021-02-06T19:37:30.2198616</span><br><span class="line">&#123;&#125;,ISO resolved to 2021-02-06T19:37:07.422504200</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//本地化相关格式 ofLocalizedDateTime()</span></span><br><span class="line">DateTimeFormatter dtf2 = DateTimeFormatter.ofLocalizedDateTime(FormatStyle.SHORT);</span><br><span class="line">String str2 = dtf2.format(ldt);</span><br><span class="line">System.out.println(str2);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2021&#x2F;1&#x2F;1 下午7:24</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//常用：自定义格式化 ofPattern()</span></span><br><span class="line">DateTimeFormatter dtf3 = DateTimeFormatter.ofPattern(<span class="string">"yyyy-MM-dd hh:mm:ss"</span>);</span><br><span class="line">String str3 = dtf3.format(ldt);</span><br><span class="line">System.out.println(str3);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2021-01-01 07:24:31</span><br></pre></td></tr></table></figure>

<p>补充：</p>
<img src='/img/Java高级/4.png'>

<hr>
<h2 id="Java-比较器"><a href="#Java-比较器" class="headerlink" title="Java 比较器"></a>Java 比较器</h2><p>Java 正常情况下只能进行 “==” 或 “!=” 的比较。</p>
<p>当需要进行大小比较时，需要使用接口 Comparable 或 Comparator</p>
<p><b>Comparable</b></p>
<p>像 String、包装类等实现了 Comparable 接口，重写了 compareTo(obj) 方法，给出了比较两个对象大小的方式。</p>
<p>重写 compareTo() 方法后，进行了从小到大的排序。</p>
<p>重写 compareTo() 的规则：</p>
<ul>
<li>如果当前对象 this 大于形参对象 obj，则返回正整数。</li>
<li>如果当前对象 this 小于形参对象 obj，则返回负整数。</li>
<li>如果当前对象 this 等于形参对象 obj，则返回 0。</li>
</ul>
<p>如果自定义类需要排序，则要实现 Comparable 接口。</p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Goods类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Goods</span> <span class="keyword">implements</span> <span class="title">Comparable</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> price;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Goods</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Goods</span><span class="params">(String name,<span class="keyword">int</span> price)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">int</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Goods&#123;"</span> +</span><br><span class="line">                <span class="string">"name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", price="</span> + price +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(o <span class="keyword">instanceof</span> Goods)&#123;</span><br><span class="line">            Goods goods = (Goods) o;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>.price&gt; goods.price)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">this</span>.price&lt;goods.price)&#123;</span><br><span class="line">                <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>.name.compareTo(goods.name);<span class="comment">//当价格一样时，按照名称从低到高排</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"传入的数据非法"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main方法</span></span><br><span class="line">Goods[] goods = <span class="keyword">new</span> Goods[<span class="number">4</span>];</span><br><span class="line">goods[<span class="number">0</span>] = <span class="keyword">new</span> Goods(<span class="string">"小米"</span>,<span class="number">3999</span>);</span><br><span class="line">goods[<span class="number">1</span>] = <span class="keyword">new</span> Goods(<span class="string">"华为"</span>,<span class="number">2999</span>);</span><br><span class="line">goods[<span class="number">2</span>] = <span class="keyword">new</span> Goods(<span class="string">"苹果"</span>,<span class="number">6999</span>);</span><br><span class="line">goods[<span class="number">3</span>] = <span class="keyword">new</span> Goods(<span class="string">"vivo"</span>,<span class="number">2499</span>);</span><br><span class="line"></span><br><span class="line">Arrays.sort(goods);</span><br><span class="line">System.out.println(Arrays.toString(goods));</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Goods&#123;name&#x3D;&#39;vivo&#39;, price&#x3D;2499&#125;, Goods&#123;name&#x3D;&#39;华为&#39;, price&#x3D;2999&#125;, Goods&#123;name&#x3D;&#39;小米&#39;, price&#x3D;3999&#125;, Goods&#123;name&#x3D;&#39;苹果&#39;, price&#x3D;6999&#125;]</span><br></pre></td></tr></table></figure>

<hr>
<p><b>Comparator 定制排序</b></p>
<p>当元素的类型没有实现 Comparable 接口而又不方便修改代码，或实现了 java.lang.Comarable 接口的排序规则不适合当前操作，则可以使用定制排序。</p>
<p>如需要字符串从大到小排列：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">String[] arr = <span class="keyword">new</span> String[]&#123;<span class="string">"AA"</span>,<span class="string">"CC"</span>,<span class="string">"BB"</span>,<span class="string">"KK"</span>,<span class="string">"FF"</span>,<span class="string">"EE"</span>&#125;;</span><br><span class="line">Arrays.sort(arr,<span class="keyword">new</span> Comparator()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Object o1, Object o2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(o1 <span class="keyword">instanceof</span> String &amp;&amp; o2 <span class="keyword">instanceof</span> String)&#123;</span><br><span class="line">            String s1 = (String) o1;</span><br><span class="line">            String s2 = (String) o2;</span><br><span class="line">            <span class="keyword">return</span> -s1.compareTo(s2);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"输入数据不合法"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">System.out.println(Arrays.toString(arr));</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[KK, FF, EE, CC, BB, AA]</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="System、Math、BigInteger、BigDecimal"><a href="#System、Math、BigInteger、BigDecimal" class="headerlink" title="System、Math、BigInteger、BigDecimal"></a>System、Math、BigInteger、BigDecimal</h2><p><b>System</b></p>
<ul>
<li>void gc()：请求系统进行垃圾回收</li>
<li>void exit(int status)：退出程序，当 status 为 0 时为正常退出，当 status 不为 0 时，为异常退出。</li>
<li>String getProperty(String key)：获取系统中属性名为 key 的属性的对应值。</li>
</ul>
<p><b>Math</b></p>
<img src='/img/Java高级/5.png'>

<p><b>BigInteger、BigDecimal</b></p>
<p>BigInteger 可以表示不可变的任意精度的整数。</p>
<p>BigInteger(String val)：根据字符串构建 BigInteger 对象。</p>
<img src='/img/Java高级/6.png'>

<p>而 BigDecimal 对应的是浮点型。</p>
<p>public BigDecimal(String val)<br>public BigDecimal(double val)</p>
<img src='/img/Java高级/7.png'>

<hr>
<h1 id="枚举类与注解"><a href="#枚举类与注解" class="headerlink" title="枚举类与注解"></a>枚举类与注解</h1><h2 id="枚举类的使用"><a href="#枚举类的使用" class="headerlink" title="枚举类的使用"></a>枚举类的使用</h2><p>当需要定义一组常量时，建议使用枚举类。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> Season&#123;</span><br><span class="line">    SPRING(<span class="string">"春天"</span>,<span class="string">"三月"</span>),</span><br><span class="line">    SUMMER(<span class="string">"夏天"</span>,<span class="string">"六月"</span>),</span><br><span class="line">    AUTUMN(<span class="string">"秋天"</span>,<span class="string">"九月"</span>),</span><br><span class="line">    WINTER(<span class="string">"冬天"</span>,<span class="string">"十二月"</span>);</span><br><span class="line"></span><br><span class="line">    Season(String 夏天, String 六月) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src='/img/Java高级/8.png'>

<p>如果枚举类要实现接口，则每个枚举对象都要重写其抽象方法。</p>
<hr>
<h2 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h2><p>在程序运行后，针对所写注解，执行对应操作。</p>
<p>生成文档的相关注解：</p>
<img src='/img/Java高级/9.png'>

<p>编译时进行格式检查相关注解：</p>
<img src='/img/Java高级/10.png'>

<p>自定义注解：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyAnnotation &#123;</span><br><span class="line">    String[] value();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>自定义注解除了标识作用外，要配上注解的信息处理流程（使用反射）才有意义。</p>
<p>元注解：用于修饰其他注解定义。</p>
<ul>
<li><p>Retention</p>
  <img src='/img/Java高级/11.png'>

  <img src='/img/Java高级/12.png'></li>
<li><p>Target</p>
  <img src='/img/Java高级/13.png'></li>
<li><p>Documented</p>
</li>
<li><p>Inherited</p>
  <img src='/img/Java高级/14.png'>

</li>
</ul>
<p>可重复注解：</p>
<p>创建重复注解声明</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.FIELD;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.TYPE;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(&#123;TYPE,FIELD&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyAnnotations &#123;</span><br><span class="line">    MyAnnotation[] value();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>让某个注解可重复</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.annotation.Repeatable;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Type;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.FIELD;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.TYPE;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(&#123;TYPE,FIELD&#125;)</span><br><span class="line"><span class="meta">@Repeatable</span>(MyAnnotations)  <span class="comment">//可重复关键</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyAnnotation &#123;</span><br><span class="line">    String[] value();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可重复注解使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MyAnnotation</span>(value = <span class="string">"hi"</span>)</span><br><span class="line"><span class="meta">@MyAnnotation</span>(value = <span class="string">"hei"</span>)</span><br></pre></td></tr></table></figure>

<p>类型注解：</p>
<img src='/img/Java高级/15.png'>

<hr>
<h1 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h1><h2 id="集合简述"><a href="#集合简述" class="headerlink" title="集合简述"></a>集合简述</h2><p>数组在定义多个数据方面的特点：</p>
<ul>
<li>一旦初始化以后，其长度就确定了。</li>
<li>数据一但定义好，其元素类型便确定了。</li>
</ul>
<p>数组在定义多个数据方面的缺点：</p>
<ul>
<li>一旦初始化以后，其长度不可修改。</li>
<li>数组提供的方法很有限、非常不便、效率不高。</li>
<li>获取数组中实际元素的个数的需求，没有现成的属性或方法。</li>
<li>数组存储：有序、可重复，对于无序、不可重复的需求不能满足。</li>
</ul>
<p>Java 集合有两大体系：Collection、Map</p>
<ul>
<li>Collection 接口：单列数据、定义了存取一组对象的方法的集合。<ul>
<li>List：元素有序、可重复的集合<ul>
<li>ArrayList、LinkedList、Vector</li>
</ul>
</li>
<li>Set：元素无序、不可重复的集合<ul>
<li>HashSet、LinkedHashSet、TreeSet</li>
</ul>
</li>
</ul>
</li>
<li>Map 接口：双列数据，保存具有映射关系“key-value对”的集合。<ul>
<li>HashMap、LinkedHashMap、TreeMap、Hashtable、Properties</li>
</ul>
</li>
</ul>
<hr>
<h2 id="Collection"><a href="#Collection" class="headerlink" title="Collection"></a>Collection</h2><p>相关的一些方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CollectionTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Collection col = <span class="keyword">new</span> ArrayList();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//add()：将元素添加入集合中</span></span><br><span class="line">        col.add(<span class="string">"AA"</span>);</span><br><span class="line">        col.add(<span class="string">"BB"</span>);</span><br><span class="line">        col.add(<span class="number">123</span>);</span><br><span class="line">        col.add(<span class="keyword">new</span> Date());</span><br><span class="line">        System.out.println(col);</span><br><span class="line">        System.out.println(<span class="string">"********** add() **********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//size()：获取元素的个数</span></span><br><span class="line">        System.out.println(col.size());</span><br><span class="line">        System.out.println(<span class="string">"********** size() **********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//addAll(Collection coll)：将coll中的元素添加到当前集合</span></span><br><span class="line">        Collection coll = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        coll.add(<span class="string">"CC"</span>);</span><br><span class="line">        coll.add(<span class="string">"DD"</span>);</span><br><span class="line">        coll.add(<span class="keyword">new</span> String(<span class="string">"EE"</span>));</span><br><span class="line">        col.addAll(coll);</span><br><span class="line"></span><br><span class="line">        System.out.println(col.size());</span><br><span class="line">        System.out.println(col);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"********** addAll() **********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line">        <span class="comment">//contains(Object obj)：判断当前集合中是否存在 obj</span></span><br><span class="line">        <span class="keyword">boolean</span> cont = col.contains(<span class="number">123</span>);</span><br><span class="line">        System.out.println(cont);</span><br><span class="line">        System.out.println(col.contains(<span class="keyword">new</span> String(<span class="string">"EE"</span>))); <span class="comment">//由此了解到判断的是内容而不是相同地址</span></span><br><span class="line">        <span class="comment">//如果是判断自定义类是否存在，则需要在自定义类中重写equals()</span></span><br><span class="line">        System.out.println(<span class="string">"********** contains() **********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//containsAll(Collection coll)：判断coll中的元素是否在当前集合中都存在</span></span><br><span class="line">        System.out.println(col.contains(coll));</span><br><span class="line">        System.out.println(<span class="string">"********** containsAll() **********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//remove(Object obj)：从当前集合中移除obj元素</span></span><br><span class="line">        System.out.println(col);</span><br><span class="line">        col.remove(<span class="string">"AA"</span>);</span><br><span class="line">        System.out.println(col);</span><br><span class="line">        System.out.println(<span class="string">"********** remove() **********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//removeAll(Collection coll)：从当前集合中移除coll集合中存在的所有元素</span></span><br><span class="line">        System.out.println(coll);</span><br><span class="line">        col.removeAll(coll);</span><br><span class="line">        System.out.println(col);</span><br><span class="line">        System.out.println(<span class="string">"********** removeAll() **********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//retainAll(Collection coll)：获取当前集合和coll的交集，并返回给当前集合</span></span><br><span class="line">        col.addAll(coll);</span><br><span class="line">        coll.add(<span class="string">"PP"</span>);</span><br><span class="line">        System.out.println(col);</span><br><span class="line">        System.out.println(coll);</span><br><span class="line">        col.retainAll(coll);</span><br><span class="line">        System.out.println(col);</span><br><span class="line">        System.out.println(<span class="string">"********** retainAll() **********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//equals(Object obj)：判断当前集合与 obj 集合元素是否相同</span></span><br><span class="line">        Collection coll1 = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        coll1.addAll(col);</span><br><span class="line">        System.out.println(col);</span><br><span class="line">        System.out.println(coll1);</span><br><span class="line">        System.out.println(col.equals(coll1));</span><br><span class="line">        System.out.println(<span class="string">"********** equals() **********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//hashcode()：返回当前对象的hash值</span></span><br><span class="line">        System.out.println(col.hashCode());</span><br><span class="line">        System.out.println(<span class="string">"********** hashCode() **********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//toArray(Object obj)：集合转化为数组</span></span><br><span class="line">        System.out.println(col);</span><br><span class="line">        Object[] arr = col.toArray();</span><br><span class="line">        System.out.println(Arrays.toString(arr));</span><br><span class="line">        System.out.println(<span class="string">"********** toArray() **********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//扩展：数组转化为集合：asList()</span></span><br><span class="line">        List list = Arrays.asList(<span class="keyword">new</span> String[]&#123;<span class="string">"AA"</span>,<span class="string">"BB"</span>,<span class="string">"CC"</span>&#125;);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        System.out.println(<span class="string">"********** asList() **********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//clear()：情况集合中的元素</span></span><br><span class="line">        col.clear();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//isEmpty()：判断当前集合是否为空</span></span><br><span class="line">        System.out.println(col.isEmpty());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">[AA, BB, 123, Mon Seb 07 09:55:36 CST 2021]</span><br><span class="line">********** add() **********</span><br><span class="line"></span><br><span class="line">4</span><br><span class="line">********** size() **********</span><br><span class="line"></span><br><span class="line">7</span><br><span class="line">[AA, BB, 123, Mon Seb 07 09:55:36 CST 2021, CC, DD, EE]</span><br><span class="line">********** addAll() **********</span><br><span class="line"></span><br><span class="line">true</span><br><span class="line">true</span><br><span class="line">********** contains() **********</span><br><span class="line"></span><br><span class="line">false</span><br><span class="line">********** containsAll() **********</span><br><span class="line"></span><br><span class="line">[AA, BB, 123, Mon Seb 07 09:55:36 CST 2021, CC, DD, EE]</span><br><span class="line">[BB, 123, Mon Seb 07 09:55:36 CST 2021, CC, DD, EE]</span><br><span class="line">********** remove() **********</span><br><span class="line"></span><br><span class="line">[CC, DD, EE]</span><br><span class="line">[BB, 123, Mon Seb 07 09:55:36 CST 2021]</span><br><span class="line">********** removeAll() **********</span><br><span class="line"></span><br><span class="line">[BB, 123, Mon Seb 07 09:55:36 CST 2021, CC, DD, EE]</span><br><span class="line">[CC, DD, EE, PP]</span><br><span class="line">[CC, DD, EE]</span><br><span class="line">********** retainAll() **********</span><br><span class="line"></span><br><span class="line">[CC, DD, EE]</span><br><span class="line">[CC, DD, EE]</span><br><span class="line">true</span><br><span class="line">********** equals() **********</span><br><span class="line"></span><br><span class="line">2159839</span><br><span class="line">********** hashCode() **********</span><br><span class="line"></span><br><span class="line">[CC, DD, EE]</span><br><span class="line">[CC, DD, EE]</span><br><span class="line">********** toArray() **********</span><br><span class="line"></span><br><span class="line">[AA, BB, CC]</span><br><span class="line">********** asList() **********</span><br><span class="line"></span><br><span class="line">true</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Iterator-迭代器接口"><a href="#Iterator-迭代器接口" class="headerlink" title="Iterator 迭代器接口"></a>Iterator 迭代器接口</h2><p>Iterator 对象称为迭代器，主要用于遍历 Collection 集合中的元素。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IteratorTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Collection col = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        col.add(<span class="string">"AA"</span>);</span><br><span class="line">        col.add(<span class="string">"BB"</span>);</span><br><span class="line">        col.add(<span class="string">"CC"</span>);</span><br><span class="line">        col.add(<span class="keyword">new</span> String(<span class="string">"Tom"</span>));</span><br><span class="line"></span><br><span class="line">        Iterator ite = col.iterator();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(ite.hasNext())&#123;</span><br><span class="line">            System.out.println(ite.next());</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"**************"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line">        <span class="comment">//上方ite已经遍历到集合末尾，无法重新遍历，因此需要重新添加迭代器</span></span><br><span class="line">        Iterator ite1 = col.iterator();</span><br><span class="line">        <span class="keyword">while</span> (ite1.hasNext())&#123;</span><br><span class="line">            Object obj = ite1.next();</span><br><span class="line">            <span class="keyword">if</span>(<span class="string">"Tom"</span>.equals(obj))&#123;</span><br><span class="line">                ite1.remove();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Iterator ite2 = col.iterator();</span><br><span class="line">        <span class="keyword">while</span> (ite2.hasNext())&#123;</span><br><span class="line">            System.out.println(ite2.next());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">AA</span><br><span class="line">BB</span><br><span class="line">CC</span><br><span class="line">Tom</span><br><span class="line">**************</span><br><span class="line"></span><br><span class="line">AA</span><br><span class="line">BB</span><br><span class="line">CC</span><br></pre></td></tr></table></figure>

<p><b>foreach</b></p>
<p>foreach 也可以遍历集合或数组，它的底层是调用 Iterator</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IteratorTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Collection col = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        col.add(<span class="string">"AA"</span>);</span><br><span class="line">        col.add(<span class="string">"BB"</span>);</span><br><span class="line">        col.add(<span class="string">"CC"</span>);</span><br><span class="line">        col.add(<span class="keyword">new</span> String(<span class="string">"Tom"</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//for(集合元素类型 局部变量 : 被遍历的集合)</span></span><br><span class="line">        <span class="keyword">for</span>(Object obj : col)&#123;</span><br><span class="line">            System.out.println(obj);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AA</span><br><span class="line">BB</span><br><span class="line">CC</span><br><span class="line">Tom</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Collection-子接口之-List-接口"><a href="#Collection-子接口之-List-接口" class="headerlink" title="Collection 子接口之 List 接口"></a>Collection 子接口之 List 接口</h2><img src='/img/Java高级/16.png'>

<p>ArrayList、LinkedList、Vector 三者的异同：</p>
<ul>
<li>同：三个类都实现了 List 接口，存储数据都是有序的、可重复的</li>
</ul>
<p>异：</p>
<ul>
<li>ArrayList：作为 List 接口的主要实现类；线程不安全的，效率高；底层使用 Object[] elementData 存储</li>
<li>LinkedList：底层使用双向链表存储；频繁插入、删除，此类效率比 ArrayList 高</li>
<li>Vector：作为 List 接口的古老实现类；线程安全的，效率低；底层使用 Object[] elementData 存储</li>
</ul>
<p><b>ArrayList</b></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ArrayList list = <span class="keyword">new</span> ArrayList();</span><br><span class="line"><span class="comment">//底层Object[] elementData初始化为&#123;&#125;，并为创建数组</span></span><br><span class="line"></span><br><span class="line">list.add(<span class="number">1</span>)</span><br><span class="line"><span class="comment">//第一次调用add()时，底层才创建了长度为10的数组，并将数据1添加到elementData</span></span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">list.add(<span class="number">11</span>)</span><br><span class="line"><span class="comment">//当数据溢出时，默认情况下扩容到原本容量的1.5倍，将原数组复制到新数组当中</span></span><br></pre></td></tr></table></figure>

<p><b>LinkedList</b></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">LinkedList list = <span class="keyword">new</span> LinkedList();</span><br><span class="line"><span class="comment">//内部声明了Node类型的first和last属性，默认值为null</span></span><br><span class="line">list.add(<span class="number">1</span>);</span><br><span class="line"><span class="comment">//将1封装到Node当中，创建了Node对象</span></span><br><span class="line"><span class="comment">//以下是Node的定义：</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">E</span>&gt;</span>&#123;</span><br><span class="line">    E item;</span><br><span class="line">    Node&lt;E&gt; next;</span><br><span class="line">    Node&lt;E&gt; prev;</span><br><span class="line"></span><br><span class="line">    Node(Node&lt;E&gt; prev,E element,Node&lt;E&gt; next)&#123;</span><br><span class="line">        <span class="keyword">this</span>.item = element;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">        <span class="keyword">this</span>.prev = prev;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><b>List 常用方法</b></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ArrayList list = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        list.add(<span class="number">123</span>);</span><br><span class="line">        list.add(<span class="number">456</span>);</span><br><span class="line">        list.add(<span class="keyword">new</span> String(<span class="string">"Tom"</span>));</span><br><span class="line">        list.add(<span class="number">123</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(list);</span><br><span class="line">        System.out.println(<span class="string">"***********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//add(int index,Object ele)：在index位置插入元素ele</span></span><br><span class="line">        list.add(<span class="number">1</span>,<span class="keyword">new</span> String(<span class="string">"Jack"</span>));</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        System.out.println(<span class="string">"***********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//boolean addAll(int index,Collection eles)：从index位置开始将eles中所有元素添加进去</span></span><br><span class="line">        List list1 = Arrays.asList(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">        list.addAll(list1);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        System.out.println(<span class="string">"***********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Object get(int index)：获取index位置的元素</span></span><br><span class="line">        System.out.println(list.get(<span class="number">0</span>));</span><br><span class="line">        System.out.println(<span class="string">"***********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//int indexOf(Object obj)：返回obj在集合中首次出现的位置</span></span><br><span class="line">        <span class="keyword">int</span> index = list.indexOf(<span class="number">456</span>);</span><br><span class="line">        System.out.println(index);</span><br><span class="line">        System.out.println(<span class="string">"***********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//int lastIndexOf(Object obj)：返回obj在集合中最后一次出现的位置</span></span><br><span class="line">        <span class="keyword">int</span> lastindex = list.lastIndexOf(<span class="number">123</span>);</span><br><span class="line">        System.out.println(lastindex);</span><br><span class="line">        System.out.println(<span class="string">"***********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Object remove(int index)：移除index处的元素，并返回此元素</span></span><br><span class="line">        <span class="comment">//如果删除的是1，则默认是删除索引1而不是数据1，需要对数据进行装箱才能进行删除数据1</span></span><br><span class="line">        Object obj1 = list.remove(<span class="number">0</span>);</span><br><span class="line">        System.out.println(obj1);</span><br><span class="line">        System.out.println(<span class="string">"***********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Object set(int index,Object ele)：设置index位置元素为ele</span></span><br><span class="line">        System.out.println(list);</span><br><span class="line">        list.set(<span class="number">1</span>,<span class="string">"Lucy"</span>);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        System.out.println(<span class="string">"***********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//List subList(int fromIndex, int toIndex)：返回从fromIndex到toIndex位置的左臂右开区间的集合元素</span></span><br><span class="line">        List sublist = list.subList(<span class="number">2</span>, <span class="number">4</span>);</span><br><span class="line">        System.out.println(sublist);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[123, 456, Tom, 123]</span><br><span class="line">***********</span><br><span class="line"></span><br><span class="line">[123, Jack, 456, Tom, 123]</span><br><span class="line">***********</span><br><span class="line"></span><br><span class="line">[123, Jack, 456, Tom, 123, 1, 2, 3]</span><br><span class="line">***********</span><br><span class="line"></span><br><span class="line">123</span><br><span class="line">***********</span><br><span class="line"></span><br><span class="line">2</span><br><span class="line">***********</span><br><span class="line"></span><br><span class="line">4</span><br><span class="line">***********</span><br><span class="line"></span><br><span class="line">123</span><br><span class="line">***********</span><br><span class="line"></span><br><span class="line">[Jack, 456, Tom, 123, 1, 2, 3]</span><br><span class="line">[Jack, Lucy, Tom, 123, 1, 2, 3]</span><br><span class="line">***********</span><br><span class="line"></span><br><span class="line">[Tom, 123]</span><br></pre></td></tr></table></figure>

<p>总结常用方法：</p>
<ul>
<li>增：add(Object obj);</li>
<li>删：remove(int index) / remove(Object obj);</li>
<li>改：set(int index, Object ele);</li>
<li>查：get(int index);</li>
<li>插：add(int index, Object ele);</li>
<li>长度：size();</li>
<li>遍历：<ul>
<li>Iterator迭代器</li>
<li>foreach</li>
<li>普通for</li>
</ul>
</li>
</ul>
<hr>
<h2 id="Collection-子接口之-Set-接口"><a href="#Collection-子接口之-Set-接口" class="headerlink" title="Collection 子接口之 Set 接口"></a>Collection 子接口之 Set 接口</h2><img src='/img/Java高级/17.png'>

<p>实现类：</p>
<img src='/img/Java高级/18.png'>

<img src='/img/Java高级/19.png'>

<img src='/img/Java高级/20.png'>

<ul>
<li>HashSet：作为 Set 的主要实现类；线程不安全；可以存储 null 值</li>
<li>LinkedHashSet：作为 HashSet 的子类；遍历其内部时，可以按照添加的顺序遍历，频繁遍历效率高于 HashSet</li>
<li>TreeSet：可以按照添加对象的指定属性，进行排序</li>
</ul>
<p>无序性：存储的数据在底层数组并非按照数组索引的顺序添加的，而是根据数据的 Hash 值进行添加。</p>
<p>不可重复性：保证添加的元素按照 equals() 判断时，不能返回 true，即相同元素只能添加一个</p>
<p>添加元素的过程，以 HashSet 为例：</p>
<ol>
<li>我们向 HashSet 中添加元素 a，首先调用元素 a 所在类的 hashCode() 方法，计算元素 a 的 hash 值，此 hash 值接着通过某种算法计算出 HashSet 底层数组中的存放位置，判断数组上此位置上是否已有元素</li>
<li>如果此位置上没有其他元素，则将 a 添加进去</li>
<li>如果此位置上有其他元素 b（或以链表形式存在的多个元素），则比较元素 a 与 元素 b 的 hash 值，如果 hash 值不相同，则元素 a 添加成功，如果 hash 值相同，则调用元素 a 所在类的 equals() 方法，equals() 返回 true，则添加失败，如果是 false，则添加成功</li>
<li>添加成功的话，原来的元素在数组中，指向元素 a，即将元素 a 添加到该索引位置的链表末尾</li>
<li>总结就是数据结构的哈希表</li>
<li>向 Set 中添加的数据，其所在类一定要重写 hashCode() 和 equals()</li>
</ol>
<p>重写类中的 hashCode，如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> result = name != <span class="keyword">null</span> ? name.hashCode() : <span class="number">0</span>;</span><br><span class="line">    result = <span class="number">31</span> * result + age;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过将一个属性的 hash 值放大，再添加某种特征数据，返回得到的 hash 值重复的可能性更小。</p>
<p><b>LinkedHashSet</b></p>
<p>作为 HashSet 的子类，在添加数据的同时，每个数据还维护了两个引用，记录此数据的前一项数据和后一项数据</p>
<img src='/img/Java高级/21.png'>

<p><b>TreeSet</b></p>
<p>向 TreeSet 中添加的对象必须是相同类的对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TreeTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        TreeSet ts = <span class="keyword">new</span> TreeSet();</span><br><span class="line">        ts.add(<span class="number">10</span>);</span><br><span class="line">        ts.add(<span class="number">11</span>);</span><br><span class="line">        ts.add(-<span class="number">5</span>);</span><br><span class="line">        ts.add(<span class="number">1</span>);</span><br><span class="line">        ts.add(<span class="number">90</span>);</span><br><span class="line">        ts.add(<span class="number">9</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(Object obj:ts)&#123;</span><br><span class="line">            System.out.println(obj);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-5</span><br><span class="line">1</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">90</span><br></pre></td></tr></table></figure>

<p>可以看到存储的数据从小到大排序过的</p>
<p>对于添加的是对象的话，需要重写 compareTo() 来决定用什么进行比较排序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonTest</span> <span class="keyword">implements</span> <span class="title">Comparable</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PersonTest</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PersonTest</span><span class="params">(String name,<span class="keyword">int</span> age)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"PersonTest&#123;"</span> +</span><br><span class="line">                <span class="string">"name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", age="</span> + age +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Object o)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(o <span class="keyword">instanceof</span> PersonTest)&#123;</span><br><span class="line">            PersonTest p = (PersonTest) o;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.name.compareTo(p.name);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"输入数据非法"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main方法</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TreeTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        TreeSet ts = <span class="keyword">new</span> TreeSet();</span><br><span class="line">        ts.add(<span class="keyword">new</span> PersonTest(<span class="string">"Tom"</span>,<span class="number">13</span>));</span><br><span class="line">        ts.add(<span class="keyword">new</span> PersonTest(<span class="string">"Jack"</span>,<span class="number">71</span>));</span><br><span class="line">        ts.add(<span class="keyword">new</span> PersonTest(<span class="string">"Tenny"</span>,<span class="number">30</span>));</span><br><span class="line">        ts.add(<span class="keyword">new</span> PersonTest(<span class="string">"Lucy"</span>,<span class="number">17</span>));</span><br><span class="line"></span><br><span class="line">        Iterator itr = ts.iterator();</span><br><span class="line">        <span class="keyword">while</span> (itr.hasNext())&#123;</span><br><span class="line">            System.out.println(itr.next());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PersonTest&#123;name&#x3D;&#39;Jack&#39;, age&#x3D;71&#125;</span><br><span class="line">PersonTest&#123;name&#x3D;&#39;Lucy&#39;, age&#x3D;17&#125;</span><br><span class="line">PersonTest&#123;name&#x3D;&#39;Tenny&#39;, age&#x3D;30&#125;</span><br><span class="line">PersonTest&#123;name&#x3D;&#39;Tom&#39;, age&#x3D;13&#125;</span><br></pre></td></tr></table></figure>

<p><b>TreeSet 定制排序</b></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TreeTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//声明定制排序对象：按照年龄从小到大</span></span><br><span class="line">        Comparator com = <span class="keyword">new</span> Comparator() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Object o1, Object o2)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(o1 <span class="keyword">instanceof</span> PersonTest &amp;&amp; o2 <span class="keyword">instanceof</span> PersonTest)&#123;</span><br><span class="line">                    PersonTest p1 = (PersonTest) o1;</span><br><span class="line">                    PersonTest p2 = (PersonTest) o2;</span><br><span class="line">                    <span class="keyword">return</span> Integer.compare(p1.getAge(),p2.getAge());</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"输入数据非法"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">//构造器中参数为定制排序对象</span></span><br><span class="line">        TreeSet ts = <span class="keyword">new</span> TreeSet(com);</span><br><span class="line">        ts.add(<span class="keyword">new</span> PersonTest(<span class="string">"Tom"</span>,<span class="number">13</span>));</span><br><span class="line">        ts.add(<span class="keyword">new</span> PersonTest(<span class="string">"Jack"</span>,<span class="number">71</span>));</span><br><span class="line">        ts.add(<span class="keyword">new</span> PersonTest(<span class="string">"Tenny"</span>,<span class="number">30</span>));</span><br><span class="line">        ts.add(<span class="keyword">new</span> PersonTest(<span class="string">"Lucy"</span>,<span class="number">17</span>));</span><br><span class="line"></span><br><span class="line">        Iterator itr = ts.iterator();</span><br><span class="line">        <span class="keyword">while</span> (itr.hasNext())&#123;</span><br><span class="line">            System.out.println(itr.next());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PersonTest&#123;name&#x3D;&#39;Tom&#39;, age&#x3D;13&#125;</span><br><span class="line">PersonTest&#123;name&#x3D;&#39;Lucy&#39;, age&#x3D;17&#125;</span><br><span class="line">PersonTest&#123;name&#x3D;&#39;Tenny&#39;, age&#x3D;30&#125;</span><br><span class="line">PersonTest&#123;name&#x3D;&#39;Jack&#39;, age&#x3D;71&#125;</span><br></pre></td></tr></table></figure>

<p>定制排序需要靠 compare 进行比较</p>
<hr>
<h2 id="Map-接口"><a href="#Map-接口" class="headerlink" title="Map 接口"></a>Map 接口</h2><img src='/img/Java高级/22.png'>

<p>Map：双列数据，存储 key-value 对的数据</p>
<ul>
<li>HashMap：作为 Map 的主要实现类；线程不安全，效率高；存储 null 的 key 和 value<ul>
<li>LinkedHashMap：保证在遍历 map 元素时，可以按照添加的顺序实现遍历（在原有 HashMap 底层结构的基础上，添加了一对指针，指向前一个和后一个元素）</li>
</ul>
</li>
<li>TreeMap：保证按照添加的 key-value 对进行排序，实现排序遍历，考虑 key 的自然排序或定制排序，底层是红黑树，key 必须是同类型对象</li>
<li>Hashtable：作为 Map 的古老实现类；线程安全，效率低；不能存储 null 的key 和 value<ul>
<li>Properties：常用来处理配置文件。key 和 value 都是 String 类型</li>
</ul>
</li>
</ul>
<p><font color="red"><b>HashMap 底层实现原理</b></font></p>
<ul>
<li>底层数组是 Node[]，而非Entry[]</li>
<li>首次调用 put() 方法时，底层创建长度为 16 的 Node[] 数组</li>
<li>put(key1, value1)：首先，调用 key1 所在类的 hashCode() 计算 key1 的哈希值，此哈希值经过某种算法计算后，得到在 Node[] 数组中存放的位置，如果此位置上数据为空，则添加成功，如果不为空，则此位置存在一个或多个数据，比较 key1 和已经存在的一个或多个数据的哈希值：如果 key1 的哈希值与已经存在的数据的哈希值都不相同，此时 key1-value1 添加成功，如果存在(key2-value2)相同，则继续调用 key1 所在类的 equals() 方法，如果 equals() 返回 false，则添加成功，如果返回 true，则使用 value1 替换 value2</li>
<li>底层结构：数组 + 链表 + 红黑树</li>
<li>某一个位置上的索引中元素以链表形式存储的数据超过 8 个，且当前数组长度超过 64 时，此时索引位置上的所有数据改为红黑树存储</li>
<li>默认扩容方式：扩容为原来容量的 2 倍，并将原有数据复制到新的数组</li>
</ul>
<img src='/img/Java高级/24.png'>

<p>默认加载因子的默认值为 0.75</p>
<p><b>LinkedHashMap 底层实现原理</b></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">extends</span> <span class="title">HashMap</span>.<span class="title">Node</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">    Entry&lt;K,V&gt; before, after;</span><br><span class="line">    Entry(<span class="keyword">int</span> hash, K key, V value, Node&lt;K,V&gt; next) &#123;</span><br><span class="line">        <span class="keyword">super</span>(hash, key, value, next);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>源码中，该段代码能记录添加元素的先后顺序，可以使得 LinkedHashMap 能够按照元素添加顺序进行遍历</p>
<p>HashSet 的底层实际上就是创建了一个 HashMap</p>
<hr>
<p><b>Map 中存储 key-value 的特点</b></p>
<img src='/img/Java高级/23.png'>

<p>由图：key 用 Set 存储（无序的、不可重复的），value 用 Collection存储（无序的、可重复的），在存入数据时虽然是 <code>put(key,value)</code>，但实际上是存入一个个 Entry，在 put 的时候会自动包装成 <code>entry(key,value)</code> 存入。</p>
<p>一个键值对：key-value 构成了一个 Entry 对象，使用 Set 存储（无序的、不可重复的）</p>
<p>key 所在类要重写 equals() 和 hashCode() （以 HashMap 为例）</p>
<p>value 所在类要重写 equals()</p>
<hr>
<h2 id="Map-中的常用方法"><a href="#Map-中的常用方法" class="headerlink" title="Map 中的常用方法"></a>Map 中的常用方法</h2><img src='/img/Java高级/25.png'>

<p>增、删、改操作：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Map map = <span class="keyword">new</span> HashMap();</span><br><span class="line">        <span class="comment">//put()：添加单个键值对</span></span><br><span class="line">        map.put(<span class="string">"AA"</span>, <span class="number">123</span>);</span><br><span class="line">        map.put(<span class="string">"BB"</span>, <span class="number">456</span>);</span><br><span class="line">        map.put(<span class="string">"CC"</span>, <span class="number">789</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(map);</span><br><span class="line">        System.out.println(<span class="string">"**********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//put()：作用于修改键值对</span></span><br><span class="line">        map.put(<span class="string">"AA"</span>, <span class="number">12</span>);</span><br><span class="line">        System.out.println(map);</span><br><span class="line">        System.out.println(<span class="string">"**********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//putAll()：将一个Map对象添加进来</span></span><br><span class="line">        Map map1 = <span class="keyword">new</span> HashMap();</span><br><span class="line">        map1.put(<span class="string">"DD"</span>, <span class="number">000</span>);</span><br><span class="line">        map1.put(<span class="string">"EE"</span>, <span class="number">999</span>);</span><br><span class="line"></span><br><span class="line">        map.putAll(map1);</span><br><span class="line">        System.out.println(map);</span><br><span class="line">        System.out.println(<span class="string">"**********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//remove(Object key)：移除 key 所在的键值对，并返回</span></span><br><span class="line">        Object value = map.remove(<span class="string">"CC"</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(map);</span><br><span class="line">        System.out.println(<span class="string">"**********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line">        <span class="comment">//clear()：清空数据，与map = null不同，只清空数据</span></span><br><span class="line">        map.clear();</span><br><span class="line">        System.out.println(map);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;AA&#x3D;123, BB&#x3D;456, CC&#x3D;789&#125;</span><br><span class="line">**********</span><br><span class="line"></span><br><span class="line">&#123;AA&#x3D;12, BB&#x3D;456, CC&#x3D;789&#125;</span><br><span class="line">**********</span><br><span class="line"></span><br><span class="line">&#123;AA&#x3D;12, BB&#x3D;456, CC&#x3D;789, DD&#x3D;0, EE&#x3D;999&#125;</span><br><span class="line">**********</span><br><span class="line"></span><br><span class="line">&#123;AA&#x3D;12, BB&#x3D;456, DD&#x3D;0, EE&#x3D;999&#125;</span><br><span class="line">**********</span><br><span class="line"></span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>元素查询操作：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Map map = <span class="keyword">new</span> HashMap();</span><br><span class="line">        map.put(<span class="string">"AA"</span>, <span class="number">123</span>);</span><br><span class="line">        map.put(<span class="string">"BB"</span>, <span class="number">456</span>);</span><br><span class="line">        map.put(<span class="string">"CC"</span>, <span class="number">789</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Object get(Object key)：获取键值为 key 的键值对，并返回</span></span><br><span class="line">        System.out.println(map.get(<span class="string">"BB"</span>));</span><br><span class="line">        System.out.println(<span class="string">"**********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//boolean containsKey(Object key)：是否存在指定的 key 并返回</span></span><br><span class="line">        System.out.println(map.containsKey(<span class="string">"CC"</span>));</span><br><span class="line">        System.out.println(<span class="string">"**********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//boolean containsValue(value)：是否存在指定的 value 并返回</span></span><br><span class="line">        System.out.println(map.containsValue(<span class="number">123</span>));</span><br><span class="line">        System.out.println(<span class="string">"**********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//int size()：返回包含的键值对数量</span></span><br><span class="line">        System.out.println(map.size());</span><br><span class="line">        System.out.println(<span class="string">"**********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//boolean isEmpty()：判断 map 是否为空</span></span><br><span class="line">        System.out.println(map.isEmpty());</span><br><span class="line">        System.out.println(<span class="string">"**********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//boolean equals(Object obj)：判断当前 map 和参数对象 obj 是否相等</span></span><br><span class="line">        Map map1 = <span class="keyword">new</span> HashMap();</span><br><span class="line">        map1.put(<span class="string">"AA"</span>, <span class="number">123</span>);</span><br><span class="line">        map1.put(<span class="string">"BB"</span>, <span class="number">456</span>);</span><br><span class="line">        map1.put(<span class="string">"CC"</span>, <span class="number">789</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(map1);</span><br><span class="line">        System.out.println(map);</span><br><span class="line">        System.out.println(map.equals(map1));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">456</span><br><span class="line">**********</span><br><span class="line"></span><br><span class="line">true</span><br><span class="line">**********</span><br><span class="line"></span><br><span class="line">true</span><br><span class="line">**********</span><br><span class="line"></span><br><span class="line">3</span><br><span class="line">**********</span><br><span class="line"></span><br><span class="line">false</span><br><span class="line">**********</span><br><span class="line"></span><br><span class="line">&#123;AA&#x3D;123, BB&#x3D;456, CC&#x3D;789&#125;</span><br><span class="line">&#123;AA&#x3D;123, BB&#x3D;456, CC&#x3D;789&#125;</span><br><span class="line">true</span><br></pre></td></tr></table></figure>

<p>遍历操作：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Map map = <span class="keyword">new</span> HashMap();</span><br><span class="line">        map.put(<span class="string">"AA"</span>, <span class="number">123</span>);</span><br><span class="line">        map.put(<span class="string">"BB"</span>, <span class="number">456</span>);</span><br><span class="line">        map.put(<span class="string">"CC"</span>, <span class="number">789</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Set keySet()：遍历所有的 key 集</span></span><br><span class="line">        Set set = map.keySet();</span><br><span class="line">        Iterator itr = set.iterator();</span><br><span class="line">        <span class="keyword">while</span> (itr.hasNext())&#123;</span><br><span class="line">            System.out.println(itr.next());</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"**********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Colllection values()：遍历所有的 value 集</span></span><br><span class="line">        Collection col = map.values();</span><br><span class="line">        Iterator itr1 = col.iterator();</span><br><span class="line">        <span class="keyword">while</span> (itr1.hasNext())&#123;</span><br><span class="line">            System.out.println(itr1.next());</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"**********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Set entrySet()：遍历所有的key-value</span></span><br><span class="line">        Set seta = map.entrySet();</span><br><span class="line">        Iterator itr2 = seta.iterator();</span><br><span class="line">        <span class="keyword">while</span> (itr2.hasNext())&#123;</span><br><span class="line">            System.out.println(itr2.next());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">AA</span><br><span class="line">BB</span><br><span class="line">CC</span><br><span class="line">**********</span><br><span class="line"></span><br><span class="line">123</span><br><span class="line">456</span><br><span class="line">789</span><br><span class="line">**********</span><br><span class="line"></span><br><span class="line">AA&#x3D;123</span><br><span class="line">BB&#x3D;456</span><br><span class="line">CC&#x3D;789</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="TreeHashMap"><a href="#TreeHashMap" class="headerlink" title="TreeHashMap"></a>TreeHashMap</h2><p><b>自然排序：</b></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TreeMapTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        TreeMap tm = <span class="keyword">new</span> TreeMap();</span><br><span class="line">        PersonTest p1 = <span class="keyword">new</span> PersonTest(<span class="string">"Rose"</span>,<span class="number">17</span>);</span><br><span class="line">        PersonTest p2 = <span class="keyword">new</span> PersonTest(<span class="string">"Lucy"</span>,<span class="number">18</span>);</span><br><span class="line">        PersonTest p3 = <span class="keyword">new</span> PersonTest(<span class="string">"Tom"</span>,<span class="number">15</span>);</span><br><span class="line">        PersonTest p4 = <span class="keyword">new</span> PersonTest(<span class="string">"Monsey"</span>,<span class="number">17</span>);</span><br><span class="line"></span><br><span class="line">        tm.put(p1, <span class="number">95</span>);</span><br><span class="line">        tm.put(p2, <span class="number">77</span>);</span><br><span class="line">        tm.put(p3, <span class="number">69</span>);</span><br><span class="line">        tm.put(p4, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">        Set ts = tm.entrySet();</span><br><span class="line">        Iterator itr = ts.iterator();</span><br><span class="line">        <span class="keyword">while</span> (itr.hasNext())&#123;</span><br><span class="line">            <span class="comment">//改变原有输出形态</span></span><br><span class="line">            Object obj = itr.next();</span><br><span class="line">            Map.Entry entry = (Map.Entry) obj;</span><br><span class="line">            System.out.println(entry.getKey() + <span class="string">" --------&gt; "</span> + entry.getValue());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//PersonTest 类中的 compareTo 是根据名字从小到大排序的</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Object o)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(o <span class="keyword">instanceof</span> PersonTest)&#123;</span><br><span class="line">            PersonTest p = (PersonTest) o;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.name.compareTo(p.name);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"输入数据非法"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PersonTest&#123;name&#x3D;&#39;Lucy&#39;, age&#x3D;18&#125;--------&gt;77</span><br><span class="line">PersonTest&#123;name&#x3D;&#39;Monsey&#39;, age&#x3D;17&#125;--------&gt;100</span><br><span class="line">PersonTest&#123;name&#x3D;&#39;Rose&#39;, age&#x3D;17&#125;--------&gt;95</span><br><span class="line">PersonTest&#123;name&#x3D;&#39;Tom&#39;, age&#x3D;15&#125;--------&gt;69</span><br></pre></td></tr></table></figure>

<p>TreeHashMap 根据 key 所在类的 compareTo() 方法进行了自然排序</p>
<p><b>定制排序：</b></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TreeMapTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        TreeMap tm = <span class="keyword">new</span> TreeMap(<span class="keyword">new</span> Comparator() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Object o1, Object o2)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (o1 <span class="keyword">instanceof</span> PersonTest &amp;&amp; o2 <span class="keyword">instanceof</span> PersonTest)&#123;</span><br><span class="line">                    PersonTest p1 = (PersonTest) o1;</span><br><span class="line">                    PersonTest p2 = (PersonTest) o2;</span><br><span class="line">                    <span class="keyword">return</span> Integer.compare(p1.getAge(), p2.getAge());</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"输入的数据非法"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        PersonTest p1 = <span class="keyword">new</span> PersonTest(<span class="string">"Rose"</span>,<span class="number">17</span>);</span><br><span class="line">        PersonTest p2 = <span class="keyword">new</span> PersonTest(<span class="string">"Lucy"</span>,<span class="number">18</span>);</span><br><span class="line">        PersonTest p3 = <span class="keyword">new</span> PersonTest(<span class="string">"Tom"</span>,<span class="number">15</span>);</span><br><span class="line">        PersonTest p4 = <span class="keyword">new</span> PersonTest(<span class="string">"Monsey"</span>,<span class="number">17</span>);</span><br><span class="line"></span><br><span class="line">        tm.put(p1, <span class="number">95</span>);</span><br><span class="line">        tm.put(p2, <span class="number">77</span>);</span><br><span class="line">        tm.put(p3, <span class="number">69</span>);</span><br><span class="line">        tm.put(p4, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">        Set ts = tm.entrySet();</span><br><span class="line">        Iterator itr = ts.iterator();</span><br><span class="line">        <span class="keyword">while</span> (itr.hasNext())&#123;</span><br><span class="line">            <span class="comment">//改变原有输出形态</span></span><br><span class="line">            Object obj = itr.next();</span><br><span class="line">            Map.Entry entry = (Map.Entry) obj;</span><br><span class="line">            System.out.println(entry.getKey() + <span class="string">" --------&gt; "</span> + entry.getValue());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PersonTest&#123;name&#x3D;&#39;Tom&#39;, age&#x3D;15&#125; --------&gt; 69</span><br><span class="line">PersonTest&#123;name&#x3D;&#39;Rose&#39;, age&#x3D;17&#125; --------&gt; 100</span><br><span class="line">PersonTest&#123;name&#x3D;&#39;Lucy&#39;, age&#x3D;18&#125; --------&gt; 77</span><br></pre></td></tr></table></figure>

<p>在原本的 TreeHashMap() 空参构造器中引入 Comparator() 对象，并重写 compare() 方法，此处是根据年龄从小到大进行排序，因为做排序的指标数据是唯一的，因此上面 p4 对象中年龄与 p1 对象相同，而 p1 对象更先引入，因此无法引入 p4，而原本要给 p4 的 value 被赋给了 p1</p>
<hr>
<h2 id="Properties"><a href="#Properties" class="headerlink" title="Properties"></a>Properties</h2><img src='/img/Java高级/26.png'>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PropertiesTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Properties pros = <span class="keyword">new</span> Properties();</span><br><span class="line"></span><br><span class="line">        FileInputStream fis = <span class="keyword">new</span> FileInputStream(<span class="string">"JA.properties"</span>); <span class="comment">//将文件读入流</span></span><br><span class="line">        pros.load(fis); <span class="comment">//加载流对应文件</span></span><br><span class="line"></span><br><span class="line">        String name = pros.getProperty(<span class="string">"name"</span>);</span><br><span class="line">        String password = pros.getProperty(<span class="string">"password"</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"name = "</span> + name + <span class="string">"      "</span> + <span class="string">"password = "</span> + password);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>JA.properties：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name&#x3D;诗文</span><br><span class="line">password&#x3D;shiwen112233</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name &#x3D; 诗文      password &#x3D; shiwen112233</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Collections-工具类"><a href="#Collections-工具类" class="headerlink" title="Collections 工具类"></a>Collections 工具类</h2><img src='/img/Java高级/27.png'>

<p>常用方法：</p>
<img src='/img/Java高级/28.png'>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CollectionsTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        List list = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        list.add(<span class="number">123</span>);</span><br><span class="line">        list.add(<span class="number">45</span>);</span><br><span class="line">        list.add(<span class="number">1</span>);</span><br><span class="line">        list.add(-<span class="number">9</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(list);</span><br><span class="line">        <span class="comment">//reverse()：反转</span></span><br><span class="line">        Collections.reverse(list);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        System.out.println(<span class="string">"**********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//shuffle()：随机排序</span></span><br><span class="line">        Collections.shuffle(list);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        System.out.println(<span class="string">"**********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//sort(list)：自然排序   /   sort(list,Comparator)：定制排序</span></span><br><span class="line">        <span class="comment">//从小到大</span></span><br><span class="line">        Collections.sort(list);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        <span class="comment">//从大到小</span></span><br><span class="line">        Collections.sort(list, <span class="keyword">new</span> Comparator() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Object o1, Object o2)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(o1 <span class="keyword">instanceof</span> Integer &amp;&amp; o2 <span class="keyword">instanceof</span> Integer)&#123;</span><br><span class="line">                    Integer i1 = (Integer) o1;</span><br><span class="line">                    Integer i2 = (Integer) o2;</span><br><span class="line">                    <span class="keyword">return</span> -Integer.compare(i1, i2);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"数据非法"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        System.out.println(<span class="string">"**********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//swap(List list, int index1, int index2)：交换list中两个索引的元素</span></span><br><span class="line">        Collections.swap(list,<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        System.out.println(<span class="string">"**********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//int frequnency(List list,Obejct obj)：获取obj在list中存储的频率，并返回</span></span><br><span class="line">        list.add(<span class="number">123</span>);</span><br><span class="line">        list.add(<span class="number">123</span>);</span><br><span class="line">        list.add(<span class="number">123</span>);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        <span class="keyword">int</span> fre = Collections.frequency(list,<span class="number">123</span>);</span><br><span class="line">        System.out.println(fre);</span><br><span class="line">        System.out.println(<span class="string">"**********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//copy(List dest, List src)：将src中的元素复制给dest</span></span><br><span class="line">        <span class="comment">//因为我们预计要将list复制给dest，而复制过程dest的数组长度不能低于list的长度</span></span><br><span class="line">        <span class="comment">//因此可以先将与list等长的空数组赋给dest</span></span><br><span class="line">        List dest = Arrays.asList(<span class="keyword">new</span> Object[list.size()]);</span><br><span class="line"></span><br><span class="line">        Collections.copy(dest, list);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">        System.out.println(dest);</span><br><span class="line">        System.out.println(<span class="string">"**********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//boolean replaceAll(List list, Object oldVal, Object newVal)：将list数组中oldVal替换为newVal，并返回</span></span><br><span class="line">        System.out.println(list);</span><br><span class="line">        <span class="keyword">boolean</span> re = Collections.replaceAll(list, <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[123, 45, 1, -9]</span><br><span class="line">[-9, 1, 45, 123]</span><br><span class="line">**********</span><br><span class="line"></span><br><span class="line">[1, -9, 45, 123]</span><br><span class="line">**********</span><br><span class="line"></span><br><span class="line">[-9, 1, 45, 123]</span><br><span class="line">[123, 45, 1, -9]</span><br><span class="line">**********</span><br><span class="line"></span><br><span class="line">[123, 1, 45, -9]</span><br><span class="line">**********</span><br><span class="line"></span><br><span class="line">[123, 1, 45, -9, 123, 123, 123]</span><br><span class="line">4</span><br><span class="line">**********</span><br><span class="line"></span><br><span class="line">[123, 1, 45, -9, 123, 123, 123]</span><br><span class="line">[123, 1, 45, -9, 123, 123, 123]</span><br><span class="line">**********</span><br><span class="line"></span><br><span class="line">[123, 1, 45, -9, 123, 123, 123]</span><br><span class="line">[123, 2, 45, -9, 123, 123, 123]</span><br></pre></td></tr></table></figure>

<p><b>同步控制：synchronizedXxx()</b></p>
<p>可以将指定集合包装成线程安全的集合</p>
<img src='/img/Java高级/29.png'>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CollectionsTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        List list = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        list.add(<span class="number">123</span>);</span><br><span class="line">        list.add(<span class="number">45</span>);</span><br><span class="line">        list.add(<span class="number">1</span>);</span><br><span class="line">        list.add(-<span class="number">9</span>);</span><br><span class="line">        <span class="comment">//新返回的list1是线程安全的</span></span><br><span class="line">        List list1 = Collections.synchronizedList(list);</span><br><span class="line">        System.out.println(list1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[123, 45, 1, -9]</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h1><h2 id="泛型基础"><a href="#泛型基础" class="headerlink" title="泛型基础"></a>泛型基础</h2><img src='/img/Java高级/30.png'>

<p>设置泛型是为了保证数据类型安全：比如设置为 &lt;Integer&gt; ，则无法存入非 Integer 的数据</p>
<p>泛型不能添加基本数据类型</p>
<p>对于 ArrayList：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FXTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ArrayList&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line"></span><br><span class="line">        list.add(<span class="number">123</span>);</span><br><span class="line">        list.add(<span class="number">98</span>);</span><br><span class="line">        list.add(<span class="number">76</span>);</span><br><span class="line">        list.add(<span class="number">130</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(Integer source: list)&#123;</span><br><span class="line">            <span class="keyword">int</span> src = source;</span><br><span class="line">            System.out.println(src);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">123</span><br><span class="line">98</span><br><span class="line">76</span><br><span class="line">130</span><br></pre></td></tr></table></figure>

<p>对于 HashMap：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FXTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Map&lt;String,Integer&gt; map = <span class="keyword">new</span> HashMap&lt;String,Integer&gt;();</span><br><span class="line">        map.put(<span class="string">"Tom"</span>, <span class="number">69</span>);</span><br><span class="line">        map.put(<span class="string">"Jack"</span>, <span class="number">79</span>);</span><br><span class="line">        map.put(<span class="string">"Lucy"</span>, <span class="number">77</span>);</span><br><span class="line">        map.put(<span class="string">"Rose"</span>, <span class="number">98</span>);</span><br><span class="line"></span><br><span class="line">        Set&lt;Map.Entry&lt;String,Integer&gt;&gt; entry = map.entrySet();</span><br><span class="line">        Iterator&lt;Map.Entry&lt;String,Integer&gt;&gt; itr = entry.iterator();</span><br><span class="line">        <span class="keyword">while</span>(itr.hasNext())&#123;</span><br><span class="line">            Map.Entry&lt;String,Integer&gt; e = itr.next();</span><br><span class="line">            String k = e.getKey();</span><br><span class="line">            Integer v = e.getValue();</span><br><span class="line">            System.out.println(<span class="string">"key: "</span> + k + <span class="string">"--------&gt;"</span> + <span class="string">"value: "</span> + v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">key: Tom--------&gt;value: 69</span><br><span class="line">key: Rose--------&gt;value: 98</span><br><span class="line">key: Lucy--------&gt;value: 77</span><br><span class="line">key: Jack--------&gt;value: 79</span><br></pre></td></tr></table></figure>

<p><b>自定义泛型类</b></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FXTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//将&lt;T&gt;具体为String类型，其中所有T都将被视为String</span></span><br><span class="line">        User&lt;String&gt; user = <span class="keyword">new</span> User&lt;String&gt;(<span class="string">"Tom"</span>,<span class="number">19</span>,<span class="string">"VIP"</span>);</span><br><span class="line">        System.out.println(user.getLevel().getClass());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//&lt;T&gt;表示任意类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> &lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> T level;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String name,<span class="keyword">int</span> age,T level)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.level = level;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getLevel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> level;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLevel</span><span class="params">(T level)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.level = level;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">class java.lang.String</span><br></pre></td></tr></table></figure>

<p>而继承自定义泛型类的子类若在继承时不写明具体泛型，则默认为 Object</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BigUser</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">User</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">BigUser bu = <span class="keyword">new</span> BigUser();</span><br><span class="line">bu.setLevel(<span class="number">123</span>);</span><br><span class="line">System.out.println(bu.getLevel().getClass());</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">class java.lang.Integer</span><br></pre></td></tr></table></figure>

<p>如果写明泛型类型，则后续创建对象不写泛型也会识别</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BigUser</span> <span class="keyword">extends</span> <span class="title">User</span>&lt;<span class="title">String</span>&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">BigUser bu = <span class="keyword">new</span> BigUser();</span><br><span class="line">bu.setLevel(<span class="number">123</span>);</span><br><span class="line">System.out.println(bu.getLevel().getClass());</span><br></pre></td></tr></table></figure>

<p>报错，类型不匹配</p>
<p><b>注意点：</b></p>
<img src='/img/Java高级/31.png'>

<img src='/img/Java高级/32.png'>

<img src='/img/Java高级/33.png'>

<img src='/img/Java高级/34.png'>

<p>泛型接口与泛型类近似</p>
<p><b>泛型方法</b></p>
<p>在上面涉及的 User 类中加入泛型方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span>  &lt;E&gt; <span class="function">List&lt;E&gt; <span class="title">copyFromList</span><span class="params">(E[] arr)</span></span>&#123;</span><br><span class="line">    ArrayList&lt;E&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(E e : arr)&#123;</span><br><span class="line">        list.add(e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FXTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//将&lt;T&gt;具体为String类型，其中所有T都将被视为String</span></span><br><span class="line">        User&lt;String&gt; user = <span class="keyword">new</span> User&lt;String&gt;(<span class="string">"Tom"</span>,<span class="number">19</span>,<span class="string">"VIP"</span>);</span><br><span class="line">        Integer[] arr = <span class="keyword">new</span> Integer[]&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>&#125;;</span><br><span class="line">        List&lt;Integer&gt; list= user.copyFromList(arr);</span><br><span class="line">        System.out.println(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1, 2, 3, 4, 5, 6]</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a>通配符</h2><p>通配符：?</p>
<p>比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Sting&gt; list1 = <span class="keyword">null</span>;</span><br><span class="line">List&lt;Object&gt; list2 = <span class="keyword">null</span>;</span><br><span class="line"><span class="comment">//两者是并列关系，无法直接相互赋值</span></span><br><span class="line"></span><br><span class="line">List&lt;?&gt; list = list1;</span><br><span class="line">list = list2;</span><br><span class="line"><span class="comment">//添加通配符 ? 的List可视作相当于上面两个List的父类，能够获取两个List的值</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在此处show1()无法传入List&lt;Object&gt;，show2()相对的也是这个情况</span></span><br><span class="line"><span class="comment">//而show3()传入的带通配符的List&lt;?&gt;，使用于List&lt;Object&gt;和List&lt;String&gt;，不需要定义同作用的多个方法</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show1</span><span class="params">(List&lt;String&gt; list)</span></span>&#123;</span><br><span class="line">    System.out.println(list);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show2</span><span class="params">(List&lt;Object&gt; list)</span></span>&#123;</span><br><span class="line">    System.out.println(list);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show3</span><span class="params">(List&lt;?&gt; list)</span></span>&#123;</span><br><span class="line">    Iterator&lt;?&gt; itr = list.iterator();</span><br><span class="line">    <span class="keyword">while</span>(iterator.hasNext())&#123;</span><br><span class="line">        <span class="comment">//因为是使用的通配符，因此只有Object可以承载多种数据接收</span></span><br><span class="line">        Object obj = iterator.next();</span><br><span class="line">        System.out.println(obj);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">List&lt;?&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">List&lt;String&gt; list1 = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">list1.add(<span class="string">"AA"</span>);</span><br><span class="line">list1.add(<span class="string">"BB"</span>);</span><br><span class="line">list1.add(<span class="string">"CC"</span>);</span><br><span class="line"></span><br><span class="line">list = list1;</span><br><span class="line"><span class="comment">//List&lt;?&gt;只能添加null，不能直接添加其他类型数据</span></span><br><span class="line">list.add(<span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//允许读取数据，用Object来接收</span></span><br><span class="line">Object o = list.get(<span class="number">0</span>);</span><br><span class="line">System.out.println(o);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AA</span><br></pre></td></tr></table></figure>

<p><b>有限制条件的通配符</b></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">List &lt;? extends User&gt; list1 = <span class="keyword">null</span>;    <span class="comment">//只能存入User的子类级别或User</span></span><br><span class="line">List &lt;? <span class="keyword">super</span> User&gt; list2 = <span class="keyword">null</span>;      <span class="comment">//只能存入User的父类级别或User</span></span><br><span class="line"></span><br><span class="line">List &lt;Integer&gt; list3 = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">List &lt;Object&gt; list4 = <span class="keyword">new</span> ArrayList&lt;Object&gt;();</span><br><span class="line">List &lt;User&gt; list5 = <span class="keyword">new</span> ArrayList&lt;User&gt;();</span><br><span class="line"></span><br><span class="line">list1 = list3;  <span class="comment">//可以</span></span><br><span class="line">list1 = list4;  <span class="comment">//报错</span></span><br><span class="line">list2 = list3;  <span class="comment">//报错</span></span><br><span class="line">list2 = list4;  <span class="comment">//可以</span></span><br></pre></td></tr></table></figure>

<hr>
<h1 id="IO-流"><a href="#IO-流" class="headerlink" title="IO 流"></a>IO 流</h1><h2 id="File-类的使用"><a href="#File-类的使用" class="headerlink" title="File 类的使用"></a>File 类的使用</h2><p>File 类的一个对象代表一个文件或文件目录。</p>
<p>常用构造器：</p>
<img src='/img/Java高级/35.png'>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        File file1 = <span class="keyword">new</span> File(<span class="string">"D:\\CODELIB\\Jstudy\\hello.text"</span>);   <span class="comment">//绝对路径</span></span><br><span class="line">        File file2 = <span class="keyword">new</span> File(<span class="string">"hey.text"</span>);  <span class="comment">//idea 中当前 moudle 下的相对路径</span></span><br><span class="line">        File file3 = <span class="keyword">new</span> File(<span class="string">"D:\\CODELIB"</span>,<span class="string">"Jstudy"</span>);  <span class="comment">//获取一个文件目录下的子文件目录或子文件</span></span><br><span class="line">        File file4 = <span class="keyword">new</span> File(file3,<span class="string">"hello.text"</span>);  <span class="comment">//获取某个File对象所指路径下的子文件目录或子文件</span></span><br><span class="line"></span><br><span class="line">        System.out.println(file1);</span><br><span class="line">        System.out.println(file2);</span><br><span class="line">        System.out.println(file3);</span><br><span class="line">        System.out.println(file4);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">D:\CODELIB\Jstudy\hello.text</span><br><span class="line">hey.text</span><br><span class="line">D:\CODELIB\Jstudy</span><br><span class="line">D:\CODELIB\Jstudy\hello.text</span><br></pre></td></tr></table></figure>

<hr>
<p>File 常用方法</p>
<img src='/img/Java高级/36.png'>

<img src='/img/Java高级/37.png'>

<img src='/img/Java高级/38.png'>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        File file1 = <span class="keyword">new</span> File(<span class="string">"D:\\CODELIB\\Jstudy\\hello.txt"</span>);   <span class="comment">//绝对路径</span></span><br><span class="line">        File file2 = <span class="keyword">new</span> File(<span class="string">"hey.txt"</span>);  <span class="comment">//idea 中当前工程下的相对路径，在@Test下是当前Moudle</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//getAbsolutePath()：获取绝对路径</span></span><br><span class="line">        System.out.println(file1.getAbsolutePath());</span><br><span class="line">        <span class="comment">//getPath()：获取路径</span></span><br><span class="line">        System.out.println(file1.getPath());</span><br><span class="line">        <span class="comment">//getName()：获取名称</span></span><br><span class="line">        System.out.println(file1.getName());</span><br><span class="line">        <span class="comment">//getParent()：获取上层目录</span></span><br><span class="line">        System.out.println(file1.getParent());</span><br><span class="line">        <span class="comment">//length()：获取文件长度</span></span><br><span class="line">        System.out.println(file1.length());</span><br><span class="line">        <span class="comment">//lastModified()：获取最后一次修改时间</span></span><br><span class="line">        System.out.println(<span class="keyword">new</span> Date(file1.lastModified()));</span><br><span class="line"></span><br><span class="line">        System.out.println();</span><br><span class="line">        System.out.println(<span class="string">"***********"</span>);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        System.out.println(file2.getAbsolutePath());</span><br><span class="line">        System.out.println(file2.getPath());</span><br><span class="line">        System.out.println(file2.getName());</span><br><span class="line">        System.out.println(file2.getParent());</span><br><span class="line">        System.out.println(file2.length());</span><br><span class="line">        System.out.println(<span class="keyword">new</span> Date(file2.lastModified()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">D:\CODELIB\Jstudy\hello.txt</span><br><span class="line">D:\CODELIB\Jstudy\hello.txt</span><br><span class="line">hello.txt</span><br><span class="line">D:\CODELIB\Jstudy</span><br><span class="line">0</span><br><span class="line">Wed Mar 09 13:59:18 CST 2021</span><br><span class="line"></span><br><span class="line">***********</span><br><span class="line"></span><br><span class="line">D:\CODELIB\Jstudy\hey.txt</span><br><span class="line">hey.txt</span><br><span class="line">hey.txt</span><br><span class="line">null</span><br><span class="line">0</span><br><span class="line">Wed Mar 09 13:59:39 CST 2021</span><br></pre></td></tr></table></figure>

<p>当对 hello.txt 中添加数据 abcdefg 输出变成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">D:\CODELIB\Jstudy\hello.txt</span><br><span class="line">D:\CODELIB\Jstudy\hello.txt</span><br><span class="line">hello.txt</span><br><span class="line">D:\CODELIB\Jstudy</span><br><span class="line">7</span><br><span class="line">Wed Mar 09 14:05:18 CST 2021</span><br></pre></td></tr></table></figure>

<p>对于文件目录操作：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//String[] list()：获取指定文件目录下的文件和文件目录</span></span><br><span class="line">File file3 = <span class="keyword">new</span> File(<span class="string">"D:\\CODELIB\\Jstudy"</span>);</span><br><span class="line">String[] list = file3.list();</span><br><span class="line"><span class="keyword">for</span>(String s : list)&#123;</span><br><span class="line">    System.out.println(s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.idea</span><br><span class="line">hello.txt</span><br><span class="line">hey.txt</span><br><span class="line">JA.properties</span><br><span class="line">Jstudy.iml</span><br><span class="line">out</span><br><span class="line">src</span><br></pre></td></tr></table></figure>

<p>实际上：</p>
<img src='/img/Java高级/39.png'>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//File[] listFiles()：获取指定文件目录下的文件和文件目录，以File形式存储</span></span><br><span class="line">File[] files = file3.listFiles();</span><br><span class="line"><span class="keyword">for</span>(File f : files)&#123;</span><br><span class="line">    System.out.println(f);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">D:\CODELIB\Jstudy\.idea</span><br><span class="line">D:\CODELIB\Jstudy\hello.txt</span><br><span class="line">D:\CODELIB\Jstudy\hey.txt</span><br><span class="line">D:\CODELIB\Jstudy\JA.properties</span><br><span class="line">D:\CODELIB\Jstudy\Jstudy.iml</span><br><span class="line">D:\CODELIB\Jstudy\out</span><br><span class="line">D:\CODELIB\Jstudy\src</span><br></pre></td></tr></table></figure>

<p>文件更名：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// public boolean renameTo(File file)：将指定文件更名为file，需要保证目录中不存在file</span></span><br><span class="line"><span class="comment">// 而file可以存在于任意有权限目录</span></span><br><span class="line">File file4 = <span class="keyword">new</span> File(<span class="string">"D:\\CODELIB\\Jstudy\\test.txt"</span>);</span><br><span class="line"><span class="keyword">boolean</span> isR = file1.renameTo(file4);</span><br><span class="line">System.out.println(isR);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">true</span><br></pre></td></tr></table></figure>

<img src='/img/Java高级/40.png'>

<p>可以看到原本文件目录内的 hello.txt 不见了，而出现了 test.txt，且其中内容与原本的文件内容相同。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//boolean isDirectory()：判断是否为文件目录</span></span><br><span class="line">System.out.println(file1.isDirectory());</span><br><span class="line"><span class="comment">//boolean isFile()：判断是否为文件</span></span><br><span class="line">System.out.println(file1.isFile());</span><br><span class="line"><span class="comment">//boolean exists()：判断是否存在于硬盘内</span></span><br><span class="line">System.out.println(file1.exists());</span><br><span class="line"><span class="comment">//boolean canRead()：判断该文件是否可读</span></span><br><span class="line">System.out.println(file1.canRead());</span><br><span class="line"><span class="comment">//boolean canWrite()：判断该文件是否可写</span></span><br><span class="line">System.out.println(file1.canWrite());</span><br><span class="line"><span class="comment">//boolean isHidden()：判断改文件是否隐藏</span></span><br><span class="line">System.out.println(file1.isHidden());</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">false</span><br><span class="line">true</span><br><span class="line">true</span><br><span class="line">true</span><br><span class="line">true</span><br><span class="line">false</span><br></pre></td></tr></table></figure>

<p>删除、创建文件：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileCDTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        File file = <span class="keyword">new</span> File(<span class="string">"hello.txt"</span>);</span><br><span class="line">        <span class="keyword">if</span>(!file.exists())&#123;</span><br><span class="line">            <span class="comment">//boolean createNewFile()：若文件不存在，则创建文件，返回true</span></span><br><span class="line">            file.createNewFile();</span><br><span class="line">            System.out.println(<span class="string">"创建成功"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//boolean delete()：删除文件或文件夹</span></span><br><span class="line">            file.delete();</span><br><span class="line">            System.out.println(<span class="string">"删除成功"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">创建成功</span><br></pre></td></tr></table></figure>

<img src='/img/Java高级/41.png'>

<p>再次运行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">删除成功</span><br></pre></td></tr></table></figure>

<p>文件目录下不再存在 hello.txt</p>
<p>创建文件目录：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">File file1 = <span class="keyword">new</span> File(<span class="string">"D:\\CODELIB\\Jstudy\\Ftest\\FFtest"</span>);</span><br><span class="line"><span class="keyword">if</span>(!file1.exists())&#123;</span><br><span class="line">    <span class="comment">//mkdir()：如果要创建文件目录不存在，则创建成功，若其上层目录也不存在，则无法创建</span></span><br><span class="line">    System.out.println(file1.mkdir());</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    file1.delete();</span><br><span class="line">    System.out.println(<span class="string">"删除成功"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">false</span><br></pre></td></tr></table></figure>

<p>因为 FFtest 的上层目录 Ftest 不存在，所以创建失败</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">File file1 = <span class="keyword">new</span> File(<span class="string">"D:\\CODELIB\\Jstudy\\Ftest\\FFtest"</span>);</span><br><span class="line"><span class="keyword">if</span>(!file1.exists())&#123;</span><br><span class="line">    <span class="comment">//mkdirs()：如果要创建文件目录不存在，则创建成功，若其上层目录也不存在，则连带上层目录一起创建</span></span><br><span class="line">    System.out.println(file1.mkdirs());</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    file1.delete();</span><br><span class="line">    System.out.println(<span class="string">"删除成功"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">true</span><br></pre></td></tr></table></figure>

<img src='/img/Java高级/42.png'>

<hr>
<h2 id="流"><a href="#流" class="headerlink" title="流"></a>流</h2><img src='/img/Java高级/43.png'>

<img src='/img/Java高级/44.png'>

<p>流体系：</p>
<img src='/img/Java高级/45.png'>

<hr>
<h2 id="读入数据基本操作"><a href="#读入数据基本操作" class="headerlink" title="读入数据基本操作"></a>读入数据基本操作</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileReaderTest</span> </span>&#123;</span><br><span class="line">        <span class="meta">@Test</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            FileReader fr = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//1.实例化 File 对象</span></span><br><span class="line">                File file = <span class="keyword">new</span> File(<span class="string">"D:\\CODELIB\\Jstudy\\test.txt"</span>);</span><br><span class="line">                <span class="comment">//2. 提供流</span></span><br><span class="line">                fr = <span class="keyword">new</span> FileReader(file);</span><br><span class="line">                <span class="comment">//3.数据读入：read()返回读入的一个字符（以int形式存储），如果达到文件末尾，返回-1</span></span><br><span class="line">                <span class="keyword">int</span> data = fr.read();</span><br><span class="line">                <span class="keyword">while</span> (data != -<span class="number">1</span>)&#123;</span><br><span class="line">                    System.out.print((<span class="keyword">char</span>) data);</span><br><span class="line">                    data = fr.read();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">//4. 关闭流</span></span><br><span class="line">                    fr.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abcdefg</span><br></pre></td></tr></table></figure>

<img src='/img/Java高级/46.png'>

<p>优化读入：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">                FileReader fr = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//1. 提供File对象</span></span><br><span class="line">                File file = <span class="keyword">new</span> File(<span class="string">"D:\\CODELIB\\Jstudy\\test.txt"</span>);</span><br><span class="line">                <span class="comment">//2. 提供流</span></span><br><span class="line">                fr = <span class="keyword">new</span> FileReader(file);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">char</span>[] cbuf = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">5</span>];</span><br><span class="line">                <span class="keyword">int</span> len;</span><br><span class="line">                <span class="comment">//3.读入数据，将cbuf数组传入read，cbuf数组有多长，每次read就读入多少个数据</span></span><br><span class="line">                <span class="keyword">while</span>((len = fr.read(cbuf)) != -<span class="number">1</span>)&#123;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">                        System.out.print(cbuf[i]);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">//4. 关闭流</span></span><br><span class="line">                    fr.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abcdefg</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="文件写入"><a href="#文件写入" class="headerlink" title="文件写入"></a>文件写入</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test3</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//1. 提供File类对象，指明文件</span></span><br><span class="line">        File file = <span class="keyword">new</span> File(<span class="string">"D:\\CODELIB\\Jstudy\\test2.txt"</span>);</span><br><span class="line">        <span class="comment">//2. 提供FileWriter对象，用于数据写入</span></span><br><span class="line">        FileWriter fw = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fw = <span class="keyword">new</span> FileWriter(file);</span><br><span class="line">            <span class="comment">//3. 通过write()写入数据</span></span><br><span class="line">            fw.write(<span class="string">"Hello, "</span>);</span><br><span class="line">            fw.write(<span class="string">"I'm Jack!"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//4. 关闭流</span></span><br><span class="line">                fw.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src='/img/Java高级/47.png'>

<p>由此知道，若操作的文件不存在，则在写入的时候会自动创建该文件。</p>
<p>修改写入数据：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fw.write(<span class="string">"Hello\n"</span>);</span><br><span class="line">fw.write(<span class="string">"I'm Jack!"</span>);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src='/img/Java高级/48.png'>

<p>由此知道，默认操作情况下对已存在文件重新进行写入操作会对原有数据进行覆盖。</p>
<p>如果修改 FileWriter 构造器传入的参数：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fw = <span class="keyword">new</span> FileWriter(file,<span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>

<p>再次运行后：</p>
<img src='/img/Java高级/49.png'>

<p>即在原有数据上继续添加数据。</p>
<p><b>拓展：通过读入写入实现文件复制</b></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test4</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//被复制的文件</span></span><br><span class="line">    File file = <span class="keyword">new</span> File(<span class="string">"D:\\CODELIB\\Jstudy\\test.txt"</span>);</span><br><span class="line">    <span class="comment">//开启读入、写入流</span></span><br><span class="line">    FileReader fr = <span class="keyword">null</span>;</span><br><span class="line">    FileWriter fw = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        fr = <span class="keyword">new</span> FileReader(file);</span><br><span class="line">        fw = <span class="keyword">new</span> FileWriter(<span class="string">"D:\\CODELIB\\Jstudy\\test3.txt"</span>);</span><br><span class="line">        <span class="comment">//读入操作</span></span><br><span class="line">        <span class="keyword">char</span>[] cbuf = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">5</span>];</span><br><span class="line">        <span class="keyword">int</span> len;</span><br><span class="line">        <span class="keyword">while</span> ((len = fr.read(cbuf)) != -<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="comment">//写入操作，每次写入从0开始，len个字符</span></span><br><span class="line">            fw.write(cbuf,<span class="number">0</span>,len);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">//关闭流</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fr.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fw.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src='/img/Java高级/50.png'>

<p>成功生成 test3.txt，并将 test.txt 的数据写入，完成复制操作。</p>
<p><font color="red"><b>注意：以上都是字符流操作，支持于文字文件，对于图片、视频等无法操作，需要用字节流，若用字节流读取文字文件，则有可能出现乱码，因此也不用字节流读文字文件</b></font></p>
<hr>
<h2 id="字节流操作"><a href="#字节流操作" class="headerlink" title="字节流操作"></a>字节流操作</h2><p>完成字节流读写操作复制一个图片：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test5</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//创建img对象</span></span><br><span class="line">    File img = <span class="keyword">new</span> File(<span class="string">"D:\\CODELIB\\Jstudy\\YMDX.jpg"</span>);</span><br><span class="line">    FileInputStream fis = <span class="keyword">null</span>;</span><br><span class="line">    FileOutputStream fos = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//创建字节输入输出流</span></span><br><span class="line">        fis = <span class="keyword">new</span> FileInputStream(img);</span><br><span class="line">        fos = <span class="keyword">new</span> FileOutputStream(<span class="string">"D:\\CODELIB\\Jstudy\\YMDX2.jpg"</span>);</span><br><span class="line">        <span class="comment">//进行数据读写操作</span></span><br><span class="line">        <span class="keyword">byte</span>[] bbur = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">int</span> len;</span><br><span class="line">        <span class="keyword">while</span> ((len = fis.read(bbur)) != -<span class="number">1</span>)&#123;</span><br><span class="line">            fos.write(bbur,<span class="number">0</span>,len);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">//关闭流</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fis.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            fos.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src='/img/Java高级/51.png'>

<p>图片成功复制</p>
<hr>
<h2 id="缓冲流的使用"><a href="#缓冲流的使用" class="headerlink" title="缓冲流的使用"></a>缓冲流的使用</h2><p>缓冲流可以提高流的读写速度</p>
<p>首先测试上一节图片复制的花费时间得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">花费时间：2520ms</span><br></pre></td></tr></table></figure>

<p>接下来使用缓冲流进行复制</p>
<p>定义一个复制操作方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">copyFile</span><span class="params">(String srcPath, String destPath)</span></span>&#123;</span><br><span class="line">    <span class="comment">//造文件</span></span><br><span class="line">    File src = <span class="keyword">new</span> File(srcPath);</span><br><span class="line">    File dest = <span class="keyword">new</span> File(destPath);</span><br><span class="line">    <span class="comment">//造流</span></span><br><span class="line">    FileInputStream fis = <span class="keyword">null</span>;</span><br><span class="line">    FileOutputStream fos = <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">//造缓冲流</span></span><br><span class="line">    BufferedInputStream bis = <span class="keyword">null</span>;</span><br><span class="line">    BufferedOutputStream bos = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//创建字节输入输出流</span></span><br><span class="line">        fis = <span class="keyword">new</span> FileInputStream(src);</span><br><span class="line">        fos = <span class="keyword">new</span> FileOutputStream(dest);</span><br><span class="line"></span><br><span class="line">        bis = <span class="keyword">new</span> BufferedInputStream(fis);</span><br><span class="line">        bos = <span class="keyword">new</span> BufferedOutputStream(fos);</span><br><span class="line">        <span class="comment">//进行数据读写操作</span></span><br><span class="line">        <span class="keyword">byte</span>[] bbur = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">int</span> len;</span><br><span class="line">        <span class="keyword">while</span> ((len = bis.read(bbur)) != -<span class="number">1</span>)&#123;</span><br><span class="line">            bos.write(bbur,<span class="number">0</span>,len);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">//关闭流，只需要关闭外层流即可</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            bis.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            bos.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>进行复制：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test6</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">    String srcPath = <span class="keyword">new</span> String(<span class="string">"D:\\CODELIB\\Jstudy\\YMDX.jpg"</span>);</span><br><span class="line">    String destPath = <span class="keyword">new</span> String(<span class="string">"D:\\CODELIB\\Jstudy\\YMDX2.jpg"</span>);</span><br><span class="line"></span><br><span class="line">    copyFile(srcPath, destPath);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"花费时间："</span> + (end - start) + <span class="string">"ms"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>复制成功，结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">花费时间：41ms</span><br></pre></td></tr></table></figure>

<p>可以看到与原本复制花费时间有明显提升。</p>
<p>速度快的原因：BufferedInputStream 内部提供了一个缓冲区，能够一次性存储一定量的字节（默认 8192），然后 BufferedOutputStream 内部定义了一个 flush() 方法，当缓冲区存满后，取出缓冲区数据并清空缓冲区。</p>
<hr>
<h2 id="转换流"><a href="#转换流" class="headerlink" title="转换流"></a>转换流</h2><p>进行字符流和字节流之间的转换</p>
<img src='/img/Java高级/52.png'>

<p>转换流是处理流、属于字符流</p>
<p>InputStreamReader：字节输入流 —&gt; 字符输入流<br>OutputStreamWriter：字符输出流 –&gt; 字节输出流</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    InputStreamReader isr = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//造字节输入流</span></span><br><span class="line">        FileInputStream fis = <span class="keyword">new</span> FileInputStream(<span class="string">"D:\\CODELIB\\Jstudy\\test2.txt"</span>);</span><br><span class="line">        <span class="comment">//转换字符输入流，参数二是读入格式，根据文件存储时的格式来填</span></span><br><span class="line">        isr = <span class="keyword">new</span> InputStreamReader(fis,<span class="string">"UTF-8"</span>);</span><br><span class="line">        <span class="comment">//读取</span></span><br><span class="line">        <span class="keyword">char</span>[] cbuf = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">20</span>];</span><br><span class="line">        <span class="keyword">int</span> len;</span><br><span class="line">        <span class="keyword">while</span> ((len = isr.read(cbuf)) != -<span class="number">1</span>)&#123;</span><br><span class="line">            String str = <span class="keyword">new</span> String(cbuf,<span class="number">0</span>,len);</span><br><span class="line">            System.out.print(str);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">//关闭流</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            isr.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Hello</span><br><span class="line">I&#39;m Jack!Hello</span><br><span class="line">I&#39;m Jack!</span><br></pre></td></tr></table></figure>

<p>读写转换一起用：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    InputStreamReader isr = <span class="keyword">null</span>;</span><br><span class="line">    OutputStreamWriter osw = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//造输入输出流</span></span><br><span class="line">        FileInputStream fis = <span class="keyword">new</span> FileInputStream(<span class="string">"D:\\CODELIB\\Jstudy\\testCN.txt"</span>);</span><br><span class="line">        FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(<span class="string">"D:\\CODELIB\\Jstudy\\testGBK.txt"</span>);</span><br><span class="line">        <span class="comment">//造转换流</span></span><br><span class="line">        isr = <span class="keyword">new</span> InputStreamReader(fis,<span class="string">"utf-8"</span>);</span><br><span class="line">        osw = <span class="keyword">new</span> OutputStreamWriter(fos,<span class="string">"gbk"</span>);</span><br><span class="line">        <span class="comment">//读写</span></span><br><span class="line">        <span class="keyword">char</span>[] cbuf = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">20</span>];</span><br><span class="line">        <span class="keyword">int</span> len;</span><br><span class="line">        <span class="keyword">while</span> ((len = isr.read(cbuf)) != -<span class="number">1</span>)&#123;</span><br><span class="line">            osw.write(cbuf,<span class="number">0</span>,len);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">//关闭流</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            isr.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            osw.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="其他流"><a href="#其他流" class="headerlink" title="其他流"></a>其他流</h2><p><b>标准输入、输出流</b></p>
<p>标准输入流：System.in</p>
<p>标准输出流：System.out</p>
<p>情景：从键盘输入字符串，要求将读取到的整行字符串转换为大写输出，然后进行输入操作。直到输入“e”或“exit”，程序结束：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">inTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        InputStreamReader isr = <span class="keyword">null</span>;</span><br><span class="line">        BufferedReader br = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//造流</span></span><br><span class="line">            isr = <span class="keyword">new</span> InputStreamReader(System.in);</span><br><span class="line">            br = <span class="keyword">new</span> BufferedReader(isr);</span><br><span class="line">            <span class="comment">//输入信息并输出</span></span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</span><br><span class="line">                System.out.print(<span class="string">"请输入字符串："</span>);</span><br><span class="line">                String data = br.readLine();</span><br><span class="line">                <span class="keyword">if</span>(<span class="string">"e"</span>.equalsIgnoreCase(data)||<span class="string">"exit"</span>.equalsIgnoreCase(data))&#123;</span><br><span class="line">                    System.out.println(<span class="string">"输入结束"</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                String uppercase = data.toUpperCase();</span><br><span class="line">                System.out.println(uppercase);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">//关闭流</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                br.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">请输入字符串：asdasd541as56d1as</span><br><span class="line">ASDASD541AS56D1AS</span><br><span class="line">请输入字符串：dfdfvdfgdr15</span><br><span class="line">DFDFVDFGDR15</span><br><span class="line">请输入字符串：e</span><br><span class="line">输入结束</span><br></pre></td></tr></table></figure>

<p><b>打印流</b></p>
<p>PrintStream 和 PrintWriter 提供了一系列 println() 和 print() 重载方法</p>
<p>情景：将 ASCII 输出到指定文件内，每 50 个换一行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">outTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//造流</span></span><br><span class="line">        PrintStream ps = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(<span class="string">"D:\\CODELIB\\Jstudy\\ostest.txt"</span>);</span><br><span class="line">            ps = <span class="keyword">new</span> PrintStream(fos,<span class="keyword">true</span>);</span><br><span class="line">            <span class="keyword">if</span>(ps != <span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="comment">//这条语句使System的输出默认输出到ps所指位置</span></span><br><span class="line">                System.setOut(ps);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//输出</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;<span class="number">255</span>;i++)&#123;</span><br><span class="line">                System.out.print((<span class="keyword">char</span>)i);</span><br><span class="line">                <span class="keyword">if</span>(i % <span class="number">50</span> == <span class="number">0</span>)&#123;</span><br><span class="line">                    System.out.println();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">//关闭流</span></span><br><span class="line">            ps.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src='/img/Java高级/53.png'>

<hr>
<p><b>数据流</b></p>
<p>DataInputStream 和 DataOutputStream：用于读取或写出基本数据类型和字符串类型数据。</p>
<p>情景：将一个人的三种不同类型的信息存入并能取出到控制台</p>
<p>存入：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dataOutput</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//造流</span></span><br><span class="line">    DataOutputStream dos = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        dos = <span class="keyword">new</span> DataOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">"D:\\CODELIB\\Jstudy\\Person.txt"</span>));</span><br><span class="line">        <span class="comment">//写出字符串</span></span><br><span class="line">        dos.writeUTF(<span class="string">"诗文"</span>);</span><br><span class="line">        dos.flush();<span class="comment">//存入数据后刷新</span></span><br><span class="line">        <span class="comment">//写出整数</span></span><br><span class="line">        dos.writeInt(<span class="number">21</span>);</span><br><span class="line">        dos.flush();</span><br><span class="line">        <span class="comment">//写出布尔</span></span><br><span class="line">        dos.writeBoolean(<span class="keyword">true</span>);</span><br><span class="line">        dos.flush();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">//关闭流</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            dos.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src='/img/Java高级/54.png'>

<p>查看错误：文件编码问题</p>
<p>读取：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dataInput</span><span class="params">()</span></span>&#123;</span><br><span class="line">    DataInputStream dis = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//造流</span></span><br><span class="line">        dis = <span class="keyword">new</span> DataInputStream(<span class="keyword">new</span> FileInputStream(<span class="string">"D:\\CODELIB\\Jstudy\\Person.txt"</span>));</span><br><span class="line">        <span class="comment">//读取</span></span><br><span class="line">        String name = dis.readUTF();</span><br><span class="line">        <span class="keyword">int</span> age = dis.readInt();</span><br><span class="line">        <span class="keyword">boolean</span> isMale = dis.readBoolean();</span><br><span class="line">        <span class="comment">//控制台打印</span></span><br><span class="line">        System.out.println(<span class="string">"name："</span> + name);</span><br><span class="line">        System.out.println(<span class="string">"age："</span> + age);</span><br><span class="line">        System.out.println(<span class="string">"isMale："</span> + isMale);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">//关闭流</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            dis.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">name：诗文</span><br><span class="line">age：21</span><br><span class="line">isMale：true</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="对象流"><a href="#对象流" class="headerlink" title="对象流"></a>对象流</h2><img src='/img/Java高级/55.png'>

<p>对象的序列化：</p>
<img src='/img/Java高级/56.png'>

<p>序列化：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ObjectOutputStream oos = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//造流</span></span><br><span class="line">        oos = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">"D:\\CODELIB\\Jstudy\\obj.dat"</span>));</span><br><span class="line">        <span class="comment">//存数据</span></span><br><span class="line">        oos.writeObject(<span class="keyword">new</span> String(<span class="string">"这是一个序列化的数据"</span>));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(oos != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="comment">//关闭流</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                oos.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>得到 obj.dat 文件，直接打开乱码：</p>
<img src='/img/Java高级/57.png'>

<p>反序列化：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ObjectInputStream ois = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//造流</span></span><br><span class="line">        ois = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(<span class="string">"D:\\CODELIB\\Jstudy\\obj.dat"</span>));</span><br><span class="line">        <span class="comment">//读数据</span></span><br><span class="line">        Object obj = ois.readObject();</span><br><span class="line">        String src = (String) obj;</span><br><span class="line">        System.out.println(src);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(ois != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="comment">//关闭流</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                ois.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这是一个序列化的数据</span><br></pre></td></tr></table></figure>

<p><b>自定义类序列化</b></p>
<p>自定义类序列化要求：</p>
<ol>
<li>自定义类需要实现接口：Serializable 或 Externalizable</li>
<li>需要添加序列版本号： <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = xxxxxxxxxxxxxxxL</span><br></pre></td></tr></table></figure>
 (如果不添加，系统会自动生成，但若对类进行修改，序列号也会修改，则无法读取之前存入的数据，因此要自己定义)</li>
<li>自定义类内部的所有属性也必须是可序列化的</li>
<li>不能序列化 static 和 transient 修饰的成员变量</li>
</ol>
<p>User.class：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">5641526315L</span>;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String name, <span class="keyword">int</span> age)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"User&#123;"</span> +</span><br><span class="line">                <span class="string">"name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", age="</span> + age +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在 test1() 中 //存数据 下添加代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">oos.writeObject(<span class="keyword">new</span> User(<span class="string">"诗文"</span>,<span class="number">21</span>));</span><br><span class="line">oos.flush();</span><br></pre></td></tr></table></figure>

<p>在 test2() 中 //读数据 下添加代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User u = (User) ois.readObject();</span><br><span class="line">System.out.println(u);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">这是一个序列化的数据</span><br><span class="line">User&#123;name&#x3D;&#39;诗文&#39;, age&#x3D;21&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="随机文件存取"><a href="#随机文件存取" class="headerlink" title="随机文件存取"></a>随机文件存取</h2><img src='/img/Java高级/58.png'>

<img src='/img/Java高级/61.png'>

<p>RandomAccessFile 作为输出流时，若原文件存在，则会对文件内数据进行覆盖（默认情况下从头逐个覆盖）</p>
<p>通过 seek() 方法可以指定覆盖的起始位置</p>
<p>源文件 rant.txt</p>
<img src='/img/Java高级/59.png'>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    RandomAccessFile raf = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        raf = <span class="keyword">new</span> RandomAccessFile(<span class="keyword">new</span> File(<span class="string">"D:\\CODELIB\\Jstudy\\rant.txt"</span>),<span class="string">"rw"</span>);</span><br><span class="line">        <span class="comment">//将文件内容指针指向第3个字符处</span></span><br><span class="line">        raf.seek(<span class="number">2</span>);</span><br><span class="line">        raf.write(<span class="string">"9999"</span>.getBytes());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            raf.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<img src='/img/Java高级/60.png'>

<hr>
<h2 id="NIO"><a href="#NIO" class="headerlink" title="NIO"></a>NIO</h2><img src='/img/Java高级/62.png'>

<img src='/img/Java高级/63.png'>

<img src='/img/Java高级/64.png'>

<img src='/img/Java高级/65.png'>

<img src='/img/Java高级/66.png'>

<img src='/img/Java高级/67.png'>

<hr>
<h1 id="网络编程"><a href="#网络编程" class="headerlink" title="网络编程"></a>网络编程</h1><h2 id="网络编程概述"><a href="#网络编程概述" class="headerlink" title="网络编程概述"></a>网络编程概述</h2><img src='/img/Java高级/68.png'>

<img src='/img/Java高级/69.png'>

<img src='/img/Java高级/70.png'>

<p>网络数据传输过程</p>
<img src='/img/Java高级/71.png'>

<hr>
<h2 id="IP-和端口号"><a href="#IP-和端口号" class="headerlink" title="IP 和端口号"></a>IP 和端口号</h2><img src='/img/Java高级/72.png'>

<p><b>IP：</b></p>
<p>InetAddress 类的一个对象代表一个 IP 地址</p>
<p>域名会通过 DNS （域名解析服务器）解析出实际的 IP 地址，通过 IP 地址访问对应的网络服务器</p>
<p>本地回路地址：127.0.0.1 （表示本机，对应 localhost）</p>
<p>InetAddress 对象实例化：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//InetAddress类的构造器是私有的，因此实例化不使用构造器，因此不写 new</span></span><br><span class="line">    InetAddress ia1 = <span class="keyword">null</span>;</span><br><span class="line">    InetAddress ia2 = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//实例化：通过IP地址</span></span><br><span class="line">        ia1 = InetAddress.getByName(<span class="string">"192.168.1.1"</span>);</span><br><span class="line">        System.out.println(ia1);</span><br><span class="line">        <span class="comment">//实例化：通过域名（会自动DNS解析其IP）</span></span><br><span class="line">        ia2 = InetAddress.getByName(<span class="string">"www.baidu.com"</span>);</span><br><span class="line">        System.out.println(ia2);</span><br><span class="line">        <span class="comment">//实例化：获取本机</span></span><br><span class="line">        InetAddress ia3 = InetAddress.getLocalHost();</span><br><span class="line">        System.out.println(ia3);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (UnknownHostException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//获取域名</span></span><br><span class="line">    System.out.println(ia1.getHostName());</span><br><span class="line">    <span class="comment">//获取IP</span></span><br><span class="line">    System.out.println(ia2.getHostAddress());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;192.168.1.1</span><br><span class="line">www.baidu.com&#x2F;14.215.177.39</span><br><span class="line">LAPTOP-VPSJTSEP&#x2F;192.168.1.140</span><br><span class="line">OpenWrt.lan</span><br><span class="line">14.215.177.39</span><br></pre></td></tr></table></figure>

<hr>
<p><b>端口号：</b></p>
<img src='/img/Java高级/73.png'>

<hr>
<h2 id="网络协议"><a href="#网络协议" class="headerlink" title="网络协议"></a>网络协议</h2><img src='/img/Java高级/74.png'>

<img src='/img/Java高级/75.png'>

<img src='/img/Java高级/76.png'>

<p>（建立连接）三次握手：</p>
<img src='/img/Java高级/77.png'>

<p>简单说明：</p>
<ul>
<li>一次握手：客户端询问服务器端是否存在</li>
<li>二次握手：服务器端收到客户端存在的消息</li>
<li>三次握手：客户端发送确认连接信息</li>
</ul>
<ol>
<li>客户端通过向服务器端发送一个 SYN 来创建一个主动打开，作为三路握手的一部分。客户端把这段连接的序号设定位随机数 A。</li>
<li>服务器端应当为一个合法的 SYN 回送一个 SYN/ACK，ACK 的确认码应为 A + 1，SYN/ACK 包本身又有一个随机数 B</li>
<li>客户端接收到 SYN/ACK，向服务器端发送 ACK，确认码为 B + 1，序号设定为随机数 C</li>
</ol>
<p>（释放连接）四次挥手：</p>
<img src='/img/Java高级/78.png'>

<p>简单说明（以客户端主动断开连接情景）：</p>
<ul>
<li>一次挥手：客户端向服务器端发送申请断开链接</li>
<li>二次挥手：服务器端向客户端发送连接断开信息</li>
<li>三次挥手：服务器端断开与客户端连接</li>
<li>四次挥手：客户端发送信息验证是否与服务器已断开连接</li>
</ul>
<img src='/img/Java高级/79.png'>

<hr>
<h2 id="TCP-网络编程"><a href="#TCP-网络编程" class="headerlink" title="TCP 网络编程"></a>TCP 网络编程</h2><p>情景 1：客户端向服务器端发送一条数据，服务器端将数据显示在控制台上：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//客户端</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">client</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Socket socket = <span class="keyword">null</span>;</span><br><span class="line">    OutputStream os = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//指定接收者</span></span><br><span class="line">        InetAddress ia = InetAddress.getByName(<span class="string">"127.0.0.1"</span>);</span><br><span class="line">        <span class="comment">//建立Socket与指定接收者的8999端口的连接</span></span><br><span class="line">        socket = <span class="keyword">new</span> Socket(ia,<span class="number">8999</span>);</span><br><span class="line">        <span class="comment">//建立输出流，socket接收输出流的数据</span></span><br><span class="line">        os = socket.getOutputStream();</span><br><span class="line">        <span class="comment">//输出信息</span></span><br><span class="line">        os.write(<span class="string">"这是向服务器端发送的信息"</span>.getBytes());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">//关闭流、连接</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            os.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            socket.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//服务器端</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">server</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ServerSocket ss = <span class="keyword">null</span>;</span><br><span class="line">    Socket socket = <span class="keyword">null</span>;</span><br><span class="line">    InputStream is = <span class="keyword">null</span>;</span><br><span class="line">    ByteArrayOutputStream baos = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//建立服务器端端口号</span></span><br><span class="line">        ss = <span class="keyword">new</span> ServerSocket(<span class="number">8999</span>);</span><br><span class="line">        <span class="comment">//建立Socket接收数据</span></span><br><span class="line">        socket = ss.accept();</span><br><span class="line">        <span class="comment">//建立输入流，socket接收输入流的数据</span></span><br><span class="line">        is = socket.getInputStream();</span><br><span class="line">        <span class="comment">//能够连续输出字节后统一拼接</span></span><br><span class="line">        baos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">        <span class="comment">//在控制台输出数据</span></span><br><span class="line">        <span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">5</span>];</span><br><span class="line">        <span class="keyword">int</span> len;</span><br><span class="line">        <span class="keyword">while</span> ((len = is.read(buffer)) != -<span class="number">1</span>)&#123;</span><br><span class="line">            baos.write(buffer,<span class="number">0</span>,len);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(baos.toString());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">//关闭流、连接</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            baos.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            is.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            socket.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ss.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>先开启服务器、后开启客户端，结果：</p>
<img src='/img/Java高级/80.png'>

<p>情景 2：客户端发送文件给服务器端，服务器端将文件保存在本地</p>
<p>原文件：</p>
<img src='/img/Java高级/81.png'>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//服务器端</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">server2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ServerSocket server = <span class="keyword">null</span>;</span><br><span class="line">    Socket socket = <span class="keyword">null</span>;</span><br><span class="line">    DataInputStream dis = <span class="keyword">null</span>;</span><br><span class="line">    OutputStream os = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        server = <span class="keyword">new</span> ServerSocket(<span class="number">4700</span>);</span><br><span class="line">        socket = server.accept();</span><br><span class="line">        dis = <span class="keyword">new</span> DataInputStream(socket.getInputStream());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">byte</span>[] buff = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        os = <span class="keyword">new</span> FileOutputStream(<span class="string">"D:\\CODELIB\\Jstudy\\YYYY.jpg"</span>);</span><br><span class="line">        <span class="keyword">int</span> len = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> ((len = dis.read(buff)) != -<span class="number">1</span>) &#123;</span><br><span class="line">            os.write(buff, <span class="number">0</span>, len);</span><br><span class="line">        &#125;</span><br><span class="line">        os.flush();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            os.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            dis.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            socket.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            server.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">client2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Socket socket = <span class="keyword">null</span>;</span><br><span class="line">    DataOutputStream dos = <span class="keyword">null</span>;</span><br><span class="line">    InputStream inputStream = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        socket = <span class="keyword">new</span> Socket(<span class="string">"127.0.0.1"</span>, <span class="number">4700</span>);</span><br><span class="line">        dos = <span class="keyword">new</span> DataOutputStream(socket.getOutputStream());</span><br><span class="line">        File file = <span class="keyword">new</span> File(<span class="string">"C:\\Users\\Poet\\blog\\themes\\diaspora\\source\\img\\YMDX.jpg"</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] buff = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        inputStream = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">        <span class="keyword">int</span> len = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> ((len = inputStream.read(buff)) != -<span class="number">1</span>) &#123;</span><br><span class="line">            dos.write(buff, <span class="number">0</span>, len);</span><br><span class="line">            dos.flush();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            dos.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            inputStream.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            socket.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>传输完成后：</p>
<img src='/img/Java高级/82.png'>

<hr>
<h2 id="UDP-网络编程"><a href="#UDP-网络编程" class="headerlink" title="UDP 网络编程"></a>UDP 网络编程</h2><img src='/img/Java高级/83.png'>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//发送者</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sender</span><span class="params">()</span></span>&#123;</span><br><span class="line">    DatagramSocket socket = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        socket = <span class="keyword">new</span> DatagramSocket();</span><br><span class="line"></span><br><span class="line">        String src = <span class="keyword">new</span> String(<span class="string">"发送的数据"</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] data = src.getBytes();</span><br><span class="line">        InetAddress ia = InetAddress.getLocalHost();</span><br><span class="line">        DatagramPacket dp = <span class="keyword">new</span> DatagramPacket(data,<span class="number">0</span>,data.length,ia,<span class="number">9900</span>);</span><br><span class="line"></span><br><span class="line">        socket.send(dp);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            socket.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//接收者</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiver</span><span class="params">()</span></span>&#123;</span><br><span class="line">    DatagramSocket socket = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        socket = <span class="keyword">new</span> DatagramSocket(<span class="number">9900</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">100</span>];</span><br><span class="line">        DatagramPacket dp = <span class="keyword">new</span> DatagramPacket(buffer, <span class="number">0</span>,buffer.length);</span><br><span class="line">        socket.receive(dp);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="keyword">new</span> String(dp.getData(), <span class="number">0</span>, dp.getLength()));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            socket.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>先开启接收者，然后开启发送者，结果：</p>
<img src='/img/Java高级/84.png'>

<hr>
<h2 id="URL-编程"><a href="#URL-编程" class="headerlink" title="URL 编程"></a>URL 编程</h2><img src='/img/Java高级/85.png'>

<img src='/img/Java高级/86.png'>

<img src='/img/Java高级/87.png'>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">URLTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            URL url = <span class="keyword">new</span> URL(<span class="string">"http://localhost:4000/2021/02/02/Java%E9%AB%98%E7%BA%A7/"</span>);</span><br><span class="line"></span><br><span class="line">            System.out.println(url.getProtocol());  <span class="comment">//获取协议名</span></span><br><span class="line">            System.out.println(url.getHost());  <span class="comment">//获取主机名</span></span><br><span class="line">            System.out.println(url.getPort());  <span class="comment">//获取端口号</span></span><br><span class="line">            System.out.println(url.getPath());  <span class="comment">//获取文件路径</span></span><br><span class="line">            System.out.println(url.getFile());  <span class="comment">//获取文件名</span></span><br><span class="line">            System.out.println(url.getQuery()); <span class="comment">//获取查询名</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (MalformedURLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http</span><br><span class="line">localhost</span><br><span class="line">4000</span><br><span class="line">&#x2F;2021&#x2F;02&#x2F;02&#x2F;Java%E9%AB%98%E7%BA%A7&#x2F;</span><br><span class="line">&#x2F;2021&#x2F;02&#x2F;02&#x2F;Java%E9%AB%98%E7%BA%A7&#x2F;</span><br><span class="line">null</span><br></pre></td></tr></table></figure>
            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="true">
                <source type="audio/mpeg" src="/music/塞壬唱片-MSR - Renegade.mp3">
            </audio>
            
        </div>
        
    <div id='gitalk-container' class="comment link"
		data-enable='true'
        data-ae='false'
        data-ci=''
        data-cs=''
        data-r=''
        data-o=''
        data-a=''
        data-d='false'
    >查看评论</div>


    </div>
    
        <div class='side'>
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#多线程"><span class="toc-number">1.</span> <span class="toc-text">多线程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#多线程基本概念"><span class="toc-number">1.1.</span> <span class="toc-text">多线程基本概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#线程的创建和使用"><span class="toc-number">1.2.</span> <span class="toc-text">线程的创建和使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#线程使用常用方法"><span class="toc-number">1.3.</span> <span class="toc-text">线程使用常用方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#线程的优先级"><span class="toc-number">1.4.</span> <span class="toc-text">线程的优先级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#线程的生命周期"><span class="toc-number">1.5.</span> <span class="toc-text">线程的生命周期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#线程的同步"><span class="toc-number">1.6.</span> <span class="toc-text">线程的同步</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用同步机制改写单例模式"><span class="toc-number">1.7.</span> <span class="toc-text">使用同步机制改写单例模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#线程的死锁"><span class="toc-number">1.8.</span> <span class="toc-text">线程的死锁</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lock（锁）"><span class="toc-number">1.9.</span> <span class="toc-text">Lock（锁）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#实现-Callable-接口"><span class="toc-number">1.10.</span> <span class="toc-text">实现 Callable 接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用线程池"><span class="toc-number">1.11.</span> <span class="toc-text">使用线程池</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-常用类"><span class="toc-number">2.</span> <span class="toc-text">Java 常用类</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#字符串相关类"><span class="toc-number">2.1.</span> <span class="toc-text">字符串相关类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#String-常用方法"><span class="toc-number">2.2.</span> <span class="toc-text">String 常用方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#StringBuffer-与-StringBuilder"><span class="toc-number">2.3.</span> <span class="toc-text">StringBuffer 与 StringBuilder</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#旧的时间-API"><span class="toc-number">2.4.</span> <span class="toc-text">旧的时间 API</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#新的时间-API"><span class="toc-number">2.5.</span> <span class="toc-text">新的时间 API</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Java-比较器"><span class="toc-number">2.6.</span> <span class="toc-text">Java 比较器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#System、Math、BigInteger、BigDecimal"><span class="toc-number">2.7.</span> <span class="toc-text">System、Math、BigInteger、BigDecimal</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#枚举类与注解"><span class="toc-number">3.</span> <span class="toc-text">枚举类与注解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#枚举类的使用"><span class="toc-number">3.1.</span> <span class="toc-text">枚举类的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#注解"><span class="toc-number">3.2.</span> <span class="toc-text">注解</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#集合"><span class="toc-number">4.</span> <span class="toc-text">集合</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#集合简述"><span class="toc-number">4.1.</span> <span class="toc-text">集合简述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Collection"><span class="toc-number">4.2.</span> <span class="toc-text">Collection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Iterator-迭代器接口"><span class="toc-number">4.3.</span> <span class="toc-text">Iterator 迭代器接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Collection-子接口之-List-接口"><span class="toc-number">4.4.</span> <span class="toc-text">Collection 子接口之 List 接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Collection-子接口之-Set-接口"><span class="toc-number">4.5.</span> <span class="toc-text">Collection 子接口之 Set 接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Map-接口"><span class="toc-number">4.6.</span> <span class="toc-text">Map 接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Map-中的常用方法"><span class="toc-number">4.7.</span> <span class="toc-text">Map 中的常用方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TreeHashMap"><span class="toc-number">4.8.</span> <span class="toc-text">TreeHashMap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Properties"><span class="toc-number">4.9.</span> <span class="toc-text">Properties</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Collections-工具类"><span class="toc-number">4.10.</span> <span class="toc-text">Collections 工具类</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#泛型"><span class="toc-number">5.</span> <span class="toc-text">泛型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#泛型基础"><span class="toc-number">5.1.</span> <span class="toc-text">泛型基础</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#通配符"><span class="toc-number">5.2.</span> <span class="toc-text">通配符</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#IO-流"><span class="toc-number">6.</span> <span class="toc-text">IO 流</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#File-类的使用"><span class="toc-number">6.1.</span> <span class="toc-text">File 类的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#流"><span class="toc-number">6.2.</span> <span class="toc-text">流</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#读入数据基本操作"><span class="toc-number">6.3.</span> <span class="toc-text">读入数据基本操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文件写入"><span class="toc-number">6.4.</span> <span class="toc-text">文件写入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#字节流操作"><span class="toc-number">6.5.</span> <span class="toc-text">字节流操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#缓冲流的使用"><span class="toc-number">6.6.</span> <span class="toc-text">缓冲流的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#转换流"><span class="toc-number">6.7.</span> <span class="toc-text">转换流</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#其他流"><span class="toc-number">6.8.</span> <span class="toc-text">其他流</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#对象流"><span class="toc-number">6.9.</span> <span class="toc-text">对象流</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#随机文件存取"><span class="toc-number">6.10.</span> <span class="toc-text">随机文件存取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NIO"><span class="toc-number">6.11.</span> <span class="toc-text">NIO</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#网络编程"><span class="toc-number">7.</span> <span class="toc-text">网络编程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#网络编程概述"><span class="toc-number">7.1.</span> <span class="toc-text">网络编程概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IP-和端口号"><span class="toc-number">7.2.</span> <span class="toc-text">IP 和端口号</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#网络协议"><span class="toc-number">7.3.</span> <span class="toc-text">网络协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP-网络编程"><span class="toc-number">7.4.</span> <span class="toc-text">TCP 网络编程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UDP-网络编程"><span class="toc-number">7.5.</span> <span class="toc-text">UDP 网络编程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#URL-编程"><span class="toc-number">7.6.</span> <span class="toc-text">URL 编程</span></a></li></ol></li></ol>	
        </div>
    
</div>


    </div>
</div>
</body>

<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>


<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/diaspora.js"></script>


<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>






</html>
