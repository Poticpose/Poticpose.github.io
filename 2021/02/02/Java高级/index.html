
<!DOCTYPE html>
<html lang="zh-CN" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Java高级 - 诗文的小书屋</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="blog,"> 
    <meta name="description" content="多线程多线程基本概念优点：

提高应用程序的响应，对图形化界面更有意义，提升用户体验。
提高计算机系统的CPU利用率。
改善程序结构，将复杂的进程分为多个线程，独立运行，利于理解和修改。

何时需要,"> 
    <meta name="author" content="Poet"> 
    <link rel="alternative" href="atom.xml" title="诗文的小书屋" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

    
<link rel="stylesheet" href="/css/diaspora.css">

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({
              google_ad_client: "ca-pub-8691406134231910",
              enable_page_level_ads: true
         });
    </script>
    <script async custom-element="amp-auto-ads"
        src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
<meta name="generator" content="Hexo 4.2.0"></head>

<body class="loading">
    <span id="config-title" style="display:none">诗文的小书屋</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="https://poticpose.github.io"></a>
    <div title="播放/暂停" class="iconfont icon-play"></div>
    <h3 class="subtitle">Java高级</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">Java高级</h1>
        <div class="stuff">
            <span>二月 02, 2021</span>
            
  <ul class="post-tags-list" itemprop="keywords"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/Java/" rel="tag">Java</a></li></ul>


        </div>
        <div class="content markdown">
            <h1 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h1><h2 id="多线程基本概念"><a href="#多线程基本概念" class="headerlink" title="多线程基本概念"></a>多线程基本概念</h2><p>优点：</p>
<ol>
<li>提高应用程序的响应，对图形化界面更有意义，提升用户体验。</li>
<li>提高计算机系统的CPU利用率。</li>
<li>改善程序结构，将复杂的进程分为多个线程，独立运行，利于理解和修改。</li>
</ol>
<p>何时需要多线程：</p>
<ol>
<li>程序需要同时执行两个或两个以上任务。</li>
<li>程序需要实现一些需要等待的任务时，如用户输入、文件读写、网络操作、搜索等。</li>
<li>需要一些后台运行的程序时。</li>
</ol>
<hr>
<h2 id="线程的创建和使用"><a href="#线程的创建和使用" class="headerlink" title="线程的创建和使用"></a>线程的创建和使用</h2><p>创建方式一：继承 Thread 类</p>
<ol>
<li>创建一个继承 Thread 类的子类。</li>
<li>重写 Thread 类的 run()。 –&gt; 将此线程需要进行的操作声明在重写的 run() 中</li>
<li>创建 Thread 类的子类对象。</li>
<li>通过此对象调用 start()。</li>
</ol>
<p>例如需要输出 100 以内的偶数：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyThread t1 = <span class="keyword">new</span> MyThread();</span><br><span class="line">        t1.start();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">100</span>;j++) &#123;</span><br><span class="line">            System.out.println(<span class="string">"***********"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.println(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在主线程加入循环输出“<strong><strong>****</strong></strong>”以此来凸显线程交换</p>
<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">***********</span><br><span class="line">***********</span><br><span class="line">***********</span><br><span class="line">***********</span><br><span class="line">0</span><br><span class="line">2</span><br><span class="line">4</span><br><span class="line">6</span><br><span class="line">8</span><br><span class="line">10</span><br><span class="line">12</span><br><span class="line">***********</span><br><span class="line">***********</span><br><span class="line">***********</span><br><span class="line">***********</span><br><span class="line">***********</span><br><span class="line">14</span><br><span class="line">16</span><br><span class="line">18</span><br><span class="line">20</span><br><span class="line">22</span><br><span class="line">24</span><br><span class="line">26</span><br><span class="line">28</span><br><span class="line">30</span><br><span class="line">32</span><br><span class="line">34</span><br><span class="line">36</span><br><span class="line">38</span><br><span class="line">40</span><br><span class="line">42</span><br><span class="line">&#x2F;&#x2F;........</span><br></pre></td></tr></table></figure>

<p>Thread.currentThread() 可以获取到当前操作的线程。</p>
<p>通过输出 Thread.currentThread().getName 可以更直观感受到</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyThread t1 = <span class="keyword">new</span> MyThread();</span><br><span class="line">        t1.start();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">100</span>;j++) &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+<span class="string">"：***********"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName()+<span class="string">"："</span>+i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">Thread-0：0</span><br><span class="line">Thread-0：2</span><br><span class="line">Thread-0：4</span><br><span class="line">Thread-0：6</span><br><span class="line">Thread-0：8</span><br><span class="line">Thread-0：10</span><br><span class="line">Thread-0：12</span><br><span class="line">Thread-0：14</span><br><span class="line">Thread-0：16</span><br><span class="line">Thread-0：18</span><br><span class="line">Thread-0：20</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">main：***********</span><br><span class="line">Thread-0：22</span><br><span class="line">Thread-0：24</span><br><span class="line">Thread-0：26</span><br><span class="line">Thread-0：28</span><br><span class="line">Thread-0：30</span><br><span class="line">Thread-0：32</span><br><span class="line">Thread-0：34</span><br><span class="line">Thread-0：36</span><br><span class="line">Thread-0：38</span><br><span class="line">Thread-0：40</span><br><span class="line">&#x2F;&#x2F;.......</span><br></pre></td></tr></table></figure>

<hr>
<p>创建方式二：实现 Runnable 接口</p>
<ol>
<li>创建一个实现 Runnable 接口的类。</li>
<li>实现类去实现 Runnable 中的抽象方法 run()。</li>
<li>创建实现类的对象。</li>
<li>将此对象作为参数传递到 Thread 类的构造器中，创建 Thread 类的对象。</li>
<li>通过 Thread 类的对象调用 start()。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadTest2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MThread mth2 = <span class="keyword">new</span> MThread();</span><br><span class="line">        Thread t2 = <span class="keyword">new</span> Thread(mth2);</span><br><span class="line">        t2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.println(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>比较两种创建线程的方式：</p>
<p>开发中：优先选择：实现 Runnable 接口的方式。</p>
<p>原因：</p>
<ol>
<li>实现的方式没有类的单继承性的限制。</li>
<li>实现的方式更适合多个线程共享数据。</li>
</ol>
<p>相同：两种方式都需要重写 run() 方法，将线程的执行逻辑声明在 run() 中。</p>
<hr>
<h2 id="线程使用常用方法"><a href="#线程使用常用方法" class="headerlink" title="线程使用常用方法"></a>线程使用常用方法</h2><ul>
<li>void start()：启动线程，并执行对象的 run() 方法。</li>
<li>run()：线程在被调度时执行的操作。</li>
<li>String getName()：返回线程的名称。</li>
<li>void setName(String name)：设置该线程的名称。</li>
<li>static Thread currentThread()：返回当前线程。在 Thread 子类中就是 this，通常用于主线程和 Runnable 实现类。</li>
<li>static void yield()：线程让步<ul>
<li>暂停当前正在执行的线程，把执行机会让给优先级相同或更高的线程。</li>
<li>若队列中没有同优先级的线程，忽略此方法。</li>
</ul>
</li>
<li>join()：当某个程序执行流中调用其他线程的 join() 方法时，调用线程将被阻塞，直到 join() 方法加入的 join 线程执行完为止。</li>
<li>static void sleep(long millis)：（指定时间：毫秒）<ul>
<li>令当前活动线程在指定时间段内放弃对CPU的控制，使其他线程有机会被执行，时间到后重新排队。</li>
<li>抛出 InterruptedException 异常</li>
</ul>
</li>
<li>stop()：强制线程生命周期结束。</li>
<li>boolean isAlive()：返回 boolean，判断线程是否存活。</li>
</ul>
<p>以下方法只能使用于同步代码块或同步方法中：</p>
<ul>
<li>wait()：一旦执行此方法，当前线程进入堵塞状态，并释放同步监视器。</li>
<li>notify()：一旦执行此方法就会唤醒被 wait 的一个进程，如果有多个，则唤醒优先级最高的一个。</li>
<li>notifyAll()：一旦执行此方法，唤醒所有 wait 进程。</li>
</ul>
<hr>
<h2 id="线程的优先级"><a href="#线程的优先级" class="headerlink" title="线程的优先级"></a>线程的优先级</h2><p>调度策略</p>
<ul>
<li>时间片：依次先进先出。</li>
<li>抢占式：高优先级的线程抢占CPU。</li>
</ul>
<p>线程的优先级等级：</p>
<ul>
<li>MAX_PRIORITY：10</li>
<li>MIN_PRIORITY：1</li>
<li>NORM_PRIORITY：5</li>
</ul>
<p>涉及的方法：</p>
<ul>
<li>getPriority()：返回线程优先值。</li>
<li>setPriority()：改变线程的优先值。</li>
</ul>
<p>P.S.</p>
<ul>
<li>线程创建时，继承父线程的优先级。</li>
<li>低优先级只是获得调度的概率低，并非一定是在高优先级线程之后才被调用。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyThread t1 = <span class="keyword">new</span> MyThread();</span><br><span class="line">        t1.setPriority(Thread.MAX_PRIORITY);</span><br><span class="line">        t1.start();</span><br><span class="line">        Thread.currentThread().setPriority(Thread.MIN_PRIORITY);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">100</span>; j++) &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">" 线程优先级："</span> + Thread.currentThread().getPriority() + <span class="string">"：***********"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">" 线程优先级："</span> + getPriority() + <span class="string">"："</span> + i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">Thread-0 线程优先级：10：0</span><br><span class="line">Thread-0 线程优先级：10：2</span><br><span class="line">Thread-0 线程优先级：10：4</span><br><span class="line">Thread-0 线程优先级：10：6</span><br><span class="line">Thread-0 线程优先级：10：8</span><br><span class="line">Thread-0 线程优先级：10：10</span><br><span class="line">Thread-0 线程优先级：10：12</span><br><span class="line">Thread-0 线程优先级：10：14</span><br><span class="line">Thread-0 线程优先级：10：16</span><br><span class="line">Thread-0 线程优先级：10：18</span><br><span class="line">Thread-0 线程优先级：10：20</span><br><span class="line">Thread-0 线程优先级：10：22</span><br><span class="line">Thread-0 线程优先级：10：24</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">Thread-0 线程优先级：10：26</span><br><span class="line">Thread-0 线程优先级：10：28</span><br><span class="line">Thread-0 线程优先级：10：30</span><br><span class="line">Thread-0 线程优先级：10：32</span><br><span class="line">Thread-0 线程优先级：10：34</span><br><span class="line">Thread-0 线程优先级：10：36</span><br><span class="line">Thread-0 线程优先级：10：38</span><br><span class="line">Thread-0 线程优先级：10：40</span><br><span class="line">Thread-0 线程优先级：10：42</span><br><span class="line">Thread-0 线程优先级：10：44</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">Thread-0 线程优先级：10：46</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">Thread-0 线程优先级：10：48</span><br><span class="line">main 线程优先级：1：***********</span><br><span class="line">Thread-0 线程优先级：10：50</span><br><span class="line">Thread-0 线程优先级：10：52</span><br><span class="line">&#x2F;&#x2F;......</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="线程的生命周期"><a href="#线程的生命周期" class="headerlink" title="线程的生命周期"></a>线程的生命周期</h2><p>JDK 中用 Thread.State 类定义了线程的几种状态。</p>
<ul>
<li>新建：当一个 Thread 类或其子类的对象被声明和创建时，新的线程对象处于新建状态。</li>
<li>就绪：处于新建状态的线程被 start() 后，将进入线程队列等待 CPU 时间片，此时它具备了运行的条件，只是没分配到 CPU 资源。</li>
<li>运行：当就绪的线程被调度并获得 CPU 资源时，便进入运行状态，run() 方法定义了线程的操作和功能。</li>
<li>阻塞：在某种特殊情况下，被人为挂起或执行输入输出操作时，让出 CPU 并临时终止自己的执行，进入阻塞状态。</li>
<li>死亡：线程完成了它的全部工作或线程被提前强制性的中止或出现异常导致结束。</li>
</ul>
<img src='/img/Java高级/1.png'>

<hr>
<h2 id="线程的同步"><a href="#线程的同步" class="headerlink" title="线程的同步"></a>线程的同步</h2><p>示例场景：</p>
<p>创建三个窗口卖票，总票数为 100 张，使用实现 Runnable 接口的方式。</p>
<ol>
<li>问题：卖票过程中，出现了重票、错票 –&gt; 出现了线程的安全问题</li>
<li>问题出现的原因：当某个线程操作车票的过程中，尚未操作完成，其他线程再次参与进来，也操作车票。</li>
<li>解决方式：<br>当一个线程 a 在操作 ticket 的时候，其他线程不能参与进来。直到线程 a 操作完 ticket 时，其余线程才可以操作 ticket。这种情况即使线程 a 处于阻塞状态，也不能被改变。</li>
<li>在 Java 中通过同步机制，来解决线程的安全问题。</li>
</ol>
<p>方式一：同步代码块</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span>(同步监听器)&#123;</span><br><span class="line">    <span class="comment">//需要被同步的代码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>操作共享数据的代码，即为需要被同步的代码。</p>
<p>共享数据：多个线程共同操作的变量，比如：ticket</p>
<p>同步监视器：俗称，锁。任何一个类的对象都可以充当锁。</p>
<p>多个线程必须用通一把锁。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BuyTicket</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        BuyThread bt = <span class="keyword">new</span> BuyThread();</span><br><span class="line">        Thread w1 = <span class="keyword">new</span> Thread(bt);</span><br><span class="line">        Thread w2 = <span class="keyword">new</span> Thread(bt);</span><br><span class="line">        Thread w3 = <span class="keyword">new</span> Thread(bt);</span><br><span class="line"></span><br><span class="line">        w1.start();</span><br><span class="line">        w2.start();</span><br><span class="line">        w3.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuyThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> ticket = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    Object obj = <span class="keyword">new</span> Object();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (obj)&#123;</span><br><span class="line">                <span class="keyword">if</span>(ticket&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">try</span>&#123;</span><br><span class="line">                        Thread.sleep(<span class="number">100</span>);</span><br><span class="line">                    &#125;<span class="keyword">catch</span> (InterruptedException e)&#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">"卖票，票号："</span>+ticket);</span><br><span class="line">                    ticket--;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Thread-1卖票，票号：100</span><br><span class="line">Thread-1卖票，票号：99</span><br><span class="line">Thread-1卖票，票号：98</span><br><span class="line">Thread-1卖票，票号：97</span><br><span class="line">Thread-1卖票，票号：96</span><br><span class="line">Thread-1卖票，票号：95</span><br><span class="line">Thread-1卖票，票号：94</span><br><span class="line">Thread-1卖票，票号：93</span><br><span class="line">Thread-1卖票，票号：92</span><br><span class="line">Thread-1卖票，票号：91</span><br><span class="line">Thread-1卖票，票号：90</span><br><span class="line">Thread-1卖票，票号：89</span><br><span class="line">Thread-1卖票，票号：88</span><br><span class="line">Thread-1卖票，票号：87</span><br><span class="line">Thread-1卖票，票号：86</span><br><span class="line">Thread-1卖票，票号：85</span><br><span class="line">Thread-1卖票，票号：84</span><br><span class="line">Thread-1卖票，票号：83</span><br><span class="line">Thread-1卖票，票号：82</span><br><span class="line">Thread-1卖票，票号：81</span><br><span class="line">&#x2F;&#x2F;.......</span><br></pre></td></tr></table></figure>

<p>同步好处：解决了线程的安全问题。<br>同步局限性：只能有一个线程参与，其他线程等待。相当于一个单线程的过程，效率低。</p>
<hr>
<p>示例场景：</p>
<p>创建三个窗口卖票，总票数为 100 张，使用继承 Thread 类的方式。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BuyTicket</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">       BuyThread w1 = <span class="keyword">new</span> BuyThread();</span><br><span class="line">       BuyThread w2 = <span class="keyword">new</span> BuyThread();</span><br><span class="line">       BuyThread w3 = <span class="keyword">new</span> BuyThread();</span><br><span class="line"></span><br><span class="line">        w1.start();</span><br><span class="line">        w2.start();</span><br><span class="line">        w3.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> ticket = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> Object obj = <span class="keyword">new</span> Object();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (obj)&#123;</span><br><span class="line">                <span class="keyword">if</span>(ticket&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">try</span>&#123;</span><br><span class="line">                        Thread.sleep(<span class="number">100</span>);</span><br><span class="line">                    &#125;<span class="keyword">catch</span> (InterruptedException e)&#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">"卖票，票号："</span>+ticket);</span><br><span class="line">                    ticket--;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>方法二：同步方法</p>
<p>如果操作共享数据的代码完整的声明在一个方法中，我们不妨将此方法声明为同步的。</p>
<p>通过实现 Runnable 接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BuyTicket</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        BuyThread bt = <span class="keyword">new</span> BuyThread();</span><br><span class="line">        Thread w1 = <span class="keyword">new</span> Thread(bt);</span><br><span class="line">        Thread w2 = <span class="keyword">new</span> Thread(bt);</span><br><span class="line">        Thread w3 = <span class="keyword">new</span> Thread(bt);</span><br><span class="line"></span><br><span class="line">        w1.start();</span><br><span class="line">        w2.start();</span><br><span class="line">        w3.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuyThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> ticket = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ticket &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">100</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">"卖票，票号："</span> + ticket);</span><br><span class="line">            ticket--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>synchronized void xxx() 表示同步方法。</p>
<p>要保证同步方法中所有内容都是被共享的，不能是重复的。</p>
<hr>
<p>通过继承 Thread 类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BuyTicket</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        BuyThread w1 = <span class="keyword">new</span> BuyThread();</span><br><span class="line">        BuyThread w2 = <span class="keyword">new</span> BuyThread();</span><br><span class="line">        BuyThread w3 = <span class="keyword">new</span> BuyThread();</span><br><span class="line"></span><br><span class="line">        w1.start();</span><br><span class="line">        w2.start();</span><br><span class="line">        w3.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> ticket = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ticket &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">100</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">"卖票，票号："</span> + ticket);</span><br><span class="line">            ticket--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>非静态同步方法，默认同步监视器是：this</p>
<p>静态同步方法，默认同步监视器是：当前类本身</p>
<hr>
<h2 id="使用同步机制改写单例模式"><a href="#使用同步机制改写单例模式" class="headerlink" title="使用同步机制改写单例模式"></a>使用同步机制改写单例模式</h2><p>使用同步机制改写单例模式之懒汉式</p>
<p>方式一：效率较差</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bank</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Bank</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Bank instance = <span class="keyword">null</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Bank <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//┌──────────────────────────────────────┐</span></span><br><span class="line"><span class="comment">//│           抽象的线程等待区            │</span></span><br><span class="line"><span class="comment">//└──────────────────────────────────────┘</span></span><br><span class="line">        <span class="keyword">synchronized</span> (Bank<span class="class">.<span class="keyword">class</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (instance == <span class="keyword">null</span>)&#123;</span><br><span class="line">                instance = <span class="keyword">new</span> Bank();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> instance;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所有在进入同步代码块前的线程，无论 instance 是否已经实例化都会进入其中进行判断。</p>
<p>方式二：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bank</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Bank</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Bank instance = <span class="keyword">null</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Bank <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line"><span class="comment">//┌──────────────────────────────────────┐</span></span><br><span class="line"><span class="comment">//│           抽象的线程等待区            │</span></span><br><span class="line"><span class="comment">//└──────────────────────────────────────┘</span></span><br><span class="line">            <span class="keyword">synchronized</span> (Bank<span class="class">.<span class="keyword">class</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> Bank();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="线程的死锁"><a href="#线程的死锁" class="headerlink" title="线程的死锁"></a>线程的死锁</h2><p>死锁：</p>
<ul>
<li>不同线程分别占用对方需要的同步资源不放弃，都在等待对方放弃自己需要的同步资源，就形成了线程的死锁。</li>
<li>出现死锁后，不会出现异常，不会出现提示，只是所有的线程都处于阻塞状态，无法继续。</li>
</ul>
<p>解决方法：</p>
<ul>
<li>专门的算法、原则。</li>
<li>尽量减少同步资源的定义。</li>
<li>尽量避免嵌套同步。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        StringBuffer s1 = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        StringBuffer s2 = <span class="keyword">new</span> StringBuffer();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> Thread() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">synchronized</span> (s1) &#123;</span><br><span class="line">                    s1.append(<span class="string">"a"</span>);</span><br><span class="line">                    s2.append(<span class="string">"1"</span>);</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        sleep(<span class="number">100</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">synchronized</span> (s2) &#123;</span><br><span class="line">                        s1.append(<span class="string">"b"</span>);</span><br><span class="line">                        s2.append(<span class="string">"2"</span>);</span><br><span class="line"></span><br><span class="line">                        System.out.println(s1);</span><br><span class="line">                        System.out.println(s2);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.start();</span><br><span class="line">        <span class="keyword">new</span> Thread() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">synchronized</span> (s2) &#123;</span><br><span class="line">                    s1.append(<span class="string">"c"</span>);</span><br><span class="line">                    s2.append(<span class="string">"3"</span>);</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        sleep(<span class="number">100</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">synchronized</span> (s1) &#123;</span><br><span class="line">                        s1.append(<span class="string">"d"</span>);</span><br><span class="line">                        s2.append(<span class="string">"4"</span>);</span><br><span class="line"></span><br><span class="line">                        System.out.println(s1);</span><br><span class="line">                        System.out.println(s2);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上代码在运行过程中可能不会产生输出并持续保持运行状态，即进入了死锁状态。</p>
<hr>
<h2 id="Lock（锁）"><a href="#Lock（锁）" class="headerlink" title="Lock（锁）"></a>Lock（锁）</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BuyThread1</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> ticket = <span class="number">100</span>;</span><br><span class="line">    <span class="comment">//1. 实例化ReentrantLock类的对象lock</span></span><br><span class="line">    <span class="keyword">private</span> ReentrantLock lock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//2. 将需要同步的代码用try包起来，并调用lock() 方法</span></span><br><span class="line">                lock.lock();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (ticket &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Thread.sleep(<span class="number">100</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">"卖票，票号："</span> + ticket);</span><br><span class="line">                    ticket--;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="comment">//3. 当运行完后进行解锁</span></span><br><span class="line">                lock.unlock();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>synchronized 与 Lock 的异同：</p>
<p>相同：二者都可以解决线程安全问题。</p>
<p>不同：</p>
<p>synchronized 机制在执行完相应的同步代码后，自动释放同步监视器。</p>
<p>Lock 需要手动的启动同步（lock()）和手动的结束同步（unlock()）。</p>
<hr>
<p>sleep() 和 wait() 的异同：</p>
<p>相同：一旦执行方法，都可使当前线程进入堵塞状态。</p>
<p>不同：</p>
<ol>
<li>两个方法声明位置不同：Thread 类中声明 sleep()，Object 类中声明 wait()。</li>
<li>调用的要求不同：sleep() 可以在任何需要的场景使用，wait() 只能在同步代码块或同步方法中使用。</li>
<li>关于是否释放同步监视器：如果两个方法都在同步代码块或同步方法中，sleep() 不会释放同步监视器，wait() 会释放同步监视器。</li>
</ol>
<hr>
<h2 id="实现-Callable-接口"><a href="#实现-Callable-接口" class="headerlink" title="实现 Callable 接口"></a>实现 Callable 接口</h2><p>Future 接口：</p>
<ul>
<li>可以对具体 Runnable。Callable 任务的执行结果进行取消、查询是否完成、获取结果等。</li>
<li>FutrueTask 同时实现了 Runnable、Callable 接口。它既作为 Runnable 线程被执行，又可以作为 Future 得到的 Callable 的返回值。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CallTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//3. 创建Callable接口实现类的对象</span></span><br><span class="line">        CallThread ct = <span class="keyword">new</span> CallThread();</span><br><span class="line">        <span class="comment">//4. 将此Callable接口实现类的对象作为参数传递到FutureTask构造器中，创建FutureTask对象</span></span><br><span class="line">        FutureTask futureTask = <span class="keyword">new</span> FutureTask(ct);</span><br><span class="line">        <span class="comment">//5. 将FutureTask的对象作为参数传递到Thread类的构造器中，创建Thread对象，并调用start()</span></span><br><span class="line">        <span class="keyword">new</span> Thread(futureTask).start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//6. 获取Callable中的call()的返回值</span></span><br><span class="line">            <span class="comment">//get()返回值即为FutureTask构造器参数Callable实现类重写的call()的返回值</span></span><br><span class="line">            Object sum = futureTask.get();</span><br><span class="line">            System.out.println(sum);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ExecutionException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//1. 创建一个Callable接口的实现类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CallThread</span> <span class="keyword">implements</span> <span class="title">Callable</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">//2. 重写call()，将此线程需要进行的操作声明在call()中</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.println(i);</span><br><span class="line">                sum += i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">0</span><br><span class="line">2</span><br><span class="line">4</span><br><span class="line">6</span><br><span class="line">8</span><br><span class="line">10</span><br><span class="line">12</span><br><span class="line">14</span><br><span class="line">16</span><br><span class="line">18</span><br><span class="line">20</span><br><span class="line">22</span><br><span class="line">.......</span><br><span class="line">96</span><br><span class="line">98</span><br><span class="line">2450</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="使用线程池"><a href="#使用线程池" class="headerlink" title="使用线程池"></a>使用线程池</h2><p>提前创好多个线程，放入线程池中，使用时直接获取，使用完放回池中。避免频繁创建销毁、实现重复利用。</p>
<p>好处：</p>
<ul>
<li>提高响应速度</li>
<li>降低资源消耗</li>
<li>便于线程管理</li>
</ul>
<p>ExecutorService：真正的线程池接口。常见子类ThreadPoolExecutor</p>
<ul>
<li>void execute(Runnable command)：执行任务/命令，没有返回值，一般用来执行 Runnable。</li>
<li><T>Future<T>submit(Callable<T> task)：执行任务，有返回值，一般用来执行Callable。</li>
<li>void shutdown()：关闭连接池。</li>
</ul>
<p>Executors：工具类、线程池的工厂类，用于创建并返回不同类型的线程池。</p>
<ul>
<li>Executors.newCachedThreadPool()：创建一个可根据需要创建新线程的线程池。</li>
<li>Executors.newFixedThreadPool()：创建一个可重用固定线程数的线程池。</li>
<li>Executors.newSingleThreadExecutor()：创建一个只有一个线程的线程池。</li>
<li>Executors.newScheduledThreadPool(n)：创建一个线程池，可以安排在给定延迟后运行命令或者定期执行。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadPool</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1. 提供指定数量线程的线程池</span></span><br><span class="line">        ExecutorService service = Executors.newFixedThreadPool(<span class="number">10</span>);</span><br><span class="line">        <span class="comment">//2. 执行指定的线程的操作</span></span><br><span class="line">        service.execute(<span class="keyword">new</span> NumberThread1());</span><br><span class="line">        service.execute(<span class="keyword">new</span> NumberThread2());</span><br><span class="line">        <span class="comment">//3. 关闭线程池</span></span><br><span class="line">        service.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NumberThread1</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">100</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName()+<span class="string">"："</span>+i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NumberThread2</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">100</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(i%<span class="number">2</span>!=<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName()+<span class="string">"："</span>+i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">pool-1-thread-2：1</span><br><span class="line">pool-1-thread-1：0</span><br><span class="line">pool-1-thread-2：3</span><br><span class="line">pool-1-thread-1：2</span><br><span class="line">pool-1-thread-1：4</span><br><span class="line">pool-1-thread-2：5</span><br><span class="line">pool-1-thread-1：6</span><br><span class="line">pool-1-thread-2：7</span><br><span class="line">pool-1-thread-2：9</span><br><span class="line">pool-1-thread-1：8</span><br><span class="line">pool-1-thread-2：11</span><br><span class="line">pool-1-thread-1：10</span><br><span class="line">pool-1-thread-1：12</span><br><span class="line">pool-1-thread-1：14</span><br><span class="line">pool-1-thread-2：13</span><br><span class="line">pool-1-thread-2：15</span><br><span class="line">&#x2F;&#x2F;.......</span><br></pre></td></tr></table></figure>

<p>到此为止，创建多线程有四种方法。</p>
<hr>
<h1 id="Java-常用类"><a href="#Java-常用类" class="headerlink" title="Java 常用类"></a>Java 常用类</h1><h2 id="字符串相关类"><a href="#字符串相关类" class="headerlink" title="字符串相关类"></a>字符串相关类</h2><p>String：</p>
<ul>
<li><p>String：字符串，使用一对” “引起来表示。</p>
</li>
<li><p>String 声明为 final 的，不可被继承。</p>
</li>
<li><p>String 实现了 serializable 接口，表示字符串是可以序列化的。</p>
<p>  实现了 Comparable 接口，表示 String 可以比较大小。</p>
</li>
<li><p>String 内部定义了 final char[] value（有些版本为final byte[] value） 用于存储字符串数据</p>
</li>
<li><p>String 代表不可变的字符序列。</p>
<p>  当字符串重新赋值时，需重写指定内存区域赋值，不能使用原有 value 赋值。字符串赋值的过程类似于调用数据而不是创造数据。</p>
<p>  当新赋值一个字符串，会在字符串常量池中，创建一个等待赋值的数据，并赋予其地址值，随后给要赋值的字符串指向该地址值，以此完成赋值操作。因此拥有相同值的字符串实际上是都指向了同一片内存空间，当其中一个要重新赋值时，并非修改原本指向的内存空间中的值，而是在字符串常量池中重新寻找待赋值的数据（如果没有就创建），然后在指向其内存地址。</p>
<p>  如图：</p>
  <img src='/img/Java高级/2.png'>

<p>  当调用 String 的 replace() 方法修改指定字符或字符串时，也需要重新指定内存区域。</p>
</li>
</ul>
<p>String 对象的创建如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">String str = “Hello”;   <span class="comment">//声明一个字符串赋值"Hello"</span></span><br><span class="line"></span><br><span class="line">String str = <span class="keyword">new</span> String();      <span class="comment">//声明一个字符串，默认不赋值</span></span><br><span class="line"></span><br><span class="line">String str = <span class="keyword">new</span> String(<span class="string">"Hello"</span>);       <span class="comment">//声明一个字符串，赋值"Hello"</span></span><br><span class="line"></span><br><span class="line">String str = <span class="keyword">new</span> String(<span class="keyword">char</span>[] a);       <span class="comment">//声明一个字符串，赋值数组a</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//声明一个字符串，赋值从数组a下标为startindex的元素起始的count个元素        </span></span><br><span class="line">String str = <span class="keyword">new</span> STring(<span class="keyword">char</span>[] a,<span class="keyword">int</span> startindex,<span class="keyword">int</span> count);</span><br></pre></td></tr></table></figure>

<p>通过 new 进行赋值的 String 对象是在堆空间中开辟一片内存空间存储 value，而堆空间的 value 的值又是从字符串常量池中寻找调用，也就是 String 对象指向 堆空间中的地址值，而堆空间内又指向字符串常量池中的地址值，因此会有：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">String str1 = <span class="string">"123"</span>;</span><br><span class="line">String str2 = <span class="string">"123"</span>;</span><br><span class="line">String str3 = <span class="keyword">new</span> String(<span class="string">"123"</span>);</span><br><span class="line">String str4 = <span class="keyword">new</span> String(<span class="string">"123"</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(str1 == str2);</span><br><span class="line">System.out.println(str1 == str3);</span><br><span class="line">System.out.println(str3 == str4);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">true</span><br><span class="line">false</span><br><span class="line">false</span><br></pre></td></tr></table></figure>

<p>因此引出提问：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String str = <span class="keyword">new</span> String(<span class="string">"Hello"</span>);</span><br></pre></td></tr></table></figure>

<p>以上方式在内存中创建了几个对象：两个（堆空间一个、常量池一个）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">String s1 = <span class="string">"Java"</span>;</span><br><span class="line">String s2 = <span class="string">"EE"</span>;</span><br><span class="line"></span><br><span class="line">String s3 = <span class="string">"JavaEE"</span>;</span><br><span class="line">String s4 = <span class="string">"Java"</span> + <span class="string">"EE"</span>;</span><br><span class="line">String s5 = s1 + <span class="string">"EE"</span>;</span><br><span class="line">String s6 = <span class="string">"Java"</span> + s2;</span><br><span class="line">String s7 = s1 + s2;</span><br><span class="line">String s8 = s5.intern();</span><br><span class="line"></span><br><span class="line">System.out.println(s3 == s4);   <span class="comment">//true</span></span><br><span class="line">System.out.println(s3 == s5);   <span class="comment">//false</span></span><br><span class="line">System.out.println(s3 == s6);   <span class="comment">//false</span></span><br><span class="line">System.out.println(s3 == s7);   <span class="comment">//false</span></span><br><span class="line">System.out.println(s5 == s6);   <span class="comment">//false</span></span><br><span class="line">System.out.println(s5 == s7);   <span class="comment">//false</span></span><br><span class="line">System.out.println(s6 == s7);   <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line">System.out.println(s3 == s8);   <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<p>常量与常量拼接的结果在常量池中，因此比对是常量池与常量池比对，相同肯定为 true，但有变量参与，中间是涉及堆空间，因此比对为 false。</p>
<p>而通过 intern() 赋值的变量是直接在常量池中寻找数据，因此比对是 true。</p>
<hr>
<p><b>String  与 char[] 之间的转换</b></p>
<p>String –&gt; char[]</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">String str1 = <span class="string">"abc123"</span>;</span><br><span class="line"><span class="keyword">char</span>[] charArray = str1.toCharArray();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;charArray.length;i++)&#123;</span><br><span class="line">    System.out.print(charArray[i] + <span class="string">" "</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a b c 1 2 3</span><br></pre></td></tr></table></figure>

<p>char[] –&gt; String</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span>[] arr = <span class="keyword">new</span> <span class="keyword">char</span>[]&#123;<span class="string">'h'</span>,<span class="string">'e'</span>,<span class="string">'l'</span>,<span class="string">'l'</span>,<span class="string">'o'</span>&#125;;</span><br><span class="line">String str2 = <span class="keyword">new</span> String(arr);</span><br><span class="line">System.out.println(str2);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hello</span><br></pre></td></tr></table></figure>

<hr>
<p><b>String 与 byte[] 之间的转换</b></p>
<p>编码：String –&gt; byte[]</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">String str1 = <span class="string">"abc123北京"</span>;</span><br><span class="line"><span class="keyword">byte</span>[] byt = str1.getBytes();   <span class="comment">//默认字符集转换</span></span><br><span class="line">System.out.println(Arrays.toString(byt));</span><br><span class="line"><span class="keyword">byte</span>[] gbks = str1.getBytes(<span class="string">"gbk"</span>);     <span class="comment">//GBK字符集转换</span></span><br><span class="line">System.out.println(Arrays.toString(gbks));</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[97, 98, 99, 49, 50, 51, -27, -116, -105, -28, -70, -84]</span><br><span class="line">[97, 98, 99, 49, 50, 51, -79, -79, -66, -87]</span><br></pre></td></tr></table></figure>

<hr>
<p>解码：byte[] –&gt; String</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String str2 = <span class="keyword">new</span> String(byt);  <span class="comment">//转换默认字符集</span></span><br><span class="line">System.out.println(str2);</span><br><span class="line">str2 = <span class="keyword">new</span> String(gbks,<span class="string">"gbk"</span>);</span><br><span class="line">System.out.println(str2);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">abc123北京</span><br><span class="line">abc123北京</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="String-常用方法"><a href="#String-常用方法" class="headerlink" title="String 常用方法"></a>String 常用方法</h2><ul>
<li>int length()：返回字符串长度  <code>return value.length</code></li>
<li>char charAt(int index)：返回某索引处的字符    <code>return value[index]</code></li>
<li>boolean isEmpty()：判断是否为空字符串     <code>return value.length == 0</code></li>
<li>String toLowerCase()：使用默认语言环境，将字符串中所有字符转换为小写</li>
<li>String toUpperCase()：使用默认语言环境，将字符串中所有字符转换为大写</li>
<li>String trim()：返回字符串的副本，忽略前导空白和尾部空白</li>
<li>boolean equals(Object obj)：比较字符串的内容是否相同</li>
<li>boolean equalsIgnoreCase(String anotherString)：与 equals 方法类似，忽略大小写</li>
<li>String concat(String str)：将指定字符串连接到该字符串的结尾</li>
<li>int compareTo(String anotherString)：比较两个字符串的大小</li>
<li>String substring(int beginIndex)：返回一个新字符串，它是此字符串从 beginIndex 开始截取到最后一个子字符串</li>
<li>String substring(int beginIndex, int endIndex)：返回一个新字符串，它是此字符串从 beginIndex 开始截取到 endIndex （不包含）的一个子字符串</li>
<li>boolean endsWith(String suffix)：测试此字符串是否以指定的后缀结束</li>
<li>boolean startsWith(String prefix)：测试此字符串是否以指定的前缀开始</li>
<li>boolean startsWith(String prefix, int toffset)：测试此字符串从指定索引开始的子字符串是否以指定前缀开始</li>
<li>boolean contains(CharSequence s)：当且仅当此字符串包含指定的 char 值序列时，返回 true</li>
<li>int indexOf(String str)：返回指定子字符串在此字符串中第一次出现的索引位置</li>
<li>int indexOf(String str, int fromIndex)：返回指定子字符串在此字符串中第一次出现处的索引，从指定索引开始</li>
<li>int lastIndexOf(String str)：返回指定子字符串在此字符串中最右边出现处的索引</li>
<li>int lastIndexOf(String str, int fromIndex)：返回指定子字符串在此字符串中最后一次出现处的索引，从指定索引开始反向搜索 </li>
<li>String replace(char oldChar,char newChar)：返回一个新的字符串，它是通过 newChar 替换此字符串中出现的所有 oldChar 所得到的</li>
<li>String replace(CharSequence target, CharSequence replacement)：使用指定的字面值替换此字符串所有匹配字面值目标序列的子字符串</li>
<li>String replaceAll(String regex, String replacement)：使用给定的 replacement 替换此字符串所有匹配给定的正则表达式的子字符串</li>
<li>String replaceFirst(String regex, String replacement)：使用给定的 replacement 替换此字符串匹配给定正则表达式第一个子字符串</li>
<li>boolean matches(String regex)：告知此字符串是否匹配给定的正则表达式</li>
<li>String[] split(String regex)：根据给定的正则表达式的匹配分拆此字符串</li>
<li>String[] split(String regex, int limit)：根据匹配给定的正则表达式来拆分此字符串，最多不超过 limit 个，如果超过了，剩下的全部放在最后一个元素中</li>
</ul>
<hr>
<h2 id="StringBuffer-与-StringBuilder"><a href="#StringBuffer-与-StringBuilder" class="headerlink" title="StringBuffer 与 StringBuilder"></a>StringBuffer 与 StringBuilder</h2><p>String、StringBuffer 与 StringBuilder 异同：</p>
<p>不同：</p>
<ul>
<li>String：不可变的字符序列。</li>
<li>StringBuffer：可变的字符序列、线程安全、效率低</li>
<li>StringBuilder：可变的字符序列、线程不安全、效率高</li>
</ul>
<p>相同：</p>
<ul>
<li>三者底层都是利用 char[] 存储</li>
</ul>
<p>String 与 StringBuffer 底层分析：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String str1 = <span class="keyword">new</span> String(); <span class="comment">//char value = new char[0];</span></span><br><span class="line">String str2 = <span class="keyword">new</span> String(<span class="string">"abc"</span>);    <span class="comment">//cahr value = new char[]&#123;'a','b','c'&#125;;</span></span><br><span class="line"></span><br><span class="line">StringBuffer sb1 = <span class="keyword">new</span> StringBuffer();  <span class="comment">//char value = new char[16]; 底层创建了默认长度为16的数组</span></span><br><span class="line">sb1.append(<span class="string">'a'</span>);    <span class="comment">//value[0] = 'a';</span></span><br><span class="line">sb1.append(<span class="string">'b'</span>);    <span class="comment">//value[1] = 'b';</span></span><br><span class="line"></span><br><span class="line">StringBuffer sb2 = <span class="keyword">new</span> StringBuffer(<span class="string">"abc"</span>); <span class="comment">//char value = new char["abc".length() + 16]; 底层创建的默认数组会在16的基础上加上初始化value的数值长度</span></span><br><span class="line"><span class="comment">//sb2.append("abc");</span></span><br></pre></td></tr></table></figure>

<p>当 StringBuffer 初始16长度盛不下的时候，需要数组扩容，默认扩容长度为 原有长度的 2 倍 + 2，将原本数组中的元素复制到新的数组中。开发中尽量使用 StringBuffer 和 StringBuilder</p>
<p>StringBuffer 常用方法</p>
<ul>
<li>append(xxx)：提供了众多 append() 方法，用于字符串拼接。</li>
<li>delete(int start, int end)：删除指定位置的内容。</li>
<li>replace(int start, int end, String str)：将指定区域内容替换为 str。</li>
<li>insert(int offset, xxx)：在 offset 位置插入 xxx。</li>
<li>reverse()：将字符序列逆转。</li>
<li>char setCharAt(int n, char ch)：将位置为 n 的字符替换为 ch。</li>
</ul>
<hr>
<h2 id="旧的时间-API"><a href="#旧的时间-API" class="headerlink" title="旧的时间 API"></a>旧的时间 API</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">long</span> time = System.currentTimeMillis();</span><br><span class="line"><span class="comment">//返回当前时间与1970年1月1日00:00:00之间以毫秒为单位的时间差（也称为时间戳）</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Date date1 = <span class="keyword">new</span> Date();    <span class="comment">//默认为当前时间</span></span><br><span class="line">System.out.println(date1.toString());   <span class="comment">//返回当前时间</span></span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Sun Seb 06 15:35:05 CST 2021</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(date1.getTime());    <span class="comment">//时间戳与currentTimeMillis()作业相同</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Date date2 = <span class="keyword">new</span> Date(<span class="number">1559107318619L</span>);  <span class="comment">//返回指定时间</span></span><br><span class="line">System.out.println(date2.toString());</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Wed May 29 13:21:58 CST 2019</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//返回数据库日期格式</span></span><br><span class="line">java.sql.Date date3 = <span class="keyword">new</span> java.sql.Date(<span class="number">1559107318619L</span>);</span><br><span class="line">System.out.println(date3.toString());</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2019-05-29</span><br></pre></td></tr></table></figure>

<p>SimpleDateFormat：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Date date3 = <span class="keyword">new</span> Date(<span class="number">1559107318619L</span>);</span><br><span class="line">SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat();</span><br><span class="line">System.out.println(date3.toString());</span><br><span class="line"><span class="comment">//格式化：日期 ---&gt; 字符串</span></span><br><span class="line">String format = sdf.format(date3);</span><br><span class="line">System.out.println(format);</span><br><span class="line"><span class="comment">//解析：字符串 ---&gt; 日期</span></span><br><span class="line">String str = <span class="keyword">new</span> String(<span class="string">"2021/1/29 下午5:21"</span>);    <span class="comment">//默认构造器情况下</span></span><br><span class="line">Date date4 = sdf.parse(str);</span><br><span class="line">System.out.println(date4.toString());</span><br><span class="line"><span class="comment">//非默认构造器格式化</span></span><br><span class="line">SimpleDateFormat sdf2 = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"h:mm a"</span>); <span class="comment">//h：小时，m：分钟，a：时间状态，y：年，d：天……</span></span><br><span class="line">format = sdf2.format(date3);</span><br><span class="line">System.out.println(format);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Wed May 29 13:21:58 CST 2019</span><br><span class="line">2019&#x2F;5&#x2F;29 下午1:21</span><br><span class="line">Fri Jan 29 17:21:00 CST 2021</span><br><span class="line">1:21 下午</span><br></pre></td></tr></table></figure>

<p>Calendar（一个抽象类）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Calendar cal = Calendar.getInstance();</span><br><span class="line"><span class="comment">//get()</span></span><br><span class="line"><span class="keyword">int</span> days = cal.get(Calendar.DAY_OF_MONTH);<span class="comment">//这个月的第几天</span></span><br><span class="line">System.out.println(days);</span><br><span class="line">days = cal.get(Calendar.DAY_OF_WEEK);<span class="comment">//这个周的第几天</span></span><br><span class="line">System.out.println(days);</span><br><span class="line"><span class="comment">//set()</span></span><br><span class="line">cal.set(Calendar.DAY_OF_MONTH, <span class="number">22</span>);<span class="comment">//将原本这个月的第几天修改为指定数值</span></span><br><span class="line">days = cal.get(Calendar.DAY_OF_MONTH);</span><br><span class="line">System.out.println(days);</span><br><span class="line"><span class="comment">//add()</span></span><br><span class="line">cal.add(Calendar.DAY_OF_MONTH, <span class="number">3</span>);<span class="comment">//在当月第几天基础上加上指定天数</span></span><br><span class="line">days = cal.get(Calendar.DAY_OF_MONTH);</span><br><span class="line">System.out.println(days);</span><br><span class="line"><span class="comment">//getTime()：日历类 ---&gt; Date</span></span><br><span class="line">Date date = cal.getTime();<span class="comment">//获取当前日期的时间</span></span><br><span class="line">System.out.println(date);</span><br><span class="line"><span class="comment">//setTime()：Date ---&gt; 日历类</span></span><br><span class="line">Date date1 = <span class="keyword">new</span> Date(<span class="number">1559107318619L</span>);</span><br><span class="line">cal.setTime(date1);</span><br><span class="line">days = cal.get(Calendar.DAY_OF_MONTH);<span class="comment">//获取被格式化后的当月天数</span></span><br><span class="line">System.out.println(days);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">6</span><br><span class="line">1</span><br><span class="line">22</span><br><span class="line">25</span><br><span class="line">Fri Mar 25 16:44:29 CST 2022</span><br><span class="line">29</span><br></pre></td></tr></table></figure>

<p>注意：</p>
<p>获取的月份：一月是 0，十二月是 11。</p>
<p>获取的周内日期：周日是 1，周六是 7。</p>
<hr>
<h2 id="新的时间-API"><a href="#新的时间-API" class="headerlink" title="新的时间 API"></a>新的时间 API</h2><img src='/img/Java高级/3.png'>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//now()：获取当前的日期、时间</span></span><br><span class="line">LocalDate ld = LocalDate.now();</span><br><span class="line">LocalTime lt = LocalTime.now();</span><br><span class="line">LocalDateTime ldt = LocalDateTime.now();</span><br><span class="line"></span><br><span class="line">System.out.println(ld);</span><br><span class="line">System.out.println(lt);</span><br><span class="line">System.out.println(ldt);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2021-02-06</span><br><span class="line">17:07:45.838510</span><br><span class="line">2021-02-06T17:07:45.838510</span><br></pre></td></tr></table></figure>

<hr>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//of()：设置指定的年、月、日、时、分、秒</span></span><br><span class="line">LocalDateTime ldt = LocalDateTime.of(<span class="number">2021</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">19</span>,<span class="number">24</span>,<span class="number">31</span>);</span><br><span class="line">System.out.println(ldt);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2021-01-01T19:24:31</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(ldt.getDayOfMonth());<span class="comment">//获取当月第几天</span></span><br><span class="line">System.out.println(ldt.getDayOfWeek());<span class="comment">//获取当周第几天</span></span><br><span class="line">System.out.println(ldt.getMonthValue());<span class="comment">//获取几月</span></span><br><span class="line">System.out.println(ldt.getMinute());<span class="comment">//获取当前分钟</span></span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">FRIDAY</span><br><span class="line">1</span><br><span class="line">24</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//体现不可变性，不再原数据上修改</span></span><br><span class="line"><span class="comment">//withXxx()：设置相关属性</span></span><br><span class="line">LocalDateTime ldt1 = ldt.withDayOfMonth(<span class="number">22</span>);<span class="comment">//修改当月的第几天</span></span><br><span class="line">System.out.println(ldt1);</span><br><span class="line">System.out.println(ldt);</span><br><span class="line">LocalDateTime ldt2 = ldt.withHour(<span class="number">5</span>);<span class="comment">//修改当前小时数</span></span><br><span class="line">System.out.println(ldt2);</span><br><span class="line">System.out.println(ldt);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2021-01-22T19:24:31</span><br><span class="line">2021-01-01T19:24:31</span><br><span class="line">2021-01-01T05:24:31</span><br><span class="line">2021-01-01T19:24:31</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//plusXxx()</span></span><br><span class="line">LocalDateTime ldt3 = ldt.plusMonths(<span class="number">5</span>);<span class="comment">//原有月数上加上多少月</span></span><br><span class="line">System.out.println(ldt);</span><br><span class="line">System.out.println(ldt3);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2021-01-01T19:24:31</span><br><span class="line">2021-06-01T19:24:31</span><br></pre></td></tr></table></figure>

<hr>
<p><b>instant</b></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Instant instant = Instant.now();</span><br><span class="line">System.out.println(instant);    <span class="comment">//默认为本初子午线时间</span></span><br><span class="line">OffsetDateTime newInstant = instant.atOffset(ZoneOffset.ofHours(<span class="number">8</span>));<span class="comment">//北京时间处于东八区</span></span><br><span class="line">System.out.println(newInstant);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2021-02-06T11:24:43.405087500Z</span><br><span class="line">2021-02-06T19:24:43.405087500+08:00</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">long</span> mil = instant.toEpochMilli();<span class="comment">//获取instant对应的毫秒数</span></span><br><span class="line">System.out.println(mil);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1559800168274L</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Instant instant1 = Instant.ofEpochMilli(<span class="number">1559800168274L</span>);<span class="comment">//获取指定时间戳对应的时间</span></span><br><span class="line">System.out.println(instant1);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2019-06-06T05:49:28.274Z</span><br></pre></td></tr></table></figure>

<hr>
<p><b>DateTimeFormatter</b></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//DateTimeFormatter：格式化或解析时间、日期</span></span><br><span class="line">DateTimeFormatter dtf = DateTimeFormatter.ISO_LOCAL_DATE_TIME;</span><br><span class="line"><span class="comment">//格式化：日期 --&gt; 字符串</span></span><br><span class="line">LocalDateTime ldt4 = LocalDateTime.now();</span><br><span class="line">String str = dtf.format(ldt4);</span><br><span class="line">System.out.println(ldt4);</span><br><span class="line">System.out.println(str);</span><br><span class="line"><span class="comment">//解析：字符串 --&gt; 日期</span></span><br><span class="line">TemporalAccessor parse = dtf.parse(<span class="string">"2021-02-06T19:37:30.2198616"</span>);</span><br><span class="line">System.out.println(parse);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2021-02-06T19:37:30.219861600</span><br><span class="line">2021-02-06T19:37:30.2198616</span><br><span class="line">&#123;&#125;,ISO resolved to 2021-02-06T19:37:07.422504200</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//本地化相关格式 ofLocalizedDateTime()</span></span><br><span class="line">DateTimeFormatter dtf2 = DateTimeFormatter.ofLocalizedDateTime(FormatStyle.SHORT);</span><br><span class="line">String str2 = dtf2.format(ldt);</span><br><span class="line">System.out.println(str2);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2021&#x2F;1&#x2F;1 下午7:24</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//常用：自定义格式化 ofPattern()</span></span><br><span class="line">DateTimeFormatter dtf3 = DateTimeFormatter.ofPattern(<span class="string">"yyyy-MM-dd hh:mm:ss"</span>);</span><br><span class="line">String str3 = dtf3.format(ldt);</span><br><span class="line">System.out.println(str3);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2021-01-01 07:24:31</span><br></pre></td></tr></table></figure>

<p>补充：</p>
<img src='/img/Java高级/4.png'>

<hr>
<h2 id="Java-比较器"><a href="#Java-比较器" class="headerlink" title="Java 比较器"></a>Java 比较器</h2><p>Java 正常情况下只能进行 “==” 或 “!=” 的比较。</p>
<p>当需要进行大小比较时，需要使用接口 Comparable 或 Comparator</p>
<p><b>Comparable</b></p>
<p>像 String、包装类等实现了 Comparable 接口，重写了 compareTo(obj) 方法，给出了比较两个对象大小的方式。</p>
<p>重写 compareTo() 方法后，进行了从小到大的排序。</p>
<p>重写 compareTo() 的规则：</p>
<ul>
<li>如果当前对象 this 大于形参对象 obj，则返回正整数。</li>
<li>如果当前对象 this 小于形参对象 obj，则返回负整数。</li>
<li>如果当前对象 this 等于形参对象 obj，则返回 0。</li>
</ul>
<p>如果自定义类需要排序，则要实现 Comparable 接口。</p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Goods类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Goods</span> <span class="keyword">implements</span> <span class="title">Comparable</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> price;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Goods</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Goods</span><span class="params">(String name,<span class="keyword">int</span> price)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">int</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Goods&#123;"</span> +</span><br><span class="line">                <span class="string">"name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", price="</span> + price +</span><br><span class="line">                <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(o <span class="keyword">instanceof</span> Goods)&#123;</span><br><span class="line">            Goods goods = (Goods) o;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>.price&gt; goods.price)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">this</span>.price&lt;goods.price)&#123;</span><br><span class="line">                <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>.name.compareTo(goods.name);<span class="comment">//当价格一样时，按照名称从低到高排</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"传入的数据非法"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main方法</span></span><br><span class="line">Goods[] goods = <span class="keyword">new</span> Goods[<span class="number">4</span>];</span><br><span class="line">goods[<span class="number">0</span>] = <span class="keyword">new</span> Goods(<span class="string">"小米"</span>,<span class="number">3999</span>);</span><br><span class="line">goods[<span class="number">1</span>] = <span class="keyword">new</span> Goods(<span class="string">"华为"</span>,<span class="number">2999</span>);</span><br><span class="line">goods[<span class="number">2</span>] = <span class="keyword">new</span> Goods(<span class="string">"苹果"</span>,<span class="number">6999</span>);</span><br><span class="line">goods[<span class="number">3</span>] = <span class="keyword">new</span> Goods(<span class="string">"vivo"</span>,<span class="number">2499</span>);</span><br><span class="line"></span><br><span class="line">Arrays.sort(goods);</span><br><span class="line">System.out.println(Arrays.toString(goods));</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Goods&#123;name&#x3D;&#39;vivo&#39;, price&#x3D;2499&#125;, Goods&#123;name&#x3D;&#39;华为&#39;, price&#x3D;2999&#125;, Goods&#123;name&#x3D;&#39;小米&#39;, price&#x3D;3999&#125;, Goods&#123;name&#x3D;&#39;苹果&#39;, price&#x3D;6999&#125;]</span><br></pre></td></tr></table></figure>

<hr>
<p><b>Comparator 定制排序</b></p>
<p>当元素的类型没有实现 Comparable 接口而又不方便修改代码，或实现了 java.lang.Comarable 接口的排序规则不适合当前操作，则可以使用定制排序。</p>
<p>如需要字符串从大到小排列：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">String[] arr = <span class="keyword">new</span> String[]&#123;<span class="string">"AA"</span>,<span class="string">"CC"</span>,<span class="string">"BB"</span>,<span class="string">"KK"</span>,<span class="string">"FF"</span>,<span class="string">"EE"</span>&#125;;</span><br><span class="line">Arrays.sort(arr,<span class="keyword">new</span> Comparator()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Object o1, Object o2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(o1 <span class="keyword">instanceof</span> String &amp;&amp; o2 <span class="keyword">instanceof</span> String)&#123;</span><br><span class="line">            String s1 = (String) o1;</span><br><span class="line">            String s2 = (String) o2;</span><br><span class="line">            <span class="keyword">return</span> -s1.compareTo(s2);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"输入数据不合法"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">System.out.println(Arrays.toString(arr));</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[KK, FF, EE, CC, BB, AA]</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="System、Math、BigInteger、BigDecimal"><a href="#System、Math、BigInteger、BigDecimal" class="headerlink" title="System、Math、BigInteger、BigDecimal"></a>System、Math、BigInteger、BigDecimal</h2><p><b>System</b></p>
<ul>
<li>void gc()：请求系统进行垃圾回收</li>
<li>void exit(int status)：退出程序，当 status 为 0 时为正常退出，当 status 不为 0 时，为异常退出。</li>
<li>String getProperty(String key)：获取系统中属性名为 key 的属性的对应值。</li>
</ul>
<p><b>Math</b></p>
<img src='/img/Java高级/5.png'>

<p><b>BigInteger、BigDecimal</b></p>
<p>BigInteger 可以表示不可变的任意精度的整数。</p>
<p>BigInteger(String val)：根据字符串构建 BigInteger 对象。</p>
<img src='/img/Java高级/6.png'>

<p>而 BigDecimal 对应的是浮点型。</p>
<p>public BigDecimal(String val)<br>public BigDecimal(double val)</p>
<img src='/img/Java高级/7.png'>

<hr>
<h1 id="枚举类与注解"><a href="#枚举类与注解" class="headerlink" title="枚举类与注解"></a>枚举类与注解</h1><h2 id="枚举类的使用"><a href="#枚举类的使用" class="headerlink" title="枚举类的使用"></a>枚举类的使用</h2><p>当需要定义一组常量时，建议使用枚举类。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> Season&#123;</span><br><span class="line">    SPRING(<span class="string">"春天"</span>,<span class="string">"三月"</span>),</span><br><span class="line">    SUMMER(<span class="string">"夏天"</span>,<span class="string">"六月"</span>),</span><br><span class="line">    AUTUMN(<span class="string">"秋天"</span>,<span class="string">"九月"</span>),</span><br><span class="line">    WINTER(<span class="string">"冬天"</span>,<span class="string">"十二月"</span>);</span><br><span class="line"></span><br><span class="line">    Season(String 夏天, String 六月) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src='/img/Java高级/8.png'>

<p>如果枚举类要实现接口，则每个枚举对象都要重写其抽象方法。</p>
<hr>
<h2 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h2><p>在程序运行后，针对所写注解，执行对应操作。</p>
<p>生成文档的相关注解：</p>
<img src='/img/Java高级/9.png'>

<p>编译时进行格式检查相关注解：</p>
<img src='/img/Java高级/10.png'>

<p>自定义注解：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyAnnotation &#123;</span><br><span class="line">    String[] value();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>自定义注解除了标识作用外，要配上注解的信息处理流程（使用反射）才有意义。</p>
<p>元注解：用于修饰其他注解定义。</p>
<ul>
<li><p>Retention</p>
  <img src='/img/Java高级/11.png'>

  <img src='/img/Java高级/12.png'></li>
<li><p>Target</p>
  <img src='/img/Java高级/13.png'></li>
<li><p>Documented</p>
</li>
<li><p>Inherited</p>
  <img src='/img/Java高级/14.png'>

</li>
</ul>
<p>可重复注解：</p>
<p>创建重复注解声明</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.FIELD;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.TYPE;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(&#123;TYPE,FIELD&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyAnnotations &#123;</span><br><span class="line">    MyAnnotation[] value();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>让某个注解可重复</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.annotation.Repeatable;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Type;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.FIELD;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.annotation.ElementType.TYPE;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(&#123;TYPE,FIELD&#125;)</span><br><span class="line"><span class="meta">@Repeatable</span>(MyAnnotations)  <span class="comment">//可重复关键</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyAnnotation &#123;</span><br><span class="line">    String[] value();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可重复注解使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MyAnnotation</span>(value = <span class="string">"hi"</span>)</span><br><span class="line"><span class="meta">@MyAnnotation</span>(value = <span class="string">"hei"</span>)</span><br></pre></td></tr></table></figure>

<p>类型注解：</p>
<img src='/img/Java高级/15.png'>

<hr>
<h1 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h1><p>数组在定义多个数据方面的特点：</p>
<ul>
<li>一旦初始化以后，其长度就确定了。</li>
<li>数据一但定义好，其元素类型便确定了。</li>
</ul>
<p>数组在定义多个数据方面的缺点：</p>
<ul>
<li>一旦初始化以后，其长度不可修改。</li>
<li>数组提供的方法很有限、非常不便、效率不高。</li>
<li>获取数组中实际元素的个数的需求，没有现成的属性或方法。</li>
<li>数组存储：有序、可重复，对于无序、不可重复的需求不能满足。</li>
</ul>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="true">
                <source type="audio/mpeg" src="/music/塞壬唱片-MSR - Renegade.mp3">
            </audio>
            
        </div>
        
    <div id='gitalk-container' class="comment link"
		data-enable='true'
        data-ae='false'
        data-ci=''
        data-cs=''
        data-r=''
        data-o=''
        data-a=''
        data-d='false'
    >查看评论</div>


    </div>
    
        <div class='side'>
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#多线程"><span class="toc-number">1.</span> <span class="toc-text">多线程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#多线程基本概念"><span class="toc-number">1.1.</span> <span class="toc-text">多线程基本概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#线程的创建和使用"><span class="toc-number">1.2.</span> <span class="toc-text">线程的创建和使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#线程使用常用方法"><span class="toc-number">1.3.</span> <span class="toc-text">线程使用常用方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#线程的优先级"><span class="toc-number">1.4.</span> <span class="toc-text">线程的优先级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#线程的生命周期"><span class="toc-number">1.5.</span> <span class="toc-text">线程的生命周期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#线程的同步"><span class="toc-number">1.6.</span> <span class="toc-text">线程的同步</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用同步机制改写单例模式"><span class="toc-number">1.7.</span> <span class="toc-text">使用同步机制改写单例模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#线程的死锁"><span class="toc-number">1.8.</span> <span class="toc-text">线程的死锁</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lock（锁）"><span class="toc-number">1.9.</span> <span class="toc-text">Lock（锁）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#实现-Callable-接口"><span class="toc-number">1.10.</span> <span class="toc-text">实现 Callable 接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用线程池"><span class="toc-number">1.11.</span> <span class="toc-text">使用线程池</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-常用类"><span class="toc-number">2.</span> <span class="toc-text">Java 常用类</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#字符串相关类"><span class="toc-number">2.1.</span> <span class="toc-text">字符串相关类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#String-常用方法"><span class="toc-number">2.2.</span> <span class="toc-text">String 常用方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#StringBuffer-与-StringBuilder"><span class="toc-number">2.3.</span> <span class="toc-text">StringBuffer 与 StringBuilder</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#旧的时间-API"><span class="toc-number">2.4.</span> <span class="toc-text">旧的时间 API</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#新的时间-API"><span class="toc-number">2.5.</span> <span class="toc-text">新的时间 API</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Java-比较器"><span class="toc-number">2.6.</span> <span class="toc-text">Java 比较器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#System、Math、BigInteger、BigDecimal"><span class="toc-number">2.7.</span> <span class="toc-text">System、Math、BigInteger、BigDecimal</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#枚举类与注解"><span class="toc-number">3.</span> <span class="toc-text">枚举类与注解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#枚举类的使用"><span class="toc-number">3.1.</span> <span class="toc-text">枚举类的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#注解"><span class="toc-number">3.2.</span> <span class="toc-text">注解</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#集合"><span class="toc-number">4.</span> <span class="toc-text">集合</span></a></li></ol>	
        </div>
    
</div>


    </div>
</div>
</body>

<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>


<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/diaspora.js"></script>


<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>






</html>
